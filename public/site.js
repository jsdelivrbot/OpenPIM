var Zepto=function(){function e(e){return null==e?String(e):z[Q.call(e)]||"object"}function t(t){return"function"==e(t)}function r(e){return null!=e&&e==e.window}function n(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function i(t){return"object"==e(t)}function a(e){return i(e)&&!r(e)&&Object.getPrototypeOf(e)==Object.prototype}function s(e){return"number"==typeof e.length}function o(e){return w.call(e,function(e){return null!=e})}function u(e){return e.length>0?A.fn.concat.apply([],e):e}function c(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function l(e){return e in _?_[e]:_[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function f(e,t){return"number"!=typeof t||D[c(e)]?t:t+"px"}function p(e){var t,r;return L[e]||(t=R.createElement(e),R.body.appendChild(t),r=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==r&&(r="block"),L[e]=r),L[e]}function d(e){return"children"in e?k.call(e.children):A.map(e.childNodes,function(e){return 1==e.nodeType?e:void 0})}function h(e,t,r){for(T in t)r&&(a(t[T])||Z(t[T]))?(a(t[T])&&!a(e[T])&&(e[T]={}),Z(t[T])&&!Z(e[T])&&(e[T]=[]),h(e[T],t[T],r)):t[T]!==S&&(e[T]=t[T])}function y(e,t){return null==t?A(e):A(e).filter(t)}function g(e,r,n,i){return t(r)?r.call(e,n,i):r}function m(e,t,r){null==r?e.removeAttribute(t):e.setAttribute(t,r)}function v(e,t){var r=e.className||"",n=r&&r.baseVal!==S;return t===S?n?r.baseVal:r:void(n?r.baseVal=t:e.className=t)}function C(e){try{return e?"true"==e||("false"==e?!1:"null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?A.parseJSON(e):e):e}catch(t){return e}}function E(e,t){t(e);for(var r=0,n=e.childNodes.length;n>r;r++)E(e.childNodes[r],t)}var S,T,A,b,I,B,N=[],k=N.slice,w=N.filter,R=window.document,L={},_={},D={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},U=/^\s*<(\w+|!)[^>]*>/,P=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,x=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,O=/^(?:body|html)$/i,V=/([A-Z])/g,K=["val","css","html","text","data","width","height","offset"],j=["after","prepend","before","append"],M=R.createElement("table"),q=R.createElement("tr"),F={tr:R.createElement("tbody"),tbody:M,thead:M,tfoot:M,td:q,th:q,"*":R.createElement("div")},H=/complete|loaded|interactive/,G=/^[\w-]*$/,z={},Q=z.toString,X={},W=R.createElement("div"),Y={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},Z=Array.isArray||function(e){return e instanceof Array};return X.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var r=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(r)return r.call(e,t);var n,i=e.parentNode,a=!i;return a&&(i=W).appendChild(e),n=~X.qsa(i,t).indexOf(e),a&&W.removeChild(e),n},I=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},B=function(e){return w.call(e,function(t,r){return e.indexOf(t)==r})},X.fragment=function(e,t,r){var n,i,s;return P.test(e)&&(n=A(R.createElement(RegExp.$1))),n||(e.replace&&(e=e.replace(x,"<$1></$2>")),t===S&&(t=U.test(e)&&RegExp.$1),t in F||(t="*"),s=F[t],s.innerHTML=""+e,n=A.each(k.call(s.childNodes),function(){s.removeChild(this)})),a(r)&&(i=A(n),A.each(r,function(e,t){K.indexOf(e)>-1?i[e](t):i.attr(e,t)})),n},X.Z=function(e,t){return e=e||[],e.__proto__=A.fn,e.selector=t||"",e},X.isZ=function(e){return e instanceof X.Z},X.init=function(e,r){var n;if(!e)return X.Z();if("string"==typeof e)if(e=e.trim(),"<"==e[0]&&U.test(e))n=X.fragment(e,RegExp.$1,r),e=null;else{if(r!==S)return A(r).find(e);n=X.qsa(R,e)}else{if(t(e))return A(R).ready(e);if(X.isZ(e))return e;if(Z(e))n=o(e);else if(i(e))n=[e],e=null;else if(U.test(e))n=X.fragment(e.trim(),RegExp.$1,r),e=null;else{if(r!==S)return A(r).find(e);n=X.qsa(R,e)}}return X.Z(n,e)},A=function(e,t){return X.init(e,t)},A.extend=function(e){var t,r=k.call(arguments,1);return"boolean"==typeof e&&(t=e,e=r.shift()),r.forEach(function(r){h(e,r,t)}),e},X.qsa=function(e,t){var r,i="#"==t[0],a=!i&&"."==t[0],s=i||a?t.slice(1):t,o=G.test(s);return n(e)&&o&&i?(r=e.getElementById(s))?[r]:[]:1!==e.nodeType&&9!==e.nodeType?[]:k.call(o&&!i?a?e.getElementsByClassName(s):e.getElementsByTagName(t):e.querySelectorAll(t))},A.contains=R.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},A.type=e,A.isFunction=t,A.isWindow=r,A.isArray=Z,A.isPlainObject=a,A.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},A.inArray=function(e,t,r){return N.indexOf.call(t,e,r)},A.camelCase=I,A.trim=function(e){return null==e?"":String.prototype.trim.call(e)},A.uuid=0,A.support={},A.expr={},A.map=function(e,t){var r,n,i,a=[];if(s(e))for(n=0;n<e.length;n++)r=t(e[n],n),null!=r&&a.push(r);else for(i in e)r=t(e[i],i),null!=r&&a.push(r);return u(a)},A.each=function(e,t){var r,n;if(s(e)){for(r=0;r<e.length;r++)if(t.call(e[r],r,e[r])===!1)return e}else for(n in e)if(t.call(e[n],n,e[n])===!1)return e;return e},A.grep=function(e,t){return w.call(e,t)},window.JSON&&(A.parseJSON=JSON.parse),A.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){z["[object "+t+"]"]=t.toLowerCase()}),A.fn={forEach:N.forEach,reduce:N.reduce,push:N.push,sort:N.sort,indexOf:N.indexOf,concat:N.concat,map:function(e){return A(A.map(this,function(t,r){return e.call(t,r,t)}))},slice:function(){return A(k.apply(this,arguments))},ready:function(e){return H.test(R.readyState)&&R.body?e(A):R.addEventListener("DOMContentLoaded",function(){e(A)},!1),this},get:function(e){return e===S?k.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(e){return N.every.call(this,function(t,r){return e.call(t,r,t)!==!1}),this},filter:function(e){return t(e)?this.not(this.not(e)):A(w.call(this,function(t){return X.matches(t,e)}))},add:function(e,t){return A(B(this.concat(A(e,t))))},is:function(e){return this.length>0&&X.matches(this[0],e)},not:function(e){var r=[];if(t(e)&&e.call!==S)this.each(function(t){e.call(this,t)||r.push(this)});else{var n="string"==typeof e?this.filter(e):s(e)&&t(e.item)?k.call(e):A(e);this.forEach(function(e){n.indexOf(e)<0&&r.push(e)})}return A(r)},has:function(e){return this.filter(function(){return i(e)?A.contains(this,e):A(this).find(e).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!i(e)?e:A(e)},last:function(){var e=this[this.length-1];return e&&!i(e)?e:A(e)},find:function(e){var t,r=this;return t=e?"object"==typeof e?A(e).filter(function(){var e=this;return N.some.call(r,function(t){return A.contains(t,e)})}):1==this.length?A(X.qsa(this[0],e)):this.map(function(){return X.qsa(this,e)}):A()},closest:function(e,t){var r=this[0],i=!1;for("object"==typeof e&&(i=A(e));r&&!(i?i.indexOf(r)>=0:X.matches(r,e));)r=r!==t&&!n(r)&&r.parentNode;return A(r)},parents:function(e){for(var t=[],r=this;r.length>0;)r=A.map(r,function(e){return(e=e.parentNode)&&!n(e)&&t.indexOf(e)<0?(t.push(e),e):void 0});return y(t,e)},parent:function(e){return y(B(this.pluck("parentNode")),e)},children:function(e){return y(this.map(function(){return d(this)}),e)},contents:function(){return this.map(function(){return k.call(this.childNodes)})},siblings:function(e){return y(this.map(function(e,t){return w.call(d(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return A.map(this,function(t){return t[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=p(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var r=t(e);if(this[0]&&!r)var n=A(e).get(0),i=n.parentNode||this.length>1;return this.each(function(t){A(this).wrapAll(r?e.call(this,t):i?n.cloneNode(!0):n)})},wrapAll:function(e){if(this[0]){A(this[0]).before(e=A(e));for(var t;(t=e.children()).length;)e=t.first();A(e).append(this)}return this},wrapInner:function(e){var r=t(e);return this.each(function(t){var n=A(this),i=n.contents(),a=r?e.call(this,t):e;i.length?i.wrapAll(a):n.append(a)})},unwrap:function(){return this.parent().each(function(){A(this).replaceWith(A(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var t=A(this);(e===S?"none"==t.css("display"):e)?t.show():t.hide()})},prev:function(e){return A(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return A(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return 0 in arguments?this.each(function(t){var r=this.innerHTML;A(this).empty().append(g(this,e,t,r))}):0 in this?this[0].innerHTML:null},text:function(e){return 0 in arguments?this.each(function(t){var r=g(this,e,t,this.textContent);this.textContent=null==r?"":""+r}):0 in this?this[0].textContent:null},attr:function(e,t){var r;return"string"!=typeof e||1 in arguments?this.each(function(r){if(1===this.nodeType)if(i(e))for(T in e)m(this,T,e[T]);else m(this,e,g(this,t,r,this.getAttribute(e)))}):this.length&&1===this[0].nodeType?!(r=this[0].getAttribute(e))&&e in this[0]?this[0][e]:r:S},removeAttr:function(e){return this.each(function(){1===this.nodeType&&e.split(" ").forEach(function(e){m(this,e)},this)})},prop:function(e,t){return e=Y[e]||e,1 in arguments?this.each(function(r){this[e]=g(this,t,r,this[e])}):this[0]&&this[0][e]},data:function(e,t){var r="data-"+e.replace(V,"-$1").toLowerCase(),n=1 in arguments?this.attr(r,t):this.attr(r);return null!==n?C(n):S},val:function(e){return 0 in arguments?this.each(function(t){this.value=g(this,e,t,this.value)}):this[0]&&(this[0].multiple?A(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(e){if(e)return this.each(function(t){var r=A(this),n=g(this,e,t,r.offset()),i=r.offsetParent().offset(),a={top:n.top-i.top,left:n.left-i.left};"static"==r.css("position")&&(a.position="relative"),r.css(a)});if(!this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(t,r){if(arguments.length<2){var n,i=this[0];if(!i)return;if(n=getComputedStyle(i,""),"string"==typeof t)return i.style[I(t)]||n.getPropertyValue(t);if(Z(t)){var a={};return A.each(t,function(e,t){a[t]=i.style[I(t)]||n.getPropertyValue(t)}),a}}var s="";if("string"==e(t))r||0===r?s=c(t)+":"+f(t,r):this.each(function(){this.style.removeProperty(c(t))});else for(T in t)t[T]||0===t[T]?s+=c(T)+":"+f(T,t[T])+";":this.each(function(){this.style.removeProperty(c(T))});return this.each(function(){this.style.cssText+=";"+s})},index:function(e){return e?this.indexOf(A(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return e?N.some.call(this,function(e){return this.test(v(e))},l(e)):!1},addClass:function(e){return e?this.each(function(t){if("className"in this){b=[];var r=v(this),n=g(this,e,t,r);n.split(/\s+/g).forEach(function(e){A(this).hasClass(e)||b.push(e)},this),b.length&&v(this,r+(r?" ":"")+b.join(" "))}}):this},removeClass:function(e){return this.each(function(t){if("className"in this){if(e===S)return v(this,"");b=v(this),g(this,e,t,b).split(/\s+/g).forEach(function(e){b=b.replace(l(e)," ")}),v(this,b.trim())}})},toggleClass:function(e,t){return e?this.each(function(r){var n=A(this),i=g(this,e,r,v(this));i.split(/\s+/g).forEach(function(e){(t===S?!n.hasClass(e):t)?n.addClass(e):n.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===S?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===S?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),r=this.offset(),n=O.test(t[0].nodeName)?{top:0,left:0}:t.offset();return r.top-=parseFloat(A(e).css("margin-top"))||0,r.left-=parseFloat(A(e).css("margin-left"))||0,n.top+=parseFloat(A(t[0]).css("border-top-width"))||0,n.left+=parseFloat(A(t[0]).css("border-left-width"))||0,{top:r.top-n.top,left:r.left-n.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||R.body;e&&!O.test(e.nodeName)&&"static"==A(e).css("position");)e=e.offsetParent;return e})}},A.fn.detach=A.fn.remove,["width","height"].forEach(function(e){var t=e.replace(/./,function(e){return e[0].toUpperCase()});A.fn[e]=function(i){var a,s=this[0];return i===S?r(s)?s["inner"+t]:n(s)?s.documentElement["scroll"+t]:(a=this.offset())&&a[e]:this.each(function(t){s=A(this),s.css(e,g(this,i,t,s[e]()))})}}),j.forEach(function(t,r){var n=r%2;A.fn[t]=function(){var t,i,a=A.map(arguments,function(r){return t=e(r),"object"==t||"array"==t||null==r?r:X.fragment(r)}),s=this.length>1;return a.length<1?this:this.each(function(e,t){i=n?t:t.parentNode,t=0==r?t.nextSibling:1==r?t.firstChild:2==r?t:null;var o=A.contains(R.documentElement,i);a.forEach(function(e){if(s)e=e.cloneNode(!0);else if(!i)return A(e).remove();i.insertBefore(e,t),o&&E(e,function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)})})})},A.fn[n?t+"To":"insert"+(r?"Before":"After")]=function(e){return A(e)[t](this),this}}),X.Z.prototype=A.fn,X.uniq=B,X.deserializeValue=C,A.zepto=X,A}();window.Zepto=Zepto,void 0===window.$&&(window.$=Zepto),function(e){function t(e){return e._zid||(e._zid=p++)}function r(e,r,a,s){if(r=n(r),r.ns)var o=i(r.ns);return(g[t(e)]||[]).filter(function(e){return e&&(!r.e||e.e==r.e)&&(!r.ns||o.test(e.ns))&&(!a||t(e.fn)===t(a))&&(!s||e.sel==s)})}function n(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function i(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function a(e,t){return e.del&&!v&&e.e in C||!!t}function s(e){return E[e]||v&&C[e]||e}function o(r,i,o,u,l,p,d){var h=t(r),y=g[h]||(g[h]=[]);i.split(/\s/).forEach(function(t){if("ready"==t)return e(document).ready(o);var i=n(t);i.fn=o,i.sel=l,i.e in E&&(o=function(t){var r=t.relatedTarget;return!r||r!==this&&!e.contains(this,r)?i.fn.apply(this,arguments):void 0}),i.del=p;var h=p||o;i.proxy=function(e){if(e=c(e),!e.isImmediatePropagationStopped()){e.data=u;var t=h.apply(r,e._args==f?[e]:[e].concat(e._args));return t===!1&&(e.preventDefault(),e.stopPropagation()),t}},i.i=y.length,y.push(i),"addEventListener"in r&&r.addEventListener(s(i.e),i.proxy,a(i,d))})}function u(e,n,i,o,u){var c=t(e);(n||"").split(/\s/).forEach(function(t){r(e,t,i,o).forEach(function(t){delete g[c][t.i],"removeEventListener"in e&&e.removeEventListener(s(t.e),t.proxy,a(t,u))})})}function c(t,r){return(r||!t.isDefaultPrevented)&&(r||(r=t),e.each(b,function(e,n){var i=r[e];t[e]=function(){return this[n]=S,i&&i.apply(r,arguments)},t[n]=T}),(r.defaultPrevented!==f?r.defaultPrevented:"returnValue"in r?r.returnValue===!1:r.getPreventDefault&&r.getPreventDefault())&&(t.isDefaultPrevented=S)),t}function l(e){var t,r={originalEvent:e};for(t in e)A.test(t)||e[t]===f||(r[t]=e[t]);return c(r,e)}var f,p=1,d=Array.prototype.slice,h=e.isFunction,y=function(e){return"string"==typeof e},g={},m={},v="onfocusin"in window,C={focus:"focusin",blur:"focusout"},E={mouseenter:"mouseover",mouseleave:"mouseout"};m.click=m.mousedown=m.mouseup=m.mousemove="MouseEvents",e.event={add:o,remove:u},e.proxy=function(r,n){var i=2 in arguments&&d.call(arguments,2);if(h(r)){var a=function(){return r.apply(n,i?i.concat(d.call(arguments)):arguments)};return a._zid=t(r),a}if(y(n))return i?(i.unshift(r[n],r),e.proxy.apply(null,i)):e.proxy(r[n],r);throw new TypeError("expected function")},e.fn.bind=function(e,t,r){return this.on(e,t,r)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.one=function(e,t,r,n){return this.on(e,t,r,n,1)};var S=function(){return!0},T=function(){return!1},A=/^([A-Z]|returnValue$|layer[XY]$)/,b={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(e,t,r){return this.on(t,e,r)},e.fn.undelegate=function(e,t,r){return this.off(t,e,r)},e.fn.live=function(t,r){return e(document.body).delegate(this.selector,t,r),this},e.fn.die=function(t,r){return e(document.body).undelegate(this.selector,t,r),this},e.fn.on=function(t,r,n,i,a){var s,c,p=this;return t&&!y(t)?(e.each(t,function(e,t){p.on(e,r,n,t,a)}),p):(y(r)||h(i)||i===!1||(i=n,n=r,r=f),(h(n)||n===!1)&&(i=n,n=f),i===!1&&(i=T),p.each(function(f,p){a&&(s=function(e){return u(p,e.type,i),i.apply(this,arguments)}),r&&(c=function(t){var n,a=e(t.target).closest(r,p).get(0);return a&&a!==p?(n=e.extend(l(t),{currentTarget:a,liveFired:p}),(s||i).apply(a,[n].concat(d.call(arguments,1)))):void 0}),o(p,t,i,n,r,c||s)}))},e.fn.off=function(t,r,n){var i=this;return t&&!y(t)?(e.each(t,function(e,t){i.off(e,r,t)}),i):(y(r)||h(n)||n===!1||(n=r,r=f),n===!1&&(n=T),i.each(function(){u(this,t,n,r)}))},e.fn.trigger=function(t,r){return t=y(t)||e.isPlainObject(t)?e.Event(t):c(t),t._args=r,this.each(function(){t.type in C&&"function"==typeof this[t.type]?this[t.type]():"dispatchEvent"in this?this.dispatchEvent(t):e(this).triggerHandler(t,r)})},e.fn.triggerHandler=function(t,n){var i,a;return this.each(function(s,o){i=l(y(t)?e.Event(t):t),i._args=n,i.target=o,e.each(r(o,t.type||t),function(e,t){return a=t.proxy(i),i.isImmediatePropagationStopped()?!1:void 0})}),a},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}}),e.Event=function(e,t){y(e)||(t=e,e=t.type);var r=document.createEvent(m[e]||"Events"),n=!0;if(t)for(var i in t)"bubbles"==i?n=!!t[i]:r[i]=t[i];return r.initEvent(e,n,!0),c(r)}}(Zepto),function(e){function t(t,r,n){var i=e.Event(r);return e(t).trigger(i,n),!i.isDefaultPrevented()}function r(e,r,n,i){return e.global?t(r||v,n,i):void 0}function n(t){t.global&&0===e.active++&&r(t,null,"ajaxStart")}function i(t){t.global&&!--e.active&&r(t,null,"ajaxStop")}function a(e,t){var n=t.context;return t.beforeSend.call(n,e,t)===!1||r(t,n,"ajaxBeforeSend",[e,t])===!1?!1:void r(t,n,"ajaxSend",[e,t])}function s(e,t,n,i){var a=n.context,s="success";n.success.call(a,e,s,t),i&&i.resolveWith(a,[e,s,t]),r(n,a,"ajaxSuccess",[t,n,e]),u(s,t,n)}function o(e,t,n,i,a){var s=i.context;i.error.call(s,n,t,e),a&&a.rejectWith(s,[n,t,e]),r(i,s,"ajaxError",[n,i,e||t]),u(t,n,i)}function u(e,t,n){var a=n.context;n.complete.call(a,t,e),r(n,a,"ajaxComplete",[t,n]),i(n)}function c(){}function l(e){return e&&(e=e.split(";",2)[0]),e&&(e==A?"html":e==T?"json":E.test(e)?"script":S.test(e)&&"xml")||"text"}function f(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function p(t){t.processData&&t.data&&"string"!=e.type(t.data)&&(t.data=e.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=f(t.url,t.data),t.data=void 0)}function d(t,r,n,i){return e.isFunction(r)&&(i=n,n=r,r=void 0),e.isFunction(n)||(i=n,n=void 0),{url:t,data:r,success:n,dataType:i}}function h(t,r,n,i){var a,s=e.isArray(r),o=e.isPlainObject(r);e.each(r,function(r,u){a=e.type(u),i&&(r=n?i:i+"["+(o||"object"==a||"array"==a?r:"")+"]"),!i&&s?t.add(u.name,u.value):"array"==a||!n&&"object"==a?h(t,u,n,r):t.add(r,u)})}var y,g,m=0,v=window.document,C=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,E=/^(?:text|application)\/javascript/i,S=/^(?:text|application)\/xml/i,T="application/json",A="text/html",b=/^\s*$/,I=v.createElement("a");I.href=window.location.href,e.active=0,e.ajaxJSONP=function(t,r){if(!("type"in t))return e.ajax(t);var n,i,u=t.jsonpCallback,c=(e.isFunction(u)?u():u)||"jsonp"+ ++m,l=v.createElement("script"),f=window[c],p=function(t){e(l).triggerHandler("error",t||"abort")},d={abort:p};return r&&r.promise(d),e(l).on("load error",function(a,u){clearTimeout(i),e(l).off().remove(),"error"!=a.type&&n?s(n[0],d,t,r):o(null,u||"error",d,t,r),window[c]=f,n&&e.isFunction(f)&&f(n[0]),f=n=void 0}),a(d,t)===!1?(p("abort"),d):(window[c]=function(){n=arguments},l.src=t.url.replace(/\?(.+)=\?/,"?$1="+c),v.head.appendChild(l),t.timeout>0&&(i=setTimeout(function(){p("timeout")},t.timeout)),d)},e.ajaxSettings={type:"GET",beforeSend:c,success:c,error:c,complete:c,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:T,xml:"application/xml, text/xml",html:A,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},e.ajax=function(t){var r,i=e.extend({},t||{}),u=e.Deferred&&e.Deferred();for(y in e.ajaxSettings)void 0===i[y]&&(i[y]=e.ajaxSettings[y]);n(i),i.crossDomain||(r=v.createElement("a"),r.href=i.url,r.href=r.href,i.crossDomain=I.protocol+"//"+I.host!=r.protocol+"//"+r.host),i.url||(i.url=window.location.toString()),p(i);var d=i.dataType,h=/\?.+=\?/.test(i.url);if(h&&(d="jsonp"),i.cache!==!1&&(t&&t.cache===!0||"script"!=d&&"jsonp"!=d)||(i.url=f(i.url,"_="+Date.now())),"jsonp"==d)return h||(i.url=f(i.url,i.jsonp?i.jsonp+"=?":i.jsonp===!1?"":"callback=?")),e.ajaxJSONP(i,u);var m,C=i.accepts[d],E={},S=function(e,t){E[e.toLowerCase()]=[e,t]},T=/^([\w-]+:)\/\//.test(i.url)?RegExp.$1:window.location.protocol,A=i.xhr(),B=A.setRequestHeader;if(u&&u.promise(A),i.crossDomain||S("X-Requested-With","XMLHttpRequest"),S("Accept",C||"*/*"),(C=i.mimeType||C)&&(C.indexOf(",")>-1&&(C=C.split(",",2)[0]),A.overrideMimeType&&A.overrideMimeType(C)),(i.contentType||i.contentType!==!1&&i.data&&"GET"!=i.type.toUpperCase())&&S("Content-Type",i.contentType||"application/x-www-form-urlencoded"),i.headers)for(g in i.headers)S(g,i.headers[g]);if(A.setRequestHeader=S,A.onreadystatechange=function(){if(4==A.readyState){A.onreadystatechange=c,clearTimeout(m);var t,r=!1;if(A.status>=200&&A.status<300||304==A.status||0==A.status&&"file:"==T){d=d||l(i.mimeType||A.getResponseHeader("content-type")),t=A.responseText;try{"script"==d?(1,eval)(t):"xml"==d?t=A.responseXML:"json"==d&&(t=b.test(t)?null:e.parseJSON(t))}catch(n){r=n}r?o(r,"parsererror",A,i,u):s(t,A,i,u)}else o(A.statusText||null,A.status?"error":"abort",A,i,u)}},a(A,i)===!1)return A.abort(),o(null,"abort",A,i,u),A;if(i.xhrFields)for(g in i.xhrFields)A[g]=i.xhrFields[g];var N="async"in i?i.async:!0;A.open(i.type,i.url,N,i.username,i.password);for(g in E)B.apply(A,E[g]);return i.timeout>0&&(m=setTimeout(function(){A.onreadystatechange=c,A.abort(),o(null,"timeout",A,i,u)},i.timeout)),A.send(i.data?i.data:null),A},e.get=function(){return e.ajax(d.apply(null,arguments))},e.post=function(){var t=d.apply(null,arguments);return t.type="POST",e.ajax(t)},e.getJSON=function(){var t=d.apply(null,arguments);return t.dataType="json",e.ajax(t)},e.fn.load=function(t,r,n){if(!this.length)return this;var i,a=this,s=t.split(/\s/),o=d(t,r,n),u=o.success;return s.length>1&&(o.url=s[0],i=s[1]),o.success=function(t){a.html(i?e("<div>").html(t.replace(C,"")).find(i):t),u&&u.apply(a,arguments)},e.ajax(o),this};var B=encodeURIComponent;e.param=function(t,r){var n=[];return n.add=function(t,r){e.isFunction(r)&&(r=r()),null==r&&(r=""),this.push(B(t)+"="+B(r))},h(n,t,r),n.join("&").replace(/%20/g,"+")}}(Zepto),function(e){e.fn.serializeArray=function(){var t,r,n=[],i=function(e){return e.forEach?e.forEach(i):void n.push({name:t,value:e})};return this[0]&&e.each(this[0].elements,function(n,a){r=a.type,t=a.name,t&&"fieldset"!=a.nodeName.toLowerCase()&&!a.disabled&&"submit"!=r&&"reset"!=r&&"button"!=r&&"file"!=r&&("radio"!=r&&"checkbox"!=r||a.checked)&&i(e(a).val())}),n},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},e.fn.submit=function(t){if(0 in arguments)this.bind("submit",t);else if(this.length){var r=e.Event("submit");this.eq(0).trigger(r),r.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),function(e){"__proto__"in{}||e.extend(e.zepto,{Z:function(t,r){return t=t||[],e.extend(t,e.fn),t.selector=r||"",t.__Z=!0,t},isZ:function(t){return"array"===e.type(t)&&"__Z"in t}});try{getComputedStyle(void 0)}catch(t){var r=getComputedStyle;window.getComputedStyle=function(e){try{return r(e)}catch(t){return null}}}}(Zepto),function(e,t){"function"==typeof define&&define.amd?define([],t):e.forge=t()}(this,function(){var e,t,r;return function(n){function i(e,t){return E.call(e,t)}function a(e,t){var r,n,i,a,s,o,u,c,l,f,p,d=t&&t.split("/"),h=v.map,y=h&&h["*"]||{};if(e&&"."===e.charAt(0))if(t){for(d=d.slice(0,d.length-1),e=e.split("/"),s=e.length-1,v.nodeIdCompat&&T.test(e[s])&&(e[s]=e[s].replace(T,"")),e=d.concat(e),l=0;l<e.length;l+=1)if(p=e[l],"."===p)e.splice(l,1),l-=1;else if(".."===p){if(1===l&&(".."===e[2]||".."===e[0]))break;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||y)&&h){for(r=e.split("/"),l=r.length;l>0;l-=1){if(n=r.slice(0,l).join("/"),d)for(f=d.length;f>0;f-=1)if(i=h[d.slice(0,f).join("/")],i&&(i=i[n])){a=i,o=l;break}if(a)break;!u&&y&&y[n]&&(u=y[n],c=l)}!a&&u&&(a=u,o=c),a&&(r.splice(0,o,a),e=r.join("/"))}return e}function s(e,t){return function(){return d.apply(n,S.call(arguments,0).concat([e,t]))}}function o(e){return function(t){return a(t,e)}}function u(e){return function(t){g[e]=t}}function c(e){if(i(m,e)){var t=m[e];delete m[e],C[e]=!0,p.apply(n,t)}if(!i(g,e)&&!i(C,e))throw new Error("No "+e);return g[e]}function l(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function f(e){return function(){return v&&v.config&&v.config[e]||{}}}var p,d,h,y,g={},m={},v={},C={},E=Object.prototype.hasOwnProperty,S=[].slice,T=/\.js$/;h=function(e,t){var r,n=l(e),i=n[0];return e=n[1],i&&(i=a(i,t),r=c(i)),i?e=r&&r.normalize?r.normalize(e,o(t)):a(e,t):(e=a(e,t),n=l(e),i=n[0],e=n[1],i&&(r=c(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:r}},y={require:function(e){return s(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:f(e)}}},p=function(e,t,r,a){var o,l,f,p,d,v,E=[],S=typeof r;if(a=a||e,"undefined"===S||"function"===S){for(t=!t.length&&r.length?["require","exports","module"]:t,d=0;d<t.length;d+=1)if(p=h(t[d],a),l=p.f,"require"===l)E[d]=y.require(e);else if("exports"===l)E[d]=y.exports(e),v=!0;else if("module"===l)o=E[d]=y.module(e);else if(i(g,l)||i(m,l)||i(C,l))E[d]=c(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,s(a,!0),u(l),{}),E[d]=g[l]}f=r?r.apply(g[e],E):void 0,e&&(o&&o.exports!==n&&o.exports!==g[e]?g[e]=o.exports:f===n&&v||(g[e]=f))}else e&&(g[e]=r)},e=t=d=function(e,t,r,i,a){if("string"==typeof e)return y[e]?y[e](t):c(h(e,t).f);if(!e.splice){if(v=e,v.deps&&d(v.deps,v.callback),!t)return;t.splice?(e=t,t=r,r=null):e=n}return t=t||function(){},"function"==typeof r&&(r=i,i=a),i?p(n,e,t,r):setTimeout(function(){p(n,e,t,r)},4),d},d.config=function(e){return d(e)},e._defined=g,r=function(e,t,r){t.splice||(r=t,t=[]),i(g,e)||i(m,e)||(m[e]=[e,t,r])},r.amd={jQuery:!0}}(),r("node_modules/almond/almond",function(){}),function(){function e(e){function t(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(n.isArrayBuffer(e)||n.isArrayBufferView(e)){var r=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,r)}catch(i){for(var a=0;a<r.length;++a)this.putByte(r[a])}}else(e instanceof t||"object"==typeof e&&"string"==typeof e.data&&"number"==typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}function r(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=n.isArrayBuffer(e),i=n.isArrayBufferView(e);return r||i?(r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength)):(this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==e&&void 0!==e&&this.putBytes(e),void("writeOffset"in t&&(this.write=t.writeOffset)))}var n=e.util=e.util||{};!function(){function e(e){if(e.source===window&&e.data===t){e.stopPropagation();var n=r.slice();r.length=0,n.forEach(function(e){e()})}}if("undefined"!=typeof process&&process.nextTick)return n.nextTick=process.nextTick,void("function"==typeof setImmediate?n.setImmediate=setImmediate:n.setImmediate=n.nextTick);if("function"==typeof setImmediate)return n.setImmediate=setImmediate,void(n.nextTick=function(e){return setImmediate(e)});if(n.setImmediate=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var t="forge.setImmediate",r=[];n.setImmediate=function(e){r.push(e),1===r.length&&window.postMessage(t,"*")},window.addEventListener("message",e,!0)}if("undefined"!=typeof MutationObserver){var i=Date.now(),a=!0,s=document.createElement("div"),r=[];new MutationObserver(function(){var e=r.slice();r.length=0,e.forEach(function(e){e()})}).observe(s,{attributes:!0});var o=n.setImmediate;n.setImmediate=function(e){Date.now()-i>15?(i=Date.now(),o(e)):(r.push(e),1===r.length&&s.setAttribute("a",a=!a))}}n.nextTick=n.setImmediate}(),n.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer},n.isArrayBufferView=function(e){return e&&n.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},n.ByteBuffer=t,n.ByteStringBuffer=t;var i=4096;n.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>i&&(this.data.substr(0,1),this._constructedStringLength=0)},n.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},n.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},n.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},n.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},n.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},n.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(n.encodeUtf8(e))},n.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},n.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},n.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},n.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},n.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},n.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255));
},n.ByteStringBuffer.prototype.putInt=function(e,t){var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)},n.ByteStringBuffer.prototype.putSignedInt=function(e,t){return 0>e&&(e+=2<<t-1),this.putInt(e,t)},n.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},n.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},n.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},n.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},n.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},n.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},n.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},n.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},n.ByteStringBuffer.prototype.getInt=function(e){var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t},n.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},n.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},n.ByteStringBuffer.prototype.bytes=function(e){return"undefined"==typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},n.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},n.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},n.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},n.ByteStringBuffer.prototype.copy=function(){var e=n.createBuffer(this.data);return e.read=this.read,e},n.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},n.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},n.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},n.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);16>r&&(e+="0"),e+=r.toString(16)}return e},n.ByteStringBuffer.prototype.toString=function(){return n.decodeUtf8(this.bytes())},n.DataBuffer=r,n.DataBuffer.prototype.length=function(){return this.write-this.read},n.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},n.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},n.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},n.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;t>r;++r)this.data.setUint8(e);return this},n.DataBuffer.prototype.putBytes=function(e,t){if(n.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),i=r.byteLength-r.byteOffset;this.accommodate(i);var a=new Uint8Array(this.data.buffer,this.write);return a.set(r),this.write+=i,this}if(n.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var a=new Uint8Array(this.data.buffer);return a.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof n.DataBuffer||"object"==typeof e&&"number"==typeof e.read&&"number"==typeof e.write&&n.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var a=new Uint8Array(e.data.byteLength,this.write);return a.set(r),this.write+=r.byteLength,this}if(e instanceof n.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"==typeof e){var s;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=n.binary.hex.decode(e,s,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),s=new Uint8Array(this.data.buffer,this.write),this.write+=n.binary.base64.decode(e,s,this.write),this;if("utf8"===t&&(e=n.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=n.binary.raw.decode(s),this;if("utf16"===t)return this.accommodate(2*e.length),s=new Uint16Array(this.data.buffer,this.write),this.write+=n.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},n.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},n.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},n.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},n.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},n.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},n.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},n.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},n.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},n.DataBuffer.prototype.putInt=function(e,t){this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this},n.DataBuffer.prototype.putSignedInt=function(e,t){return this.accommodate(t/8),0>e&&(e+=2<<t-1),this.putInt(e,t)},n.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},n.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},n.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},n.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},n.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},n.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},n.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},n.DataBuffer.prototype.getInt=function(e){var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t},n.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},n.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},n.DataBuffer.prototype.bytes=function(e){return"undefined"==typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},n.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},n.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},n.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},n.DataBuffer.prototype.copy=function(){return new n.DataBuffer(this)},n.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},n.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},n.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},n.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);16>r&&(e+="0"),e+=r.toString(16)}return e},n.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8","binary"===e||"raw"===e)return n.binary.raw.encode(t);if("hex"===e)return n.binary.hex.encode(t);if("base64"===e)return n.binary.base64.encode(t);if("utf8"===e)return n.text.utf8.decode(t);if("utf16"===e)return n.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},n.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=n.encodeUtf8(e)),new n.ByteBuffer(e)},n.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),t>>>=1,t>0&&(e+=e);return r},n.xorBytes=function(e,t,r){for(var n="",i="",a="",s=0,o=0;r>0;--r,++s)i=e.charCodeAt(s)^t.charCodeAt(s),o>=10&&(n+=a,a="",o=0),a+=String.fromCharCode(i),++o;return n+=a},n.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},n.bytesToHex=function(e){return n.createBuffer(e).toHex()},n.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];n.encode64=function(e,t){for(var r,n,i,s="",o="",u=0;u<e.length;)r=e.charCodeAt(u++),n=e.charCodeAt(u++),i=e.charCodeAt(u++),s+=a.charAt(r>>2),s+=a.charAt((3&r)<<4|n>>4),isNaN(n)?s+="==":(s+=a.charAt((15&n)<<2|i>>6),s+=isNaN(i)?"=":a.charAt(63&i)),t&&s.length>t&&(o+=s.substr(0,t)+"\r\n",s=s.substr(t));return o+=s},n.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,i,a="",o=0;o<e.length;)t=s[e.charCodeAt(o++)-43],r=s[e.charCodeAt(o++)-43],n=s[e.charCodeAt(o++)-43],i=s[e.charCodeAt(o++)-43],a+=String.fromCharCode(t<<2|r>>4),64!==n&&(a+=String.fromCharCode((15&r)<<4|n>>2),64!==i&&(a+=String.fromCharCode((3&n)<<6|i)));return a},n.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},n.decodeUtf8=function(e){return decodeURIComponent(escape(e))},n.binary={raw:{},hex:{},base64:{}},n.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},n.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,a=0;a<e.length;++a)n[i++]=e.charCodeAt(a);return t?i-r:n},n.binary.hex.encode=n.bytesToHex,n.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,a=r;for(1&e.length&&(i=1,n[a++]=parseInt(e[0],16));i<e.length;i+=2)n[a++]=parseInt(e.substr(i,2),16);return t?a-r:n},n.binary.base64.encode=function(e,t){for(var r,n,i,s="",o="",u=0;u<e.byteLength;)r=e[u++],n=e[u++],i=e[u++],s+=a.charAt(r>>2),s+=a.charAt((3&r)<<4|n>>4),isNaN(n)?s+="==":(s+=a.charAt((15&n)<<2|i>>6),s+=isNaN(i)?"=":a.charAt(63&i)),t&&s.length>t&&(o+=s.substr(0,t)+"\r\n",s=s.substr(t));return o+=s},n.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,a,o,u,c=0,l=r;c<e.length;)i=s[e.charCodeAt(c++)-43],a=s[e.charCodeAt(c++)-43],o=s[e.charCodeAt(c++)-43],u=s[e.charCodeAt(c++)-43],n[l++]=i<<2|a>>4,64!==o&&(n[l++]=(15&a)<<4|o>>2,64!==u&&(n[l++]=(3&o)<<6|u));return t?l-r:n.subarray(0,l)},n.text={utf8:{},utf16:{}},n.text.utf8.encode=function(e,t,r){e=n.encodeUtf8(e);var i=t;i||(i=new Uint8Array(e.length)),r=r||0;for(var a=r,s=0;s<e.length;++s)i[a++]=e.charCodeAt(s);return t?a-r:i},n.text.utf8.decode=function(e){return n.decodeUtf8(String.fromCharCode.apply(null,e))},n.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));var i=new Uint16Array(n.buffer);r=r||0;for(var a=r,s=r,o=0;o<e.length;++o)i[s++]=e.charCodeAt(o),a+=2;return t?a-r:n},n.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},n.deflate=function(e,t,r){if(t=n.decode64(e.deflate(n.encode64(t)).rval),r){var i=2,a=t.charCodeAt(1);32&a&&(i=6),t=t.substring(i,t.length-4)}return t},n.inflate=function(e,t,r){var i=e.inflate(n.encode64(t)).rval;return null===i?null:n.decode64(i)};var o=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var i;if(null===r?i=e.removeItem(t):(r=n.encode64(JSON.stringify(r)),i=e.setItem(t,r)),"undefined"!=typeof i&&i.rval!==!0){var a=new Error(i.error.message);throw a.id=i.error.id,a.name=i.error.name,a}},u=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error){var i=new Error(r.error.message);throw i.id=r.error.id,i.name=r.error.name,i}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(n.decode64(r))),r},c=function(e,t,r,n){var i=u(e,t);null===i&&(i={}),i[r]=n,o(e,t,i)},l=function(e,t,r){var n=u(e,t);return null!==n&&(n=r in n?n[r]:null),n},f=function(e,t,r){var n=u(e,t);if(null!==n&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),o(e,t,n)}},p=function(e,t){o(e,t,null)},d=function(e,t,r){var n=null;"undefined"==typeof r&&(r=["web","flash"]);var i,a=!1,s=null;for(var o in r){i=r[o];try{if("flash"===i||"both"===i){if(null===t[0])throw new Error("Flash local storage not available.");n=e.apply(this,t),a="flash"===i}("web"===i||"both"===i)&&(t[0]=localStorage,n=e.apply(this,t),a=!0)}catch(u){s=u}if(a)break}if(!a)throw s;return n};n.setItem=function(e,t,r,n,i){d(c,arguments,i)},n.getItem=function(e,t,r,n){return d(l,arguments,n)},n.removeItem=function(e,t,r,n){d(f,arguments,n)},n.clearItems=function(e,t,r){d(p,arguments,r)},n.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e),n=null===r?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?80!==n.port&&"http"===n.scheme?n.fullHost+=":"+n.port:443!==n.port&&"https"===n.scheme&&(n.fullHost+=":"+n.port):"http"===n.scheme?n.port=80:"https"===n.scheme&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var h=null;n.getQueryVariables=function(e){var t,r=function(e){for(var t={},r=e.split("&"),n=0;n<r.length;n++){var i,a,s=r[n].indexOf("=");s>0?(i=r[n].substring(0,s),a=r[n].substring(s+1)):(i=r[n],a=null),i in t||(t[i]=[]),i in Object.prototype||null===a||t[i].push(unescape(a))}return t};return"undefined"==typeof e?(null===h&&(h="undefined"!=typeof window&&window.location&&window.location.search?r(window.location.search.substring(1)):{}),t=h):t=r(e),t},n.parseFragment=function(e){var t=e,r="",i=e.indexOf("?");i>0&&(t=e.substring(0,i),r=e.substring(i+1));var a=t.split("/");a.length>0&&""===a[0]&&a.shift();var s=""===r?{}:n.getQueryVariables(r);return{pathString:t,queryString:r,path:a,query:s}},n.makeRequest=function(e){var t=n.parseFragment(e),r={path:t.pathString,query:t.queryString,getPath:function(e){return"undefined"==typeof e?t.path:t.path[e]},getQuery:function(e,r){var n;return"undefined"==typeof e?n=t.query:(n=t.query[e],n&&"undefined"!=typeof r&&(n=n[r])),n},getQueryLast:function(e,t){var n,i=r.getQuery(e);return n=i?i[i.length-1]:t}};return r},n.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var n=jQuery.param(t||{});return r=r||"",e+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")},n.setPath=function(e,t,r){if("object"==typeof e&&null!==e)for(var n=0,i=t.length;i>n;){var a=t[n++];if(n==i)e[a]=r;else{var s=a in e;(!s||s&&"object"!=typeof e[a]||s&&null===e[a])&&(e[a]={}),e=e[a]}}},n.getPath=function(e,t,r){for(var n=0,i=t.length,a=!0;a&&i>n&&"object"==typeof e&&null!==e;){var s=t[n++];a=s in e,a&&(e=e[s])}return a?e:r},n.deletePath=function(e,t){if("object"==typeof e&&null!==e)for(var r=0,n=t.length;n>r;){var i=t[r++];if(r==n)delete e[i];else{if(!(i in e)||"object"!=typeof e[i]||null===e[i])break;e=e[i]}}},n.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},n.format=function(e){for(var t,r,n=/%./g,i=0,a=[],s=0;t=n.exec(e);){r=e.substring(s,n.lastIndex-2),r.length>0&&a.push(r),s=n.lastIndex;var o=t[0][1];switch(o){case"s":case"o":i<arguments.length?a.push(arguments[i++ +1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(e.substring(s)),a.join("")},n.formatNumber=function(e,t,r,n){var i=e,a=isNaN(t=Math.abs(t))?2:t,s=void 0===r?",":r,o=void 0===n?".":n,u=0>i?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",l=c.length>3?c.length%3:0;return u+(l?c.substr(0,l)+o:"")+c.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(i-c).toFixed(a).slice(2):"")},n.formatSize=function(e){return e=e>=1073741824?n.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?n.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?n.formatNumber(e/1024,0)+" KiB":n.formatNumber(e,0)+" bytes"},n.bytesFromIP=function(e){return-1!==e.indexOf(".")?n.bytesFromIPv4(e):-1!==e.indexOf(":")?n.bytesFromIPv6(e):null},n.bytesFromIPv4=function(e){if(e=e.split("."),4!==e.length)return null;for(var t=n.createBuffer(),r=0;r<e.length;++r){var i=parseInt(e[r],10);if(isNaN(i))return null;t.putByte(i)}return t.getBytes()},n.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(e){return 0===e.length&&++t,!0});for(var r=2*(8-e.length+t),i=n.createBuffer(),a=0;8>a;++a)if(e[a]&&0!==e[a].length){var s=n.hexToBytes(e[a]);s.length<2&&i.putByte(0),i.putBytes(s)}else i.fillWithByte(0,r),r=0;return i.getBytes()},n.bytesToIP=function(e){return 4===e.length?n.bytesToIPv4(e):16===e.length?n.bytesToIPv6(e):null},n.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},n.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],i=0,a=0;a<e.length;a+=2){for(var s=n.bytesToHex(e[a]+e[a+1]);"0"===s[0]&&"0"!==s;)s=s.substr(1);if("0"===s){var o=r[r.length-1],u=t.length;o&&u===o.end+1?(o.end=u,o.end-o.start>r[i].end-r[i].start&&(i=r.length-1)):r.push({start:u,end:u})}t.push(s)}if(r.length>0){var c=r[i];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),0===c.start&&t.unshift(""),7===c.end&&t.push(""))}return t.join(":")},n.estimateCores=function(e,t){function r(e,o,u){if(0===o){var c=Math.floor(e.reduce(function(e,t){return e+t},0)/e.length);return n.cores=Math.max(1,c),URL.revokeObjectURL(s),t(null,n.cores)}i(u,function(t,n){e.push(a(u,n)),r(e,o-1,u)})}function i(e,t){for(var r=[],n=[],i=0;e>i;++i){var a=new Worker(s);a.addEventListener("message",function(i){if(n.push(i.data),n.length===e){for(var a=0;e>a;++a)r[a].terminate();t(null,n)}}),r.push(a)}for(var i=0;e>i;++i)r[i].postMessage(i)}function a(e,t){for(var r=[],n=0;e>n;++n)for(var i=t[n],a=r[n]=[],s=0;e>s;++s)if(n!==s){var o=t[s];(i.st>o.st&&i.st<o.et||o.st>i.st&&o.st<i.et)&&a.push(s)}return r.reduce(function(e,t){return Math.max(e,t.length)},0)}if("function"==typeof e&&(t=e,e={}),e=e||{},"cores"in n&&!e.update)return t(null,n.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return n.cores=navigator.hardwareConcurrency,t(null,n.cores);if("undefined"==typeof Worker)return n.cores=1,t(null,n.cores);if("undefined"==typeof Blob)return n.cores=2,t(null,n.cores);var s=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})})}.toString(),")()"],{type:"application/javascript"}));r([],5,16)}}var n="util";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/util",["require","module"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.cipher=e.cipher||{},e.cipher.algorithms=e.cipher.algorithms||{},e.cipher.createCipher=function(t,r){var n=t;if("string"==typeof n&&(n=e.cipher.getAlgorithm(n),n&&(n=n())),!n)throw new Error("Unsupported algorithm: "+t);return new e.cipher.BlockCipher({algorithm:n,key:r,decrypt:!1})},e.cipher.createDecipher=function(t,r){var n=t;if("string"==typeof n&&(n=e.cipher.getAlgorithm(n),n&&(n=n())),!n)throw new Error("Unsupported algorithm: "+t);return new e.cipher.BlockCipher({algorithm:n,key:r,decrypt:!0})},e.cipher.registerAlgorithm=function(t,r){t=t.toUpperCase(),e.cipher.algorithms[t]=r},e.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in e.cipher.algorithms?e.cipher.algorithms[t]:null};var t=e.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};t.prototype.start=function(t){t=t||{};var r={};for(var n in t)r[n]=t[n];r.decrypt=this._decrypt,this._finish=!1,this._input=e.util.createBuffer(),this.output=t.output||e.util.createBuffer(),this.mode.start(r)},t.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},t.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,this._decrypt||!this.mode.pad||this.mode.pad(this._input,t)?(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t)?!1:this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)?!1:!0):!1}}var n="cipher";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/cipher",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t){if("string"==typeof t&&(t=e.util.createBuffer(t)),e.util.isArray(t)&&t.length>4){var r=t;t=e.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}return e.util.isArray(t)||(t=[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]),t}function r(e){e[e.length-1]=e[e.length-1]+1&4294967295}function n(e){return[e/4294967296|0,4294967295&e]}e.cipher=e.cipher||{};var i=e.cipher.modes=e.cipher.modes||{};i.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.ecb.prototype.start=function(e){},i.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)},i.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=t(e.iv),this._prev=this._iv.slice(0)}},i.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},i.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},i.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)},i.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=e.util.createBuffer(),this._partialBytes=0},i.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=t(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=e.util.createBuffer(),this._partialBytes=0},i.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=t(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb.prototype.decrypt=i.ofb.prototype.encrypt,i.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=e.util.createBuffer(),this._partialBytes=0},i.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=t(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ctr.prototype.encrypt=function(e,t,n){var i=e.length();if(0===i)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&i>=this.blockSize)for(var a=0;a<this._ints;++a)t.putInt32(e.getInt32()^this._outBlock[a]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(e.getInt32()^this._outBlock[a]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!n)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}r(this._inBlock)},i.ctr.prototype.decrypt=i.ctr.prototype.encrypt,i.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=e.util.createBuffer(),this._partialBytes=0,this._R=3774873600},i.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var i=e.util.createBuffer(t.iv);this._cipherLength=0;var a;if(a="additionalData"in t?e.util.createBuffer(t.additionalData):e.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=e.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),
this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var s=i.length();if(12===s)this._j0=[i.getInt32(),i.getInt32(),i.getInt32(),1];else{for(this._j0=[0,0,0,0];i.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[i.getInt32(),i.getInt32(),i.getInt32(),i.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(n(8*s)))}this._inBlock=this._j0.slice(0),r(this._inBlock),this._partialBytes=0,a=e.util.createBuffer(a),this._aDataLength=n(8*a.length());var o=a.length()%this.blockSize;for(o&&a.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];a.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[a.getInt32(),a.getInt32(),a.getInt32(),a.getInt32()])},i.gcm.prototype.encrypt=function(e,t,n){var i=e.length();if(0===i)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&i>=this.blockSize){for(var a=0;a<this._ints;++a)t.putInt32(this._outBlock[a]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(e.getInt32()^this._outBlock[a]);if(0===s||n){if(n){var o=i%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var a=0;a<this._ints;++a)this._outBlock[a]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!n)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),r(this._inBlock)},i.gcm.prototype.decrypt=function(e,t,n){var i=e.length();if(i<this.blockSize&&!(n&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),r(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var a=0;a<this._ints;++a)t.putInt32(this._outBlock[a]^this._hashBlock[a]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize},i.gcm.prototype.afterFinish=function(t,r){var i=!0;r.decrypt&&r.overflow&&t.truncate(this.blockSize-r.overflow),this.tag=e.util.createBuffer();var a=this._aDataLength.concat(n(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,a);var s=[];this.cipher.encrypt(this._j0,s);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^s[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),r.decrypt&&this.tag.bytes()!==this._tag&&(i=!1),i},i.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;128>i;++i){var a=e[i/32|0]&1<<31-i%32;a&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r},i.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},i.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;32>r;++r){var n=r/8|0,i=e[n]>>>4*(7-r%8)&15,a=this._m[r][i];t[0]^=a[0],t[1]^=a[1],t[2]^=a[2],t[3]^=a[3]}return t},i.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},i.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,a=new Array(i),s=0;i>s;++s){var o=[0,0,0,0],u=s/n|0,c=(n-1-s%n)*t;o[u]=1<<t-1<<c,a[s]=this.generateSubHashTable(this.multiply(o,e),t)}return a},i.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;n>a;){for(var s=1;a>s;++s){var o=i[a],u=i[s];i[a+s]=[o[0]^u[0],o[1]^u[1],o[2]^u[2],o[3]^u[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;r>a;++a){var c=i[a^n];i[a]=[e[0]^c[0],e[1]^c[1],e[2]^c[2],e[3]^c[3]]}return i}}var n="cipherModes";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/cipherModes",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,r){var n=function(){return new e.aes.Algorithm(t,r)};e.cipher.registerAlgorithm(t,n)}function r(){f=!0,u=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;128>t;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;s=new Array(256),o=new Array(256),c=new Array(4),l=new Array(4);for(var t=0;4>t;++t)c[t]=new Array(256),l[t]=new Array(256);for(var r,n,i,a,p,d,h,y=0,g=0,t=0;256>t;++t){a=g^g<<1^g<<2^g<<3^g<<4,a=a>>8^255&a^99,s[y]=a,o[a]=y,p=e[a],r=e[y],n=e[r],i=e[n],d=p<<24^a<<16^a<<8^(a^p),h=(r^n^i)<<24^(y^i)<<16^(y^n^i)<<8^(y^r^i);for(var m=0;4>m;++m)c[m][y]=d,l[m][a]=h,d=d<<24|d>>>8,h=h<<24|h>>>8;0===y?y=g=1:(y=r^e[e[e[r^i]]],g^=e[e[g]])}}function n(e,t){for(var r,n=e.slice(0),i=1,a=n.length,o=a+6+1,c=p*o,f=a;c>f;++f)r=n[f-1],f%a===0?(r=s[r>>>16&255]<<24^s[r>>>8&255]<<16^s[255&r]<<8^s[r>>>24]^u[i]<<24,i++):a>6&&f%a===4&&(r=s[r>>>24]<<24^s[r>>>16&255]<<16^s[r>>>8&255]<<8^s[255&r]),n[f]=n[f-a]^r;if(t){var d,h=l[0],y=l[1],g=l[2],m=l[3],v=n.slice(0);c=n.length;for(var f=0,C=c-p;c>f;f+=p,C-=p)if(0===f||f===c-p)v[f]=n[C],v[f+1]=n[C+3],v[f+2]=n[C+2],v[f+3]=n[C+1];else for(var E=0;p>E;++E)d=n[C+E],v[f+(3&-E)]=h[s[d>>>24]]^y[s[d>>>16&255]]^g[s[d>>>8&255]]^m[s[255&d]];n=v}return n}function i(e,t,r,n){var i,a,u,f,p,d=e.length/4-1;n?(i=l[0],a=l[1],u=l[2],f=l[3],p=o):(i=c[0],a=c[1],u=c[2],f=c[3],p=s);var h,y,g,m,v,C,E;h=t[0]^e[0],y=t[n?3:1]^e[1],g=t[2]^e[2],m=t[n?1:3]^e[3];for(var S=3,T=1;d>T;++T)v=i[h>>>24]^a[y>>>16&255]^u[g>>>8&255]^f[255&m]^e[++S],C=i[y>>>24]^a[g>>>16&255]^u[m>>>8&255]^f[255&h]^e[++S],E=i[g>>>24]^a[m>>>16&255]^u[h>>>8&255]^f[255&y]^e[++S],m=i[m>>>24]^a[h>>>16&255]^u[y>>>8&255]^f[255&g]^e[++S],h=v,y=C,g=E;r[0]=p[h>>>24]<<24^p[y>>>16&255]<<16^p[g>>>8&255]<<8^p[255&m]^e[++S],r[n?3:1]=p[y>>>24]<<24^p[g>>>16&255]<<16^p[m>>>8&255]<<8^p[255&h]^e[++S],r[2]=p[g>>>24]<<24^p[m>>>16&255]<<16^p[h>>>8&255]<<8^p[255&y]^e[++S],r[n?1:3]=p[m>>>24]<<24^p[h>>>16&255]<<16^p[y>>>8&255]<<8^p[255&g]^e[++S]}function a(t){t=t||{};var r,n=(t.mode||"CBC").toUpperCase(),i="AES-"+n;r=t.decrypt?e.cipher.createDecipher(i,t.key):e.cipher.createCipher(i,t.key);var a=r.start;return r.start=function(t,n){var i=null;n instanceof e.util.ByteBuffer&&(i=n,n={}),n=n||{},n.output=i,n.iv=t,a.call(r,n)},r}e.aes=e.aes||{},e.aes.startEncrypting=function(e,t,r,n){var i=a({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i},e.aes.createEncryptionCipher=function(e,t){return a({key:e,output:null,decrypt:!1,mode:t})},e.aes.startDecrypting=function(e,t,r,n){var i=a({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i},e.aes.createDecryptionCipher=function(e,t){return a({key:e,output:null,decrypt:!0,mode:t})},e.aes.Algorithm=function(e,t){f||r();var n=this;n.name=e,n.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return i(n._w,e,t,!1)},decrypt:function(e,t){return i(n._w,e,t,!0)}}}),n._init=!1},e.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var r,i=t.key;if("string"!=typeof i||16!==i.length&&24!==i.length&&32!==i.length){if(e.util.isArray(i)&&(16===i.length||24===i.length||32===i.length)){r=i,i=e.util.createBuffer();for(var a=0;a<r.length;++a)i.putByte(r[a])}}else i=e.util.createBuffer(i);if(!e.util.isArray(i)){r=i,i=[];var s=r.length();if(16===s||24===s||32===s){s>>>=2;for(var a=0;s>a;++a)i.push(r.getInt32())}}if(!e.util.isArray(i)||4!==i.length&&6!==i.length&&8!==i.length)throw new Error("Invalid key parameter.");var o=this.mode.name,u=-1!==["CFB","OFB","CTR","GCM"].indexOf(o);this._w=n(i,t.decrypt&&!u),this._init=!0}},e.aes._expandKey=function(e,t){return f||r(),n(e,t)},e.aes._updateBlock=i,t("AES-ECB",e.cipher.modes.ecb),t("AES-CBC",e.cipher.modes.cbc),t("AES-CFB",e.cipher.modes.cfb),t("AES-OFB",e.cipher.modes.ofb),t("AES-CTR",e.cipher.modes.ctr),t("AES-GCM",e.cipher.modes.gcm);var s,o,u,c,l,f=!1,p=4}var n="aes";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/aes",["require","module","./cipher","./cipherModes","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.pki=e.pki||{};var t=e.pki.oids=e.oids=e.oids||{};t["1.2.840.113549.1.1.1"]="rsaEncryption",t.rsaEncryption="1.2.840.113549.1.1.1",t["1.2.840.113549.1.1.4"]="md5WithRSAEncryption",t.md5WithRSAEncryption="1.2.840.113549.1.1.4",t["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption",t.sha1WithRSAEncryption="1.2.840.113549.1.1.5",t["1.2.840.113549.1.1.7"]="RSAES-OAEP",t["RSAES-OAEP"]="1.2.840.113549.1.1.7",t["1.2.840.113549.1.1.8"]="mgf1",t.mgf1="1.2.840.113549.1.1.8",t["1.2.840.113549.1.1.9"]="pSpecified",t.pSpecified="1.2.840.113549.1.1.9",t["1.2.840.113549.1.1.10"]="RSASSA-PSS",t["RSASSA-PSS"]="1.2.840.113549.1.1.10",t["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption",t.sha256WithRSAEncryption="1.2.840.113549.1.1.11",t["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption",t.sha384WithRSAEncryption="1.2.840.113549.1.1.12",t["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption",t.sha512WithRSAEncryption="1.2.840.113549.1.1.13",t["1.3.14.3.2.7"]="desCBC",t.desCBC="1.3.14.3.2.7",t["1.3.14.3.2.26"]="sha1",t.sha1="1.3.14.3.2.26",t["2.16.840.1.101.3.4.2.1"]="sha256",t.sha256="2.16.840.1.101.3.4.2.1",t["2.16.840.1.101.3.4.2.2"]="sha384",t.sha384="2.16.840.1.101.3.4.2.2",t["2.16.840.1.101.3.4.2.3"]="sha512",t.sha512="2.16.840.1.101.3.4.2.3",t["1.2.840.113549.2.5"]="md5",t.md5="1.2.840.113549.2.5",t["1.2.840.113549.1.7.1"]="data",t.data="1.2.840.113549.1.7.1",t["1.2.840.113549.1.7.2"]="signedData",t.signedData="1.2.840.113549.1.7.2",t["1.2.840.113549.1.7.3"]="envelopedData",t.envelopedData="1.2.840.113549.1.7.3",t["1.2.840.113549.1.7.4"]="signedAndEnvelopedData",t.signedAndEnvelopedData="1.2.840.113549.1.7.4",t["1.2.840.113549.1.7.5"]="digestedData",t.digestedData="1.2.840.113549.1.7.5",t["1.2.840.113549.1.7.6"]="encryptedData",t.encryptedData="1.2.840.113549.1.7.6",t["1.2.840.113549.1.9.1"]="emailAddress",t.emailAddress="1.2.840.113549.1.9.1",t["1.2.840.113549.1.9.2"]="unstructuredName",t.unstructuredName="1.2.840.113549.1.9.2",t["1.2.840.113549.1.9.3"]="contentType",t.contentType="1.2.840.113549.1.9.3",t["1.2.840.113549.1.9.4"]="messageDigest",t.messageDigest="1.2.840.113549.1.9.4",t["1.2.840.113549.1.9.5"]="signingTime",t.signingTime="1.2.840.113549.1.9.5",t["1.2.840.113549.1.9.6"]="counterSignature",t.counterSignature="1.2.840.113549.1.9.6",t["1.2.840.113549.1.9.7"]="challengePassword",t.challengePassword="1.2.840.113549.1.9.7",t["1.2.840.113549.1.9.8"]="unstructuredAddress",t.unstructuredAddress="1.2.840.113549.1.9.8",t["1.2.840.113549.1.9.14"]="extensionRequest",t.extensionRequest="1.2.840.113549.1.9.14",t["1.2.840.113549.1.9.20"]="friendlyName",t.friendlyName="1.2.840.113549.1.9.20",t["1.2.840.113549.1.9.21"]="localKeyId",t.localKeyId="1.2.840.113549.1.9.21",t["1.2.840.113549.1.9.22.1"]="x509Certificate",t.x509Certificate="1.2.840.113549.1.9.22.1",t["1.2.840.113549.1.12.10.1.1"]="keyBag",t.keyBag="1.2.840.113549.1.12.10.1.1",t["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag",t.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2",t["1.2.840.113549.1.12.10.1.3"]="certBag",t.certBag="1.2.840.113549.1.12.10.1.3",t["1.2.840.113549.1.12.10.1.4"]="crlBag",t.crlBag="1.2.840.113549.1.12.10.1.4",t["1.2.840.113549.1.12.10.1.5"]="secretBag",t.secretBag="1.2.840.113549.1.12.10.1.5",t["1.2.840.113549.1.12.10.1.6"]="safeContentsBag",t.safeContentsBag="1.2.840.113549.1.12.10.1.6",t["1.2.840.113549.1.5.13"]="pkcs5PBES2",t.pkcs5PBES2="1.2.840.113549.1.5.13",t["1.2.840.113549.1.5.12"]="pkcs5PBKDF2",t.pkcs5PBKDF2="1.2.840.113549.1.5.12",t["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4",t.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1",t["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4",t.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2",t["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC",t["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3",t["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC",t["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4",t["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC",t["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5",t["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC",t["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6",t["1.2.840.113549.3.7"]="des-EDE3-CBC",t["des-EDE3-CBC"]="1.2.840.113549.3.7",t["2.16.840.1.101.3.4.1.2"]="aes128-CBC",t["aes128-CBC"]="2.16.840.1.101.3.4.1.2",t["2.16.840.1.101.3.4.1.22"]="aes192-CBC",t["aes192-CBC"]="2.16.840.1.101.3.4.1.22",t["2.16.840.1.101.3.4.1.42"]="aes256-CBC",t["aes256-CBC"]="2.16.840.1.101.3.4.1.42",t["2.5.4.3"]="commonName",t.commonName="2.5.4.3",t["2.5.4.5"]="serialName",t.serialName="2.5.4.5",t["2.5.4.6"]="countryName",t.countryName="2.5.4.6",t["2.5.4.7"]="localityName",t.localityName="2.5.4.7",t["2.5.4.8"]="stateOrProvinceName",t.stateOrProvinceName="2.5.4.8",t["2.5.4.10"]="organizationName",t.organizationName="2.5.4.10",t["2.5.4.11"]="organizationalUnitName",t.organizationalUnitName="2.5.4.11",t["2.16.840.1.113730.1.1"]="nsCertType",t.nsCertType="2.16.840.1.113730.1.1",t["2.5.29.1"]="authorityKeyIdentifier",t["2.5.29.2"]="keyAttributes",t["2.5.29.3"]="certificatePolicies",t["2.5.29.4"]="keyUsageRestriction",t["2.5.29.5"]="policyMapping",t["2.5.29.6"]="subtreesConstraint",t["2.5.29.7"]="subjectAltName",t["2.5.29.8"]="issuerAltName",t["2.5.29.9"]="subjectDirectoryAttributes",t["2.5.29.10"]="basicConstraints",t["2.5.29.11"]="nameConstraints",t["2.5.29.12"]="policyConstraints",t["2.5.29.13"]="basicConstraints",t["2.5.29.14"]="subjectKeyIdentifier",t.subjectKeyIdentifier="2.5.29.14",t["2.5.29.15"]="keyUsage",t.keyUsage="2.5.29.15",t["2.5.29.16"]="privateKeyUsagePeriod",t["2.5.29.17"]="subjectAltName",t.subjectAltName="2.5.29.17",t["2.5.29.18"]="issuerAltName",t.issuerAltName="2.5.29.18",t["2.5.29.19"]="basicConstraints",t.basicConstraints="2.5.29.19",t["2.5.29.20"]="cRLNumber",t["2.5.29.21"]="cRLReason",t["2.5.29.22"]="expirationDate",t["2.5.29.23"]="instructionCode",t["2.5.29.24"]="invalidityDate",t["2.5.29.25"]="cRLDistributionPoints",t["2.5.29.26"]="issuingDistributionPoint",t["2.5.29.27"]="deltaCRLIndicator",t["2.5.29.28"]="issuingDistributionPoint",t["2.5.29.29"]="certificateIssuer",t["2.5.29.30"]="nameConstraints",t["2.5.29.31"]="cRLDistributionPoints",t["2.5.29.32"]="certificatePolicies",t["2.5.29.33"]="policyMappings",t["2.5.29.34"]="policyConstraints",t["2.5.29.35"]="authorityKeyIdentifier",t["2.5.29.36"]="policyConstraints",t["2.5.29.37"]="extKeyUsage",t.extKeyUsage="2.5.29.37",t["2.5.29.46"]="freshestCRL",t["2.5.29.54"]="inhibitAnyPolicy",t["1.3.6.1.5.5.7.3.1"]="serverAuth",t.serverAuth="1.3.6.1.5.5.7.3.1",t["1.3.6.1.5.5.7.3.2"]="clientAuth",t.clientAuth="1.3.6.1.5.5.7.3.2",t["1.3.6.1.5.5.7.3.3"]="codeSigning",t.codeSigning="1.3.6.1.5.5.7.3.3",t["1.3.6.1.5.5.7.3.4"]="emailProtection",t.emailProtection="1.3.6.1.5.5.7.3.4",t["1.3.6.1.5.5.7.3.8"]="timeStamping",t.timeStamping="1.3.6.1.5.5.7.3.8"}var n="oids";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/oids",["require","module"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.asn1=e.asn1||{};t.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},t.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},t.create=function(t,r,n,i){if(e.util.isArray(i)){for(var a=[],s=0;s<i.length;++s)void 0!==i[s]&&a.push(i[s]);i=a}return{tagClass:t,type:r,constructed:n,composed:n||e.util.isArray(i),value:i}};var r=t.getBerValueLength=function(e){var t=e.getByte();if(128!==t){var r,n=128&t;return r=n?e.getInt((127&t)<<3):t}};t.fromDer=function(n,i){if(void 0===i&&(i=!0),"string"==typeof n&&(n=e.util.createBuffer(n)),n.length()<2){var a=new Error("Too few bytes to parse DER.");throw a.bytes=n.length(),a}var s=n.getByte(),o=192&s,u=31&s,c=r(n);if(n.length()<c){if(i){var a=new Error("Too few bytes to read ASN.1 value.");throw a.detail=n.length()+" < "+c,a}c=n.length()}var l,f=32===(32&s),p=f;if(!p&&o===t.Class.UNIVERSAL&&u===t.Type.BITSTRING&&c>1){var d=n.read,h=n.getByte();if(0===h){s=n.getByte();var y=192&s;if(y===t.Class.UNIVERSAL||y===t.Class.CONTEXT_SPECIFIC)try{var g=r(n);p=g===c-(n.read-d),p&&(++d,--c)}catch(m){}}n.read=d}if(p)if(l=[],void 0===c)for(;;){if(n.bytes(2)===String.fromCharCode(0,0)){n.getBytes(2);break}l.push(t.fromDer(n,i))}else for(var v=n.length();c>0;)l.push(t.fromDer(n,i)),c-=v-n.length(),v=n.length();else{if(void 0===c){if(i)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=n.length()}if(u===t.Type.BMPSTRING){l="";for(var C=0;c>C;C+=2)l+=String.fromCharCode(n.getInt16())}else l=n.getBytes(c)}return t.create(o,u,f,l)},t.toDer=function(r){var n=e.util.createBuffer(),i=r.tagClass|r.type,a=e.util.createBuffer();if(r.composed){r.constructed?i|=32:a.putByte(0);for(var s=0;s<r.value.length;++s)void 0!==r.value[s]&&a.putBuffer(t.toDer(r.value[s]))}else if(r.type===t.Type.BMPSTRING)for(var s=0;s<r.value.length;++s)a.putInt16(r.value.charCodeAt(s));else a.putBytes(r.value);if(n.putByte(i),a.length()<=127)n.putByte(127&a.length());else{var o=a.length(),u="";do u+=String.fromCharCode(255&o),o>>>=8;while(o>0);n.putByte(128|u.length);for(var s=u.length-1;s>=0;--s)n.putByte(u.charCodeAt(s))}return n.putBuffer(a),n},t.oidToDer=function(t){var r=t.split("."),n=e.util.createBuffer();n.putByte(40*parseInt(r[0],10)+parseInt(r[1],10));for(var i,a,s,o,u=2;u<r.length;++u){i=!0,a=[],s=parseInt(r[u],10);do o=127&s,s>>>=7,i||(o|=128),a.push(o),i=!1;while(s>0);for(var c=a.length-1;c>=0;--c)n.putByte(a[c])}return n},t.derToOid=function(t){var r;"string"==typeof t&&(t=e.util.createBuffer(t));var n=t.getByte();r=Math.floor(n/40)+"."+n%40;for(var i=0;t.length()>0;)n=t.getByte(),i<<=7,128&n?i+=127&n:(r+="."+(i+n),i=0);return r},t.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),a=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var u=e.charAt(10),c=10;"+"!==u&&"-"!==u&&(o=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(a,s,o,0),c&&(u=e.charAt(c),"+"===u||"-"===u)){var l=parseInt(e.substr(c+1,2),10),f=parseInt(e.substr(c+4,2),10),p=60*l+f;p*=6e4,"+"===u?t.setTime(+t-p):t.setTime(+t+p)}return t},t.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),u=0,c=0,l=!1;"Z"===e.charAt(e.length-1)&&(l=!0);var f=e.length-5,p=e.charAt(f);if("+"===p||"-"===p){var d=parseInt(e.substr(f+1,2),10),h=parseInt(e.substr(f+4,2),10);c=60*d+h,c*=6e4,"+"===p&&(c*=-1),l=!0}return"."===e.charAt(14)&&(u=1e3*parseFloat(e.substr(14),10)),l?(t.setUTCFullYear(r,n,i),t.setUTCHours(a,s,o,u),t.setTime(+t+c)):(t.setFullYear(r,n,i),t.setHours(a,s,o,u)),t},t.dateToUtcTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},t.dateToGeneralizedTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},t.integerToDer=function(t){var r=e.util.createBuffer();if(t>=-128&&128>t)return r.putSignedInt(t,8);if(t>=-32768&&32768>t)return r.putSignedInt(t,16);if(t>=-8388608&&8388608>t)return r.putSignedInt(t,24);if(t>=-2147483648&&2147483648>t)return r.putSignedInt(t,32);var n=new Error("Integer too large; max is 32-bits.");throw n.integer=t,n},t.derToInteger=function(t){"string"==typeof t&&(t=e.util.createBuffer(t));var r=8*t.length();if(r>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(r)},t.validate=function(r,n,i,a){var s=!1;if(r.tagClass!==n.tagClass&&"undefined"!=typeof n.tagClass||r.type!==n.type&&"undefined"!=typeof n.type)a&&(r.tagClass!==n.tagClass&&a.push("["+n.name+'] Expected tag class "'+n.tagClass+'", got "'+r.tagClass+'"'),r.type!==n.type&&a.push("["+n.name+'] Expected type "'+n.type+'", got "'+r.type+'"'));else if(r.constructed===n.constructed||"undefined"==typeof n.constructed){if(s=!0,n.value&&e.util.isArray(n.value))for(var o=0,u=0;s&&u<n.value.length;++u)s=n.value[u].optional||!1,r.value[o]&&(s=t.validate(r.value[o],n.value[u],i,a),s?++o:n.value[u].optional&&(s=!0)),!s&&a&&a.push("["+n.name+'] Tag class "'+n.tagClass+'", type "'+n.type+'" expected value length "'+n.value.length+'", got "'+r.value.length+'"');s&&i&&(n.capture&&(i[n.capture]=r.value),n.captureAsn1&&(i[n.captureAsn1]=r))}else a&&a.push("["+n.name+'] Expected constructed "'+n.constructed+'", got "'+r.constructed+'"');return s};var n=/[^\\u0000-\\u00ff]/;t.prettyPrint=function(r,i,a){var s="";i=i||0,a=a||2,i>0&&(s+="\n");for(var o="",u=0;i*a>u;++u)o+=" ";switch(s+=o+"Tag: ",r.tagClass){case t.Class.UNIVERSAL:s+="Universal:";break;case t.Class.APPLICATION:s+="Application:";break;case t.Class.CONTEXT_SPECIFIC:s+="Context-Specific:";break;case t.Class.PRIVATE:s+="Private:"}if(r.tagClass===t.Class.UNIVERSAL)switch(s+=r.type,r.type){case t.Type.NONE:s+=" (None)";break;case t.Type.BOOLEAN:s+=" (Boolean)";break;case t.Type.BITSTRING:s+=" (Bit string)";break;case t.Type.INTEGER:s+=" (Integer)";break;case t.Type.OCTETSTRING:s+=" (Octet string)";break;case t.Type.NULL:s+=" (Null)";break;case t.Type.OID:s+=" (Object Identifier)";break;case t.Type.ODESC:s+=" (Object Descriptor)";break;case t.Type.EXTERNAL:s+=" (External or Instance of)";break;case t.Type.REAL:s+=" (Real)";break;case t.Type.ENUMERATED:s+=" (Enumerated)";break;case t.Type.EMBEDDED:s+=" (Embedded PDV)";break;case t.Type.UTF8:s+=" (UTF8)";break;case t.Type.ROID:s+=" (Relative Object Identifier)";break;case t.Type.SEQUENCE:s+=" (Sequence)";break;case t.Type.SET:s+=" (Set)";break;case t.Type.PRINTABLESTRING:s+=" (Printable String)";break;case t.Type.IA5String:s+=" (IA5String (ASCII))";break;case t.Type.UTCTIME:s+=" (UTC time)";break;case t.Type.GENERALIZEDTIME:s+=" (Generalized time)";break;case t.Type.BMPSTRING:s+=" (BMP String)"}else s+=r.type;if(s+="\n",s+=o+"Constructed: "+r.constructed+"\n",r.composed){for(var c=0,l="",u=0;u<r.value.length;++u)void 0!==r.value[u]&&(c+=1,l+=t.prettyPrint(r.value[u],i+1,a),u+1<r.value.length&&(l+=","));s+=o+"Sub values: "+c+l}else{if(s+=o+"Value: ",r.type===t.Type.OID){var f=t.derToOid(r.value);s+=f,e.pki&&e.pki.oids&&f in e.pki.oids&&(s+=" ("+e.pki.oids[f]+") ")}if(r.type===t.Type.INTEGER)try{s+=t.derToInteger(r.value)}catch(p){s+="0x"+e.util.bytesToHex(r.value)}else r.type===t.Type.OCTETSTRING?(n.test(r.value)||(s+="("+r.value+") "),s+="0x"+e.util.bytesToHex(r.value)):s+=r.type===t.Type.UTF8?e.util.decodeUtf8(r.value):r.type===t.Type.PRINTABLESTRING||r.type===t.Type.IA5String?r.value:n.test(r.value)?"0x"+e.util.bytesToHex(r.value):0===r.value.length?"[null]":r.value}return s}}var n="asn1";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/asn1",["require","module","./util","./oids"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(){i=String.fromCharCode(128),i+=e.util.fillString(String.fromCharCode(0),64),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],s=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],o=new Array(64);for(var t=0;64>t;++t)o[t]=Math.floor(4294967296*Math.abs(Math.sin(t+1)));u=!0}function r(e,t,r){for(var n,i,u,c,l,f,p,d,h=r.length();h>=64;){for(i=e.h0,u=e.h1,c=e.h2,l=e.h3,d=0;16>d;++d)t[d]=r.getInt32Le(),f=l^u&(c^l),n=i+f+o[d]+t[d],p=s[d],i=l,l=c,c=u,u+=n<<p|n>>>32-p;for(;32>d;++d)f=c^l&(u^c),n=i+f+o[d]+t[a[d]],p=s[d],i=l,l=c,c=u,u+=n<<p|n>>>32-p;for(;48>d;++d)f=u^c^l,n=i+f+o[d]+t[a[d]],p=s[d],i=l,l=c,c=u,u+=n<<p|n>>>32-p;for(;64>d;++d)f=c^(u|~l),n=i+f+o[d]+t[a[d]],p=s[d],i=l,l=c,c=u,u+=n<<p|n>>>32-p;e.h0=e.h0+i|0,e.h1=e.h1+u|0,e.h2=e.h2+c|0,e.h3=e.h3+l|0,h-=64}}var n=e.md5=e.md5||{};e.md=e.md||{},e.md.algorithms=e.md.algorithms||{},e.md.md5=e.md.algorithms.md5=n,n.create=function(){u||t();var n=null,a=e.util.createBuffer(),s=new Array(16),o={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength64=[];for(var t=o.messageLengthSize/4,r=0;t>r;++r)o.fullMessageLength.push(0);return a=e.util.createBuffer(),n={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},o},o.start(),o.update=function(t,i){"utf8"===i&&(t=e.util.encodeUtf8(t));var u=t.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var c=o.fullMessageLength.length-1;c>=0;--c)o.fullMessageLength[c]+=u[1],u[1]=u[0]+(o.fullMessageLength[c]/4294967296>>>0),o.fullMessageLength[c]=o.fullMessageLength[c]>>>0,u[0]=u[1]/4294967296>>>0;return a.putBytes(t),r(n,s,a),(a.read>2048||0===a.length())&&a.compact(),o},o.digest=function(){var t=e.util.createBuffer();t.putBytes(a.bytes());var u=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,c=u&o.blockLength-1;t.putBytes(i.substr(0,o.blockLength-c));for(var l,f=0,p=o.fullMessageLength.length-1;p>=0;--p)l=8*o.fullMessageLength[p]+f,f=l/4294967296>>>0,t.putInt32Le(l>>>0);var d={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3};r(d,s,t);var h=e.util.createBuffer();return h.putInt32Le(d.h0),h.putInt32Le(d.h1),h.putInt32Le(d.h2),h.putInt32Le(d.h3),h},o};var i=null,a=null,s=null,o=null,u=!1}var n="md5";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/md5",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(){i=String.fromCharCode(128),i+=e.util.fillString(String.fromCharCode(0),64),a=!0}function r(e,t,r){for(var n,i,a,s,o,u,c,l,f=r.length();f>=64;){for(i=e.h0,a=e.h1,s=e.h2,o=e.h3,u=e.h4,l=0;16>l;++l)n=r.getInt32(),t[l]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+u+1518500249+n,u=o,o=s,s=a<<30|a>>>2,a=i,i=n;for(;20>l;++l)n=t[l-3]^t[l-8]^t[l-14]^t[l-16],n=n<<1|n>>>31,t[l]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+u+1518500249+n,u=o,o=s,s=a<<30|a>>>2,a=i,i=n;for(;32>l;++l)n=t[l-3]^t[l-8]^t[l-14]^t[l-16],n=n<<1|n>>>31,t[l]=n,c=a^s^o,n=(i<<5|i>>>27)+c+u+1859775393+n,u=o,o=s,s=a<<30|a>>>2,a=i,i=n;for(;40>l;++l)n=t[l-6]^t[l-16]^t[l-28]^t[l-32],n=n<<2|n>>>30,t[l]=n,c=a^s^o,n=(i<<5|i>>>27)+c+u+1859775393+n,u=o,o=s,s=a<<30|a>>>2,a=i,i=n;for(;60>l;++l)n=t[l-6]^t[l-16]^t[l-28]^t[l-32],n=n<<2|n>>>30,t[l]=n,c=a&s|o&(a^s),n=(i<<5|i>>>27)+c+u+2400959708+n,u=o,o=s,s=a<<30|a>>>2,a=i,i=n;for(;80>l;++l)n=t[l-6]^t[l-16]^t[l-28]^t[l-32],n=n<<2|n>>>30,t[l]=n,c=a^s^o,n=(i<<5|i>>>27)+c+u+3395469782+n,u=o,o=s,s=a<<30|a>>>2,a=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+a|0,e.h2=e.h2+s|0,e.h3=e.h3+o|0,e.h4=e.h4+u|0,f-=64}}var n=e.sha1=e.sha1||{};e.md=e.md||{},e.md.algorithms=e.md.algorithms||{},e.md.sha1=e.md.algorithms.sha1=n,n.create=function(){a||t();var n=null,s=e.util.createBuffer(),o=new Array(80),u={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return u.start=function(){u.messageLength=0,u.fullMessageLength=u.messageLength64=[];for(var t=u.messageLengthSize/4,r=0;t>r;++r)u.fullMessageLength.push(0);return s=e.util.createBuffer(),n={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},u},u.start(),u.update=function(t,i){"utf8"===i&&(t=e.util.encodeUtf8(t));var a=t.length;u.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=u.fullMessageLength.length-1;c>=0;--c)u.fullMessageLength[c]+=a[1],a[1]=a[0]+(u.fullMessageLength[c]/4294967296>>>0),u.fullMessageLength[c]=u.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return s.putBytes(t),r(n,o,s),(s.read>2048||0===s.length())&&s.compact(),u},u.digest=function(){var t=e.util.createBuffer();t.putBytes(s.bytes());var a=u.fullMessageLength[u.fullMessageLength.length-1]+u.messageLengthSize,c=a&u.blockLength-1;t.putBytes(i.substr(0,u.blockLength-c));for(var l,f,p=(e.util.createBuffer(),8*u.fullMessageLength[0]),d=0;d<u.fullMessageLength.length;++d)l=8*u.fullMessageLength[d+1],f=l/4294967296>>>0,p+=f,t.putInt32(p>>>0),p=l;var h={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4};r(h,o,t);var y=e.util.createBuffer();return y.putInt32(h.h0),y.putInt32(h.h1),y.putInt32(h.h2),y.putInt32(h.h3),y.putInt32(h.h4),y},u};var i=null,a=!1}var n="sha1";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},
r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha1",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(){i=String.fromCharCode(128),i+=e.util.fillString(String.fromCharCode(0),64),s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=!0}function r(e,t,r){for(var n,i,a,o,u,c,l,f,p,d,h,y,g,m,v,C=r.length();C>=64;){for(l=0;16>l;++l)t[l]=r.getInt32();for(;64>l;++l)n=t[l-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[l-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[l]=n+t[l-7]+i+t[l-16]|0;for(f=e.h0,p=e.h1,d=e.h2,h=e.h3,y=e.h4,g=e.h5,m=e.h6,v=e.h7,l=0;64>l;++l)o=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),u=m^y&(g^m),a=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),c=f&p|d&(f^p),n=v+o+u+s[l]+t[l],i=a+c,v=m,m=g,g=y,y=h+n|0,h=d,d=p,p=f,f=n+i|0;e.h0=e.h0+f|0,e.h1=e.h1+p|0,e.h2=e.h2+d|0,e.h3=e.h3+h|0,e.h4=e.h4+y|0,e.h5=e.h5+g|0,e.h6=e.h6+m|0,e.h7=e.h7+v|0,C-=64}}var n=e.sha256=e.sha256||{};e.md=e.md||{},e.md.algorithms=e.md.algorithms||{},e.md.sha256=e.md.algorithms.sha256=n,n.create=function(){a||t();var n=null,s=e.util.createBuffer(),o=new Array(64),u={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return u.start=function(){u.messageLength=0,u.fullMessageLength=u.messageLength64=[];for(var t=u.messageLengthSize/4,r=0;t>r;++r)u.fullMessageLength.push(0);return s=e.util.createBuffer(),n={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},u},u.start(),u.update=function(t,i){"utf8"===i&&(t=e.util.encodeUtf8(t));var a=t.length;u.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=u.fullMessageLength.length-1;c>=0;--c)u.fullMessageLength[c]+=a[1],a[1]=a[0]+(u.fullMessageLength[c]/4294967296>>>0),u.fullMessageLength[c]=u.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return s.putBytes(t),r(n,o,s),(s.read>2048||0===s.length())&&s.compact(),u},u.digest=function(){var t=e.util.createBuffer();t.putBytes(s.bytes());var a=u.fullMessageLength[u.fullMessageLength.length-1]+u.messageLengthSize,c=a&u.blockLength-1;t.putBytes(i.substr(0,u.blockLength-c));for(var l,f,p=(e.util.createBuffer(),8*u.fullMessageLength[0]),d=0;d<u.fullMessageLength.length;++d)l=8*u.fullMessageLength[d+1],f=l/4294967296>>>0,p+=f,t.putInt32(p>>>0),p=l;var h={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4,h5:n.h5,h6:n.h6,h7:n.h7};r(h,o,t);var y=e.util.createBuffer();return y.putInt32(h.h0),y.putInt32(h.h1),y.putInt32(h.h2),y.putInt32(h.h3),y.putInt32(h.h4),y.putInt32(h.h5),y.putInt32(h.h6),y.putInt32(h.h7),y},u};var i=null,a=!1,s=null}var n="sha256";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha256",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(){a=String.fromCharCode(128),a+=e.util.fillString(String.fromCharCode(0),128),o=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],u={},u["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],u["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],u["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],u["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],s=!0}function r(e,t,r){for(var n,i,a,s,u,c,l,f,p,d,h,y,g,m,v,C,E,S,T,A,b,I,B,N,k,w,R,L,_,D,U,P,x,O,V,K=r.length();K>=128;){for(_=0;16>_;++_)t[_][0]=r.getInt32()>>>0,t[_][1]=r.getInt32()>>>0;for(;80>_;++_)P=t[_-2],D=P[0],U=P[1],n=((D>>>19|U<<13)^(U>>>29|D<<3)^D>>>6)>>>0,i=((D<<13|U>>>19)^(U<<3|D>>>29)^(D<<26|U>>>6))>>>0,O=t[_-15],D=O[0],U=O[1],a=((D>>>1|U<<31)^(D>>>8|U<<24)^D>>>7)>>>0,s=((D<<31|U>>>1)^(D<<24|U>>>8)^(D<<25|U>>>7))>>>0,x=t[_-7],V=t[_-16],U=i+x[1]+s+V[1],t[_][0]=n+x[0]+a+V[0]+(U/4294967296>>>0)>>>0,t[_][1]=U>>>0;for(g=e[0][0],m=e[0][1],v=e[1][0],C=e[1][1],E=e[2][0],S=e[2][1],T=e[3][0],A=e[3][1],b=e[4][0],I=e[4][1],B=e[5][0],N=e[5][1],k=e[6][0],w=e[6][1],R=e[7][0],L=e[7][1],_=0;80>_;++_)l=((b>>>14|I<<18)^(b>>>18|I<<14)^(I>>>9|b<<23))>>>0,f=((b<<18|I>>>14)^(b<<14|I>>>18)^(I<<23|b>>>9))>>>0,p=(k^b&(B^k))>>>0,d=(w^I&(N^w))>>>0,u=((g>>>28|m<<4)^(m>>>2|g<<30)^(m>>>7|g<<25))>>>0,c=((g<<4|m>>>28)^(m<<30|g>>>2)^(m<<25|g>>>7))>>>0,h=(g&v|E&(g^v))>>>0,y=(m&C|S&(m^C))>>>0,U=L+f+d+o[_][1]+t[_][1],n=R+l+p+o[_][0]+t[_][0]+(U/4294967296>>>0)>>>0,i=U>>>0,U=c+y,a=u+h+(U/4294967296>>>0)>>>0,s=U>>>0,R=k,L=w,k=B,w=N,B=b,N=I,U=A+i,b=T+n+(U/4294967296>>>0)>>>0,I=U>>>0,T=E,A=S,E=v,S=C,v=g,C=m,U=i+s,g=n+a+(U/4294967296>>>0)>>>0,m=U>>>0;U=e[0][1]+m,e[0][0]=e[0][0]+g+(U/4294967296>>>0)>>>0,e[0][1]=U>>>0,U=e[1][1]+C,e[1][0]=e[1][0]+v+(U/4294967296>>>0)>>>0,e[1][1]=U>>>0,U=e[2][1]+S,e[2][0]=e[2][0]+E+(U/4294967296>>>0)>>>0,e[2][1]=U>>>0,U=e[3][1]+A,e[3][0]=e[3][0]+T+(U/4294967296>>>0)>>>0,e[3][1]=U>>>0,U=e[4][1]+I,e[4][0]=e[4][0]+b+(U/4294967296>>>0)>>>0,e[4][1]=U>>>0,U=e[5][1]+N,e[5][0]=e[5][0]+B+(U/4294967296>>>0)>>>0,e[5][1]=U>>>0,U=e[6][1]+w,e[6][0]=e[6][0]+k+(U/4294967296>>>0)>>>0,e[6][1]=U>>>0,U=e[7][1]+L,e[7][0]=e[7][0]+R+(U/4294967296>>>0)>>>0,e[7][1]=U>>>0,K-=128}}var n=e.sha512=e.sha512||{};e.md=e.md||{},e.md.algorithms=e.md.algorithms||{},e.md.sha512=e.md.algorithms.sha512=n;var i=e.sha384=e.sha512.sha384=e.sha512.sha384||{};i.create=function(){return n.create("SHA-384")},e.md.sha384=e.md.algorithms.sha384=i,e.sha512.sha256=e.sha512.sha256||{create:function(){return n.create("SHA-512/256")}},e.md["sha512/256"]=e.md.algorithms["sha512/256"]=e.sha512.sha256,e.sha512.sha224=e.sha512.sha224||{create:function(){return n.create("SHA-512/224")}},e.md["sha512/224"]=e.md.algorithms["sha512/224"]=e.sha512.sha224,n.create=function(n){if(s||t(),"undefined"==typeof n&&(n="SHA-512"),!(n in u))throw new Error("Invalid SHA-512 algorithm: "+n);for(var i=u[n],o=null,c=e.util.createBuffer(),l=new Array(80),f=0;80>f;++f)l[f]=new Array(2);var p={algorithm:n.replace("-","").toLowerCase(),blockLength:128,digestLength:64,messageLength:0,fullMessageLength:null,messageLengthSize:16};return p.start=function(){p.messageLength=0,p.fullMessageLength=p.messageLength128=[];for(var t=p.messageLengthSize/4,r=0;t>r;++r)p.fullMessageLength.push(0);c=e.util.createBuffer(),o=new Array(i.length);for(var r=0;r<i.length;++r)o[r]=i[r].slice(0);return p},p.start(),p.update=function(t,n){"utf8"===n&&(t=e.util.encodeUtf8(t));var i=t.length;p.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var a=p.fullMessageLength.length-1;a>=0;--a)p.fullMessageLength[a]+=i[1],i[1]=i[0]+(p.fullMessageLength[a]/4294967296>>>0),p.fullMessageLength[a]=p.fullMessageLength[a]>>>0,i[0]=i[1]/4294967296>>>0;return c.putBytes(t),r(o,l,c),(c.read>2048||0===c.length())&&c.compact(),p},p.digest=function(){var t=e.util.createBuffer();t.putBytes(c.bytes());var i=p.fullMessageLength[p.fullMessageLength.length-1]+p.messageLengthSize,s=i&p.blockLength-1;t.putBytes(a.substr(0,p.blockLength-s));for(var u,f,d=(e.util.createBuffer(),8*p.fullMessageLength[0]),h=0;h<p.fullMessageLength.length;++h)u=8*p.fullMessageLength[h+1],f=u/4294967296>>>0,d+=f,t.putInt32(d>>>0),d=u;for(var y=new Array(o.length),h=0;h<o.length;++h)y[h]=o[h].slice(0);r(y,l,t);var g,m=e.util.createBuffer();g="SHA-512"===n?y.length:"SHA-384"===n?y.length-2:y.length-4;for(var h=0;g>h;++h)m.putInt32(y[h][0]),(h!==g-1||"SHA-512/224"!==n)&&m.putInt32(y[h][1]);return m},p};var a=null,s=!1,o=null,u=null}var n="sha512";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha512",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.md=e.md||{},e.md.algorithms={md5:e.md5,sha1:e.sha1,sha256:e.sha256},e.md.md5=e.md5,e.md.sha1=e.sha1,e.md.sha256=e.sha256}var n="md";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/md",["require","module","./md5","./sha1","./sha256","./sha512"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.hmac=e.hmac||{};t.create=function(){var t=null,r=null,n=null,i=null,a={};return a.start=function(a,s){if(null!==a)if("string"==typeof a){if(a=a.toLowerCase(),!(a in e.md.algorithms))throw new Error('Unknown hash algorithm "'+a+'"');r=e.md.algorithms[a].create()}else r=a;if(null===s)s=t;else{if("string"==typeof s)s=e.util.createBuffer(s);else if(e.util.isArray(s)){var o=s;s=e.util.createBuffer();for(var u=0;u<o.length;++u)s.putByte(o[u])}var c=s.length();c>r.blockLength&&(r.start(),r.update(s.bytes()),s=r.digest()),n=e.util.createBuffer(),i=e.util.createBuffer(),c=s.length();for(var u=0;c>u;++u){var o=s.at(u);n.putByte(54^o),i.putByte(92^o)}if(c<r.blockLength)for(var o=r.blockLength-c,u=0;o>u;++u)n.putByte(54),i.putByte(92);t=s,n=n.bytes(),i=i.bytes()}r.start(),r.update(n)},a.update=function(e){r.update(e)},a.getMac=function(){var e=r.digest().bytes();return r.start(),r.update(i),r.update(e),r.digest()},a.digest=a.getMac,a}}var n="hmac";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/hmac",["require","module","./md","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e){for(var t=e.name+": ",r=[],n=function(e,t){return" "+t},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+"\r\n";for(var a=0,s=-1,i=0;i<t.length;++i,++a)if(a>65&&-1!==s){var o=t[s];","===o?(++s,t=t.substr(0,s)+"\r\n "+t.substr(s)):t=t.substr(0,s)+"\r\n"+o+t.substr(s+1),a=i-s-1,s=-1,++i}else(" "===t[i]||"	"===t[i]||","===t[i])&&(s=i);return t}function r(e){return e.replace(/^\s+/,"")}var n=e.pem=e.pem||{};n.encode=function(r,n){n=n||{};var i,a="-----BEGIN "+r.type+"-----\r\n";if(r.procType&&(i={name:"Proc-Type",values:[String(r.procType.version),r.procType.type]},a+=t(i)),r.contentDomain&&(i={name:"Content-Domain",values:[r.contentDomain]},a+=t(i)),r.dekInfo&&(i={name:"DEK-Info",values:[r.dekInfo.algorithm]},r.dekInfo.parameters&&i.values.push(r.dekInfo.parameters),a+=t(i)),r.headers)for(var s=0;s<r.headers.length;++s)a+=t(r.headers[s]);return r.procType&&(a+="\r\n"),a+=e.util.encode64(r.body,n.maxline||64)+"\r\n",a+="-----END "+r.type+"-----\r\n"},n.decode=function(t){for(var n,i=[],a=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,s=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/;;){if(n=a.exec(t),!n)break;var u={type:n[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:e.util.decode64(n[3])};if(i.push(u),n[2]){for(var c=n[2].split(o),l=0;n&&l<c.length;){for(var f=c[l].replace(/\s+$/,""),p=l+1;p<c.length;++p){var d=c[p];if(!/\s/.test(d[0]))break;f+=d,l=p}if(n=f.match(s)){for(var h={name:n[1],values:[]},y=n[2].split(","),g=0;g<y.length;++g)h.values.push(r(y[g]));if(u.procType)if(u.contentDomain||"Content-Domain"!==h.name)if(u.dekInfo||"DEK-Info"!==h.name)u.headers.push(h);else{if(0===h.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');u.dekInfo={algorithm:y[0],parameters:y[1]||null}}else u.contentDomain=y[0]||"";else{if("Proc-Type"!==h.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==h.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');u.procType={version:y[0],type:y[1]}}}++l}if("ENCRYPTED"===u.procType&&!u.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===i.length)throw new Error("Invalid PEM formatted message.");return i}}var n="pem";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pem",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,r){var n=function(){return new e.des.Algorithm(t,r)};e.cipher.registerAlgorithm(t,n)}function r(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],a=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],u=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],p=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],h=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],y=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,m=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],C=0,E=0;g>E;E++){var S=e.getInt32(),T=e.getInt32();t=252645135&(S>>>4^T),T^=t,S^=t<<4,t=65535&(T>>>-16^S),S^=t,T^=t<<-16,t=858993459&(S>>>2^T),T^=t,S^=t<<2,t=65535&(T>>>-16^S),S^=t,T^=t<<-16,t=1431655765&(S>>>1^T),T^=t,S^=t<<1,t=16711935&(T>>>8^S),S^=t,T^=t<<8,t=1431655765&(S>>>1^T),T^=t,S^=t<<1,t=S<<8|T>>>20&240,S=T<<24|T<<8&16711680|T>>>8&65280|T>>>24&240,T=t;for(var A=0;A<v.length;++A){v[A]?(S=S<<2|S>>>26,T=T<<2|T>>>26):(S=S<<1|S>>>27,T=T<<1|T>>>27),S&=-15,T&=-15;var b=r[S>>>28]|n[S>>>24&15]|i[S>>>20&15]|a[S>>>16&15]|s[S>>>12&15]|o[S>>>8&15]|u[S>>>4&15],I=c[T>>>28]|l[T>>>24&15]|f[T>>>20&15]|p[T>>>16&15]|d[T>>>12&15]|h[T>>>8&15]|y[T>>>4&15];t=65535&(I>>>16^b),m[C++]=b^t,m[C++]=I^t<<16}}return m}function n(e,t,r,n){var i,d=32===e.length?3:9;i=3===d?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var h,y=t[0],g=t[1];h=252645135&(y>>>4^g),g^=h,y^=h<<4,h=65535&(y>>>16^g),g^=h,y^=h<<16,h=858993459&(g>>>2^y),y^=h,g^=h<<2,h=16711935&(g>>>8^y),y^=h,g^=h<<8,h=1431655765&(y>>>1^g),g^=h,y^=h<<1,y=y<<1|y>>>31,g=g<<1|g>>>31;for(var m=0;d>m;m+=3){for(var v=i[m+1],C=i[m+2],E=i[m];E!=v;E+=C){var S=g^e[E],T=(g>>>4|g<<28)^e[E+1];h=y,y=g,g=h^(s[S>>>24&63]|u[S>>>16&63]|l[S>>>8&63]|p[63&S]|a[T>>>24&63]|o[T>>>16&63]|c[T>>>8&63]|f[63&T])}h=y,y=g,g=h}y=y>>>1|y<<31,g=g>>>1|g<<31,h=1431655765&(y>>>1^g),g^=h,y^=h<<1,h=16711935&(g>>>8^y),y^=h,g^=h<<8,h=858993459&(g>>>2^y),y^=h,g^=h<<2,h=65535&(y>>>16^g),g^=h,y^=h<<16,h=252645135&(y>>>4^g),g^=h,y^=h<<4,r[0]=y,r[1]=g}function i(t){t=t||{};var r,n=(t.mode||"CBC").toUpperCase(),i="DES-"+n;r=t.decrypt?e.cipher.createDecipher(i,t.key):e.cipher.createCipher(i,t.key);var a=r.start;return r.start=function(t,n){var i=null;n instanceof e.util.ByteBuffer&&(i=n,n={}),n=n||{},n.output=i,n.iv=t,a.call(r,n)},r}e.des=e.des||{},e.des.startEncrypting=function(e,t,r,n){var a=i({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return a.start(t),a},e.des.createEncryptionCipher=function(e,t){return i({key:e,output:null,decrypt:!1,mode:t})},e.des.startDecrypting=function(e,t,r,n){var a=i({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return a.start(t),a},e.des.createDecryptionCipher=function(e,t){return i({key:e,output:null,decrypt:!0,mode:t})},e.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return n(r._keys,e,t,!1)},decrypt:function(e,t){return n(r._keys,e,t,!0)}}}),r._init=!1},e.des.Algorithm.prototype.initialize=function(t){if(!this._init){var n=e.util.createBuffer(t.key);if(0===this.name.indexOf("3DES")&&24!==n.length())throw new Error("Invalid Triple-DES key size: "+8*n.length());this._keys=r(n),this._init=!0}},t("DES-ECB",e.cipher.modes.ecb),t("DES-CBC",e.cipher.modes.cbc),t("DES-CFB",e.cipher.modes.cfb),t("DES-OFB",e.cipher.modes.ofb),t("DES-CTR",e.cipher.modes.ctr),t("3DES-ECB",e.cipher.modes.ecb),t("3DES-CBC",e.cipher.modes.cbc),t("3DES-CFB",e.cipher.modes.cfb),t("3DES-OFB",e.cipher.modes.ofb),t("3DES-CTR",e.cipher.modes.ctr);var a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],o=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],u=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],c=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],f=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],p=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696]}var n="des";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/des",["require","module","./cipher","./cipherModes","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var r,n=e.pkcs5=e.pkcs5||{},i="undefined"!=typeof process&&process.versions&&process.versions.node;i&&!e.disableNativeCode&&(r=t("crypto")),e.pbkdf2=n.pbkdf2=function(t,n,a,s,o,u){function c(){return E>d?u(null,C):(y.start(null,null),y.update(n),y.update(e.util.int32ToBytes(E)),g=v=y.digest().getBytes(),S=2,void l())}function l(){return a>=S?(y.start(null,null),y.update(v),m=y.digest().getBytes(),g=e.util.xorBytes(g,m,f),v=m,++S,e.util.setImmediate(l)):(C+=d>E?g:g.substr(0,h),++E,void c())}if("function"==typeof o&&(u=o,o=null),i&&!e.disableNativeCode&&r.pbkdf2&&(null===o||"object"!=typeof o)&&(r.pbkdf2Sync.length>4||!o||"sha1"===o))return"string"!=typeof o&&(o="sha1"),n=new Buffer(n,"binary"),u?4===r.pbkdf2Sync.length?r.pbkdf2(t,n,a,s,function(e,t){return e?u(e):void u(null,t.toString("binary"))}):r.pbkdf2(t,n,a,s,o,function(e,t){return e?u(e):void u(null,t.toString("binary"))}):4===r.pbkdf2Sync.length?r.pbkdf2Sync(t,n,a,s).toString("binary"):r.pbkdf2Sync(t,n,a,s,o).toString("binary");if(("undefined"==typeof o||null===o)&&(o=e.md.sha1.create()),"string"==typeof o){if(!(o in e.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=e.md[o].create()}var f=o.digestLength;if(s>4294967295*f){var p=new Error("Derived key is too long.");if(u)return u(p);throw p}var d=Math.ceil(s/f),h=s-(d-1)*f,y=e.hmac.create();y.start(o,t);var g,m,v,C="";if(!u){for(var E=1;d>=E;++E){y.start(null,null),y.update(n),y.update(e.util.int32ToBytes(E)),g=v=y.digest().getBytes();for(var S=2;a>=S;++S)y.start(null,null),y.update(v),m=y.digest().getBytes(),g=e.util.xorBytes(g,m,f),v=m;C+=d>E?g:g.substr(0,h)}return C}var S,E=1;c()}}var n="pbkdf2";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pbkdf2",["require","module","./hmac","./md","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var r="undefined"!=typeof process&&process.versions&&process.versions.node,n=null;e.disableNativeCode||!r||process.versions["node-webkit"]||(n=t("crypto"));var i=e.prng=e.prng||{};i.create=function(t){function r(e){if(o.pools[0].messageLength>=32)return a(),e();var t=32-o.pools[0].messageLength<<5;o.seedFile(t,function(t,r){return t?e(t):(o.collect(r),a(),void e())})}function i(){if(o.pools[0].messageLength>=32)return a();var e=32-o.pools[0].messageLength<<5;o.collect(o.seedFileSync(e)),a()}function a(){var e=o.plugin.md.create();e.update(o.pools[0].digest().getBytes()),o.pools[0].start();for(var t=1,r=1;32>r;++r)t=31===t?2147483648:t<<2,t%o.reseeds===0&&(e.update(o.pools[r].digest().getBytes()),o.pools[r].start());var n=e.digest().getBytes();e.start(),e.update(n);var i=e.digest().getBytes();o.key=o.plugin.formatKey(n),o.seed=o.plugin.formatSeed(i),o.reseeds=4294967295===o.reseeds?0:o.reseeds+1,o.generated=0}function s(t){var r=null;if("undefined"!=typeof window){var n=window.crypto||window.msCrypto;n&&n.getRandomValues&&(r=function(e){return n.getRandomValues(e)})}var i=e.util.createBuffer();if(r)for(;i.length()<t;){var a=Math.max(1,Math.min(t-i.length(),65536)/4),s=new Uint32Array(Math.floor(a));try{r(s);for(var o=0;o<s.length;++o)i.putInt32(s[o])}catch(u){if(!("undefined"!=typeof QuotaExceededError&&u instanceof QuotaExceededError))throw u}}if(i.length()<t)for(var c,l,f,p=Math.floor(65536*Math.random());i.length()<t;){l=16807*(65535&p),c=16807*(p>>16),l+=(32767&c)<<16,l+=c>>15,l=(2147483647&l)+(l>>31),p=4294967295&l;for(var o=0;3>o;++o)f=p>>>(o<<3),f^=Math.floor(256*Math.random()),i.putByte(String.fromCharCode(255&f))}return i.getBytes(t)}for(var o={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0},u=t.md,c=new Array(32),l=0;32>l;++l)c[l]=u.create();return o.pools=c,o.pool=0,o.generate=function(t,n){function i(f){if(f)return n(f);if(l.length()>=t)return n(null,l.getBytes(t));if(o.generated>1048575&&(o.key=null),null===o.key)return e.util.nextTick(function(){r(i)});var p=a(o.key,o.seed);o.generated+=p.length,l.putBytes(p),o.key=u(a(o.key,s(o.seed))),o.seed=c(a(o.key,o.seed)),e.util.setImmediate(i)}if(!n)return o.generateSync(t);var a=o.plugin.cipher,s=o.plugin.increment,u=o.plugin.formatKey,c=o.plugin.formatSeed,l=e.util.createBuffer();o.key=null,i()},o.generateSync=function(t){var r=o.plugin.cipher,n=o.plugin.increment,a=o.plugin.formatKey,s=o.plugin.formatSeed;o.key=null;for(var u=e.util.createBuffer();u.length()<t;){o.generated>1048575&&(o.key=null),null===o.key&&i();var c=r(o.key,o.seed);o.generated+=c.length,u.putBytes(c),o.key=a(r(o.key,n(o.seed))),
o.seed=s(r(o.key,o.seed))}return u.getBytes(t)},n?(o.seedFile=function(e,t){n.randomBytes(e,function(e,r){return e?t(e):void t(null,r.toString())})},o.seedFileSync=function(e){return n.randomBytes(e).toString()}):(o.seedFile=function(e,t){try{t(null,s(e))}catch(r){t(r)}},o.seedFileSync=s),o.collect=function(e){for(var t=e.length,r=0;t>r;++r)o.pools[o.pool].update(e.substr(r,1)),o.pool=31===o.pool?0:o.pool+1},o.collectInt=function(e,t){for(var r="",n=0;t>n;n+=8)r+=String.fromCharCode(e>>n&255);o.collect(r)},o.registerWorker=function(e){if(e===self)o.seedFile=function(e,t){function r(e){var n=e.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",r),t(n.forge.prng.err,n.forge.prng.bytes))}self.addEventListener("message",r),self.postMessage({forge:{prng:{needed:e}}})};else{var t=function(t){var r=t.data;r.forge&&r.forge.prng&&o.seedFile(r.forge.prng.needed,function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})})};e.addEventListener("message",t)}},o}}var n="prng";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/prng",["require","module","./md","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.random&&e.random.getBytes||!function(t){function r(){var t=e.prng.create(n);return t.getBytes=function(e,r){return t.generate(e,r)},t.getBytesSync=function(e){return t.generate(e)},t}var n={},i=new Array(4),a=e.util.createBuffer();n.formatKey=function(t){var r=e.util.createBuffer(t);return t=new Array(4),t[0]=r.getInt32(),t[1]=r.getInt32(),t[2]=r.getInt32(),t[3]=r.getInt32(),e.aes._expandKey(t,!1)},n.formatSeed=function(t){var r=e.util.createBuffer(t);return t=new Array(4),t[0]=r.getInt32(),t[1]=r.getInt32(),t[2]=r.getInt32(),t[3]=r.getInt32(),t},n.cipher=function(t,r){return e.aes._updateBlock(t,r,i,!1),a.putInt32(i[0]),a.putInt32(i[1]),a.putInt32(i[2]),a.putInt32(i[3]),a.getBytes()},n.increment=function(e){return++e[3],e},n.md=e.md.sha256;var s=r(),o="undefined"!=typeof process&&process.versions&&process.versions.node,u=null;if("undefined"!=typeof window){var c=window.crypto||window.msCrypto;c&&c.getRandomValues&&(u=function(e){return c.getRandomValues(e)})}if(e.disableNativeCode||!o&&!u){if("undefined"==typeof window||void 0===window.document,s.collectInt(+new Date,32),"undefined"!=typeof navigator){var l="";for(var f in navigator)try{"string"==typeof navigator[f]&&(l+=navigator[f])}catch(p){}s.collect(l),l=null}t&&(t().mousemove(function(e){s.collectInt(e.clientX,16),s.collectInt(e.clientY,16)}),t().keypress(function(e){s.collectInt(e.charCode,8)}))}if(e.random)for(var f in s)e.random[f]=s[f];else e.random=s;e.random.createInstance=r}("undefined"!=typeof jQuery?jQuery:null)}var n="random";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/random",["require","module","./aes","./md","./prng","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],r=[1,2,3,5],n=function(e,t){return e<<t&65535|(65535&e)>>16-t},i=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.rc2=e.rc2||{},e.rc2.expandKey=function(r,n){"string"==typeof r&&(r=e.util.createBuffer(r)),n=n||128;var i,a=r,s=r.length(),o=n,u=Math.ceil(o/8),c=255>>(7&o);for(i=s;128>i;i++)a.putByte(t[a.at(i-1)+a.at(i-s)&255]);for(a.setAt(128-u,t[a.at(128-u)&c]),i=127-u;i>=0;i--)a.setAt(i,t[a.at(i+1)^a.at(i+u)]);return a};var a=function(t,a,s){var o,u,c,l,f=!1,p=null,d=null,h=null,y=[];for(t=e.rc2.expandKey(t,a),c=0;64>c;c++)y.push(t.getInt16Le());s?(o=function(e){for(c=0;4>c;c++)e[c]+=y[l]+(e[(c+3)%4]&e[(c+2)%4])+(~e[(c+3)%4]&e[(c+1)%4]),e[c]=n(e[c],r[c]),l++},u=function(e){for(c=0;4>c;c++)e[c]+=y[63&e[(c+3)%4]]}):(o=function(e){for(c=3;c>=0;c--)e[c]=i(e[c],r[c]),e[c]-=y[l]+(e[(c+3)%4]&e[(c+2)%4])+(~e[(c+3)%4]&e[(c+1)%4]),l--},u=function(e){for(c=3;c>=0;c--)e[c]-=y[63&e[(c+3)%4]]});var g=function(e){var t=[];for(c=0;4>c;c++){var r=p.getInt16Le();null!==h&&(s?r^=h.getInt16Le():h.putInt16Le(r)),t.push(65535&r)}l=s?0:63;for(var n=0;n<e.length;n++)for(var i=0;i<e[n][0];i++)e[n][1](t);for(c=0;4>c;c++)null!==h&&(s?h.putInt16Le(t[c]):t[c]^=h.getInt16Le()),d.putInt16Le(t[c])},m=null;return m={start:function(t,r){t&&"string"==typeof t&&(t=e.util.createBuffer(t)),f=!1,p=e.util.createBuffer(),d=r||new e.util.createBuffer,h=t,m.output=d},update:function(e){for(f||p.putBuffer(e);p.length()>=8;)g([[5,o],[1,u],[6,o],[1,u],[5,o]])},finish:function(e){var t=!0;if(s)if(e)t=e(8,p,!s);else{var r=8===p.length()?8:8-p.length();p.fillWithByte(r,r)}if(t&&(f=!0,m.update()),!s&&(t=0===p.length()))if(e)t=e(8,d,!s);else{var n=d.length(),i=d.at(n-1);i>n?t=!1:d.truncate(i)}return t}}};e.rc2.startEncrypting=function(t,r,n){var i=e.rc2.createEncryptionCipher(t,128);return i.start(r,n),i},e.rc2.createEncryptionCipher=function(e,t){return a(e,t,!0)},e.rc2.startDecrypting=function(t,r,n){var i=e.rc2.createDecryptionCipher(t,128);return i.start(r,n),i},e.rc2.createDecryptionCipher=function(e,t){return a(e,t,!1)}}var n="rc2";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/rc2",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function r(){return new t(null)}function n(e,t,r,n,i,a){for(;--a>=0;){var s=t*this.data[e++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=67108863&s}return i}function i(e,t,r,n,i,a){for(var s=32767&t,o=t>>15;--a>=0;){var u=32767&this.data[e],c=this.data[e++]>>15,l=o*u+c*s;u=s*u+((32767&l)<<15)+r.data[n]+(1073741823&i),i=(u>>>30)+(l>>>15)+o*c+(i>>>30),r.data[n++]=1073741823&u}return i}function a(e,t,r,n,i,a){for(var s=16383&t,o=t>>14;--a>=0;){var u=16383&this.data[e],c=this.data[e++]>>14,l=o*u+c*s;u=s*u+((16383&l)<<14)+r.data[n]+i,i=(u>>28)+(l>>14)+o*c,r.data[n++]=268435455&u}return i}function s(e){return at.charAt(e)}function o(e,t){var r=st[e.charCodeAt(t)];return null==r?-1:r}function u(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function c(e){this.t=1,this.s=0>e?-1:0,e>0?this.data[0]=e:-1>e?this.data[0]=e+this.DV:this.t=0}function l(e){var t=r();return t.fromInt(e),t}function f(e,r){var n;if(16==r)n=4;else if(8==r)n=3;else if(256==r)n=8;else if(2==r)n=1;else if(32==r)n=5;else{if(4!=r)return void this.fromRadix(e,r);n=2}this.t=0,this.s=0;for(var i=e.length,a=!1,s=0;--i>=0;){var u=8==n?255&e[i]:o(e,i);0>u?"-"==e.charAt(i)&&(a=!0):(a=!1,0==s?this.data[this.t++]=u:s+n>this.DB?(this.data[this.t-1]|=(u&(1<<this.DB-s)-1)<<s,this.data[this.t++]=u>>this.DB-s):this.data[this.t-1]|=u<<s,s+=n,s>=this.DB&&(s-=this.DB))}8==n&&0!=(128&e[0])&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),a&&t.ZERO.subTo(this,this)}function p(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function d(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,a="",o=this.t,u=this.DB-o*this.DB%t;if(o-- >0)for(u<this.DB&&(r=this.data[o]>>u)>0&&(i=!0,a=s(r));o>=0;)t>u?(r=(this.data[o]&(1<<u)-1)<<t-u,r|=this.data[--o]>>(u+=this.DB-t)):(r=this.data[o]>>(u-=t)&n,0>=u&&(u+=this.DB,--o)),r>0&&(i=!0),i&&(a+=s(r));return i?a:"0"}function h(){var e=r();return t.ZERO.subTo(this,e),e}function y(){return this.s<0?this.negate():this}function g(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(t=r-e.t,0!=t)return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0}function m(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function v(){return this.t<=0?0:this.DB*(this.t-1)+m(this.data[this.t-1]^this.s&this.DM)}function C(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function E(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function S(e,t){var r,n=e%this.DB,i=this.DB-n,a=(1<<i)-1,s=Math.floor(e/this.DB),o=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+s+1]=this.data[r]>>i|o,o=(this.data[r]&a)<<n;for(r=s-1;r>=0;--r)t.data[r]=0;t.data[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function T(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)return void(t.t=0);var n=e%this.DB,i=this.DB-n,a=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)t.data[s-r-1]|=(this.data[s]&a)<<i,t.data[s-r]=this.data[s]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&a)<<i),t.t=this.t-r,t.clamp()}function A(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);i>r;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=0>n?-1:0,-1>n?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function b(e,r){var n=this.abs(),i=e.abs(),a=n.t;for(r.t=a+i.t;--a>=0;)r.data[a]=0;for(a=0;a<i.t;++a)r.data[a+n.t]=n.am(0,i.data[a],r,a,0,n.t);r.s=0,r.clamp(),this.s!=e.s&&t.ZERO.subTo(r,r)}function I(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function B(e,n,i){var a=e.abs();if(!(a.t<=0)){var s=this.abs();if(s.t<a.t)return null!=n&&n.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=r());var o=r(),u=this.s,c=e.s,l=this.DB-m(a.data[a.t-1]);l>0?(a.lShiftTo(l,o),s.lShiftTo(l,i)):(a.copyTo(o),s.copyTo(i));var f=o.t,p=o.data[f-1];if(0!=p){var d=p*(1<<this.F1)+(f>1?o.data[f-2]>>this.F2:0),h=this.FV/d,y=(1<<this.F1)/d,g=1<<this.F2,v=i.t,C=v-f,E=null==n?r():n;for(o.dlShiftTo(C,E),i.compareTo(E)>=0&&(i.data[i.t++]=1,i.subTo(E,i)),t.ONE.dlShiftTo(f,E),E.subTo(o,o);o.t<f;)o.data[o.t++]=0;for(;--C>=0;){var S=i.data[--v]==p?this.DM:Math.floor(i.data[v]*h+(i.data[v-1]+g)*y);if((i.data[v]+=o.am(0,S,i,C,0,f))<S)for(o.dlShiftTo(C,E),i.subTo(E,i);i.data[v]<--S;)i.subTo(E,i)}null!=n&&(i.drShiftTo(f,n),u!=c&&t.ZERO.subTo(n,n)),i.t=f,i.clamp(),l>0&&i.rShiftTo(l,i),0>u&&t.ZERO.subTo(i,i)}}}function N(e){var n=r();return this.abs().divRemTo(e,null,n),this.s<0&&n.compareTo(t.ZERO)>0&&e.subTo(n,n),n}function k(e){this.m=e}function w(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function R(e){return e}function L(e){e.divRemTo(this.m,null,e)}function _(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function D(e,t){e.squareTo(t),this.reduce(t)}function U(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return t=t*(2-(15&e)*t)&15,t=t*(2-(255&e)*t)&255,t=t*(2-((65535&e)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function P(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function x(e){var n=r();return e.abs().dlShiftTo(this.m.t,n),n.divRemTo(this.m,null,n),e.s<0&&n.compareTo(t.ZERO)>0&&this.m.subTo(n,n),n}function O(e){var t=r();return e.copyTo(t),this.reduce(t),t}function V(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function K(e,t){e.squareTo(t),this.reduce(t)}function j(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function M(){return 0==(this.t>0?1&this.data[0]:this.s)}function q(e,n){if(e>4294967295||1>e)return t.ONE;var i=r(),a=r(),s=n.convert(this),o=m(e)-1;for(s.copyTo(i);--o>=0;)if(n.sqrTo(i,a),(e&1<<o)>0)n.mulTo(a,s,i);else{var u=i;i=a,a=u}return n.revert(i)}function F(e,t){var r;return r=256>e||t.isEven()?new k(t):new P(t),this.exp(e,r)}function H(){var e=r();return this.copyTo(e),e}function G(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function z(){return 0==this.t?this.s:this.data[0]<<24>>24}function Q(){return 0==this.t?this.s:this.data[0]<<16>>16}function X(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function W(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function Y(e){if(null==e&&(e=10),0==this.signum()||2>e||e>36)return"0";var t=this.chunkSize(e),n=Math.pow(e,t),i=l(n),a=r(),s=r(),o="";for(this.divRemTo(i,a,s);a.signum()>0;)o=(n+s.intValue()).toString(e).substr(1)+o,a.divRemTo(i,a,s);return s.intValue().toString(e)+o}function Z(e,r){this.fromInt(0),null==r&&(r=10);for(var n=this.chunkSize(r),i=Math.pow(r,n),a=!1,s=0,u=0,c=0;c<e.length;++c){var l=o(e,c);0>l?"-"==e.charAt(c)&&0==this.signum()&&(a=!0):(u=r*u+l,++s>=n&&(this.dMultiply(i),this.dAddOffset(u,0),s=0,u=0))}s>0&&(this.dMultiply(Math.pow(r,s)),this.dAddOffset(u,0)),a&&t.ZERO.subTo(this,this)}function $(e,r,n){if("number"==typeof r)if(2>e)this.fromInt(1);else for(this.fromNumber(e,n),this.testBit(e-1)||this.bitwiseTo(t.ONE.shiftLeft(e-1),se,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(r);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(t.ONE.shiftLeft(e-1),this);else{var i=new Array,a=7&e;i.length=(e>>3)+1,r.nextBytes(i),a>0?i[0]&=(1<<a)-1:i[0]=0,this.fromString(i,256)}}function J(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)8>n?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,0>=n&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t}function ee(e){return 0==this.compareTo(e)}function te(e){return this.compareTo(e)<0?this:e}function re(e){return this.compareTo(e)>0?this:e}function ne(e,t,r){var n,i,a=Math.min(e.t,this.t);for(n=0;a>n;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=a;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function ie(e,t){return e&t}function ae(e){var t=r();return this.bitwiseTo(e,ie,t),t}function se(e,t){return e|t}function oe(e){var t=r();return this.bitwiseTo(e,se,t),t}function ue(e,t){return e^t}function ce(e){var t=r();return this.bitwiseTo(e,ue,t),t}function le(e,t){return e&~t}function fe(e){var t=r();return this.bitwiseTo(e,le,t),t}function pe(){for(var e=r(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function de(e){var t=r();return 0>e?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function he(e){var t=r();return 0>e?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function ye(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function ge(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+ye(this.data[e]);return this.s<0?this.t*this.DB:-1}function me(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function ve(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=me(this.data[r]^t);return e}function Ce(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)}function Ee(e,r){var n=t.ONE.shiftLeft(e);return this.bitwiseTo(n,r,n),n}function Se(e){return this.changeBit(e,se)}function Te(e){return this.changeBit(e,le)}function Ae(e){return this.changeBit(e,ue)}function be(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);i>r;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=0>n?-1:0,n>0?t.data[r++]=n:-1>n&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function Ie(e){var t=r();return this.addTo(e,t),t}function Be(e){var t=r();return this.subTo(e,t),t}function Ne(e){var t=r();return this.multiplyTo(e,t),t}function ke(e){var t=r();return this.divRemTo(e,t,null),t}function we(e){var t=r();return this.divRemTo(e,null,t),t}function Re(e){var t=r(),n=r();return this.divRemTo(e,t,n),new Array(t,n)}function Le(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function _e(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function De(){}function Ue(e){return e}function Pe(e,t,r){e.multiplyTo(t,r)}function xe(e,t){e.squareTo(t)}function Oe(e){return this.exp(e,new De)}function Ve(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;i>n;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);i>n;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function Ke(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function je(e){this.r2=r(),this.q3=r(),t.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function Me(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=r();return e.copyTo(t),this.reduce(t),t}function qe(e){return e}function Fe(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function He(e,t){e.squareTo(t),this.reduce(t)}function Ge(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function ze(e,t){var n,i,a=e.bitLength(),s=l(1);if(0>=a)return s;n=18>a?1:48>a?3:144>a?4:768>a?5:6,i=8>a?new k(t):t.isEven()?new je(t):new P(t);var o=new Array,u=3,c=n-1,f=(1<<n)-1;if(o[1]=i.convert(this),n>1){var p=r();for(i.sqrTo(o[1],p);f>=u;)o[u]=r(),i.mulTo(p,o[u-2],o[u]),u+=2}var d,h,y=e.t-1,g=!0,v=r();for(a=m(e.data[y])-1;y>=0;){for(a>=c?d=e.data[y]>>a-c&f:(d=(e.data[y]&(1<<a+1)-1)<<c-a,y>0&&(d|=e.data[y-1]>>this.DB+a-c)),u=n;0==(1&d);)d>>=1,--u;if((a-=u)<0&&(a+=this.DB,--y),g)o[d].copyTo(s),g=!1;else{for(;u>1;)i.sqrTo(s,v),i.sqrTo(v,s),u-=2;u>0?i.sqrTo(s,v):(h=s,s=v,v=h),i.mulTo(v,o[d],s)}for(;y>=0&&0==(e.data[y]&1<<a);)i.sqrTo(s,v),h=s,s=v,v=h,--a<0&&(a=this.DB-1,--y)}return i.revert(s)}function Qe(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),a=r.getLowestSetBit();if(0>a)return t;for(a>i&&(a=i),a>0&&(t.rShiftTo(a,t),r.rShiftTo(a,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function Xe(e){if(0>=e)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function We(e){var r=e.isEven();if(this.isEven()&&r||0==e.signum())return t.ZERO;for(var n=e.clone(),i=this.clone(),a=l(1),s=l(0),o=l(0),u=l(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),r?(a.isEven()&&s.isEven()||(a.addTo(this,a),s.subTo(e,s)),a.rShiftTo(1,a)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),r?(o.isEven()&&u.isEven()||(o.addTo(this,o),u.subTo(e,u)),o.rShiftTo(1,o)):u.isEven()||u.subTo(e,u),u.rShiftTo(1,u);n.compareTo(i)>=0?(n.subTo(i,n),r&&a.subTo(o,a),s.subTo(u,s)):(i.subTo(n,i),r&&o.subTo(a,o),u.subTo(s,u))}return 0!=i.compareTo(t.ONE)?t.ZERO:u.compareTo(e)>=0?u.subtract(e):u.signum()<0?(u.addTo(e,u),u.signum()<0?u.add(e):u):u}function Ye(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=ot[ot.length-1]){for(t=0;t<ot.length;++t)if(r.data[0]==ot[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<ot.length;){for(var n=ot[t],i=t+1;i<ot.length&&ut>n;)n*=ot[i++];for(n=r.modInt(n);i>t;)if(n%ot[t++]==0)return!1}return r.millerRabin(e)}function Ze(e){var r=this.subtract(t.ONE),n=r.getLowestSetBit();if(0>=n)return!1;for(var i,a=r.shiftRight(n),s=$e(),o=0;e>o;++o){do i=new t(this.bitLength(),s);while(i.compareTo(t.ONE)<=0||i.compareTo(r)>=0);var u=i.modPow(a,this);if(0!=u.compareTo(t.ONE)&&0!=u.compareTo(r)){for(var c=1;c++<n&&0!=u.compareTo(r);)if(u=u.modPowInt(2,this),0==u.compareTo(t.ONE))return!1;if(0!=u.compareTo(r))return!1}}return!0}function $e(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}}}var Je,et=0xdeadbeefcafe,tt=15715070==(16777215&et);"undefined"==typeof navigator?(t.prototype.am=a,Je=28):tt&&"Microsoft Internet Explorer"==navigator.appName?(t.prototype.am=i,Je=30):tt&&"Netscape"!=navigator.appName?(t.prototype.am=n,Je=26):(t.prototype.am=a,Je=28),t.prototype.DB=Je,t.prototype.DM=(1<<Je)-1,t.prototype.DV=1<<Je;var rt=52;t.prototype.FV=Math.pow(2,rt),t.prototype.F1=rt-Je,t.prototype.F2=2*Je-rt;var nt,it,at="0123456789abcdefghijklmnopqrstuvwxyz",st=new Array;for(nt="0".charCodeAt(0),it=0;9>=it;++it)st[nt++]=it;for(nt="a".charCodeAt(0),it=10;36>it;++it)st[nt++]=it;for(nt="A".charCodeAt(0),it=10;36>it;++it)st[nt++]=it;k.prototype.convert=w,k.prototype.revert=R,k.prototype.reduce=L,k.prototype.mulTo=_,k.prototype.sqrTo=D,P.prototype.convert=x,P.prototype.revert=O,P.prototype.reduce=V,P.prototype.mulTo=j,P.prototype.sqrTo=K,t.prototype.copyTo=u,t.prototype.fromInt=c,t.prototype.fromString=f,t.prototype.clamp=p,t.prototype.dlShiftTo=C,t.prototype.drShiftTo=E,t.prototype.lShiftTo=S,t.prototype.rShiftTo=T,t.prototype.subTo=A,t.prototype.multiplyTo=b,t.prototype.squareTo=I,t.prototype.divRemTo=B,t.prototype.invDigit=U,t.prototype.isEven=M,t.prototype.exp=q,t.prototype.toString=d,t.prototype.negate=h,t.prototype.abs=y,t.prototype.compareTo=g,t.prototype.bitLength=v,t.prototype.mod=N,t.prototype.modPowInt=F,t.ZERO=l(0),t.ONE=l(1),De.prototype.convert=Ue,De.prototype.revert=Ue,De.prototype.mulTo=Pe,De.prototype.sqrTo=xe,je.prototype.convert=Me,je.prototype.revert=qe,je.prototype.reduce=Fe,je.prototype.mulTo=Ge,je.prototype.sqrTo=He;var ot=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ut=(1<<26)/ot[ot.length-1];t.prototype.chunkSize=X,t.prototype.toRadix=Y,t.prototype.fromRadix=Z,t.prototype.fromNumber=$,t.prototype.bitwiseTo=ne,t.prototype.changeBit=Ee,t.prototype.addTo=be,t.prototype.dMultiply=Le,t.prototype.dAddOffset=_e,t.prototype.multiplyLowerTo=Ve,t.prototype.multiplyUpperTo=Ke,t.prototype.modInt=Xe,t.prototype.millerRabin=Ze,t.prototype.clone=H,t.prototype.intValue=G,t.prototype.byteValue=z,t.prototype.shortValue=Q,t.prototype.signum=W,t.prototype.toByteArray=J,t.prototype.equals=ee,t.prototype.min=te,t.prototype.max=re,t.prototype.and=ae,t.prototype.or=oe,t.prototype.xor=ce,t.prototype.andNot=fe,t.prototype.not=pe,t.prototype.shiftLeft=de,t.prototype.shiftRight=he,t.prototype.getLowestSetBit=ge,t.prototype.bitCount=ve,t.prototype.testBit=Ce,t.prototype.setBit=Se,t.prototype.clearBit=Te,t.prototype.flipBit=Ae,t.prototype.add=Ie,t.prototype.subtract=Be,t.prototype.multiply=Ne,t.prototype.divide=ke,t.prototype.remainder=we,t.prototype.divideAndRemainder=Re,t.prototype.modPow=ze,t.prototype.modInverse=We,t.prototype.pow=Oe,t.prototype.gcd=Qe,t.prototype.isProbablePrime=Ye,e.jsbn=e.jsbn||{},e.jsbn.BigInteger=t}var n="jsbn";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsbn",["require","module"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,r,n){n||(n=e.md.sha1.create());for(var i="",a=Math.ceil(r/n.digestLength),s=0;a>s;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,255&s);n.start(),n.update(t+o),i+=n.digest().getBytes()}return i.substring(0,r)}var r=e.pkcs1=e.pkcs1||{};r.encode_rsa_oaep=function(r,n,i){var a,s,o,u;"string"==typeof i?(a=i,s=arguments[3]||void 0,o=arguments[4]||void 0):i&&(a=i.label||void 0,s=i.seed||void 0,o=i.md||void 0,i.mgf1&&i.mgf1.md&&(u=i.mgf1.md)),o?o.start():o=e.md.sha1.create(),u||(u=o);var c=Math.ceil(r.n.bitLength()/8),l=c-2*o.digestLength-2;if(n.length>l){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=n.length,f.maxLength=l,f}a||(a=""),o.update(a,"raw");for(var p=o.digest(),d="",h=l-n.length,y=0;h>y;y++)d+="\x00";var g=p.getBytes()+d+""+n;if(s){if(s.length!==o.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=s.length,f.digestLength=o.digestLength,f}}else s=e.random.getBytes(o.digestLength);var m=t(s,c-o.digestLength-1,u),v=e.util.xorBytes(g,m,g.length),C=t(v,o.digestLength,u),E=e.util.xorBytes(s,C,s.length);return"\x00"+E+v},r.decode_rsa_oaep=function(r,n,i){var a,s,o;"string"==typeof i?(a=i,s=arguments[3]||void 0):i&&(a=i.label||void 0,s=i.md||void 0,i.mgf1&&i.mgf1.md&&(o=i.mgf1.md));var u=Math.ceil(r.n.bitLength()/8);if(n.length!==u){var c=new Error("RSAES-OAEP encoded message length is invalid.");throw c.length=n.length,c.expectedLength=u,c}if(void 0===s?s=e.md.sha1.create():s.start(),o||(o=s),u<2*s.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");a||(a=""),s.update(a,"raw");for(var l=s.digest().getBytes(),f=n.charAt(0),p=n.substring(1,s.digestLength+1),d=n.substring(1+s.digestLength),h=t(d,s.digestLength,o),y=e.util.xorBytes(p,h,p.length),g=t(y,u-s.digestLength-1,o),m=e.util.xorBytes(d,g,d.length),v=m.substring(0,s.digestLength),c="\x00"!==f,C=0;C<s.digestLength;++C)c|=l.charAt(C)!==v.charAt(C);for(var E=1,S=s.digestLength,T=s.digestLength;T<m.length;T++){var A=m.charCodeAt(T),b=1&A^1,I=E?65534:0;c|=A&I,E&=b,S+=E}if(c||1!==m.charCodeAt(S))throw new Error("Invalid RSAES-OAEP padding.");return m.substring(S+1)}}var n="pkcs1";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs1",["require","module","./util","./random","./sha1"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t,i,a){return"workers"in i?n(e,t,i,a):r(e,t,i,a)}function r(t,n,s,o){var c=i(t,n),l=0,f=a(c.bitLength());"millerRabinTests"in s&&(f=s.millerRabinTests);var p=10;"maxBlockTime"in s&&(p=s.maxBlockTime);var d=+new Date;do{if(c.bitLength()>t&&(c=i(t,n)),c.isProbablePrime(f))return o(null,c);c.dAddOffset(u[l++%8],0)}while(0>p||+new Date-d<p);e.util.setImmediate(function(){r(t,n,s,o)})}function n(t,n,a,s){function u(){function e(e){if(!h){--u;var a=e.data;if(a.found){for(var l=0;l<r.length;++l)r[l].terminate();return h=!0,s(null,new o(a.prime,16))}c.bitLength()>t&&(c=i(t,n));var d=c.toString(16);e.target.postMessage({hex:d,workLoad:f}),c.dAddOffset(p,0)}}l=Math.max(1,l);for(var r=[],a=0;l>a;++a)r[a]=new Worker(d);for(var u=l,a=0;l>a;++a)r[a].addEventListener("message",e);var h=!1}if("undefined"==typeof Worker)return r(t,n,a,s);var c=i(t,n),l=a.workers,f=a.workLoad||100,p=30*f/8,d=a.workerScript||"forge/prime.worker.js";return-1===l?e.util.estimateCores(function(e,t){e&&(t=2),l=t-1,u()}):void u()}function i(e,t){var r=new o(e,t),n=e-1;return r.testBit(n)||r.bitwiseTo(o.ONE.shiftLeft(n),l,r),r.dAddOffset(31-r.mod(c).byteValue(),0),r}function a(e){return 100>=e?27:150>=e?18:200>=e?15:250>=e?12:300>=e?9:350>=e?8:400>=e?7:500>=e?6:600>=e?5:800>=e?4:1250>=e?3:2}if(!e.prime){var s=e.prime=e.prime||{},o=e.jsbn.BigInteger,u=[6,4,2,4,2,4,6,2],c=new o(null);c.fromInt(30);var l=function(e,t){return e|t};s.generateProbablePrime=function(r,n,i){"function"==typeof n&&(i=n,n={}),n=n||{};var a=n.algorithm||"PRIMEINC";"string"==typeof a&&(a={name:a}),a.options=a.options||{};var s=n.prng||e.random,o={nextBytes:function(e){for(var t=s.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===a.name)return t(r,o,a.options,i);throw new Error("Invalid prime generation algorithm: "+a.name)}}}var n="prime";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){
r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/prime",["require","module","./util","./jsbn","./random"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,r,n){var i=e.util.createBuffer(),a=Math.ceil(r.n.bitLength()/8);if(t.length>a-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=a-11,s}i.putByte(0),i.putByte(n);var o,u=a-3-t.length;if(0===n||1===n){o=0===n?0:255;for(var c=0;u>c;++c)i.putByte(o)}else for(;u>0;){for(var l=0,f=e.random.getBytes(u),c=0;u>c;++c)o=f.charCodeAt(c),0===o?++l:i.putByte(o);u=l}return i.putByte(0),i.putBytes(t),i}function r(t,r,n,i){var a=Math.ceil(r.n.bitLength()/8),s=e.util.createBuffer(t),o=s.getByte(),u=s.getByte();if(0!==o||n&&0!==u&&1!==u||!n&&2!=u||n&&0===u&&"undefined"==typeof i)throw new Error("Encryption block is invalid.");var c=0;if(0===u){c=a-3-i;for(var l=0;c>l;++l)if(0!==s.getByte())throw new Error("Encryption block is invalid.")}else if(1===u)for(c=0;s.length()>1;){if(255!==s.getByte()){--s.read;break}++c}else if(2===u)for(c=0;s.length()>1;){if(0===s.getByte()){--s.read;break}++c}var f=s.getByte();if(0!==f||c!==a-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function n(t,r,n){function i(){a(t.pBits,function(e,r){return e?n(e):(t.p=r,null!==t.q?o(e,t.q):void a(t.qBits,o))})}function a(t,r){e.prime.generateProbablePrime(t,c,r)}function o(e,r){if(e)return n(e);if(t.q=r,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(0!==t.p.subtract(s.ONE).gcd(t.e).compareTo(s.ONE))return t.p=null,void i();if(0!==t.q.subtract(s.ONE).gcd(t.e).compareTo(s.ONE))return t.q=null,void a(t.qBits,o);if(t.p1=t.p.subtract(s.ONE),t.q1=t.q.subtract(s.ONE),t.phi=t.p1.multiply(t.q1),0!==t.phi.gcd(t.e).compareTo(s.ONE))return t.p=t.q=null,void i();if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits)return t.q=null,void a(t.qBits,o);var l=t.e.modInverse(t.phi);t.keys={privateKey:u.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:u.rsa.setPublicKey(t.n,t.e)},n(null,t.keys)}"function"==typeof r&&(n=r,r={}),r=r||{};var c={algorithm:{name:r.algorithm||"PRIMEINC",options:{workers:r.workers||2,workLoad:r.workLoad||100,workerScript:r.workerScript}}};"prng"in r&&(c.prng=r.prng),i()}function i(t){var r=t.toString(16);return r[0]>="8"&&(r="00"+r),e.util.hexToBytes(r)}function a(e){return 100>=e?27:150>=e?18:200>=e?15:250>=e?12:300>=e?9:350>=e?8:400>=e?7:500>=e?6:600>=e?5:800>=e?4:1250>=e?3:2}if("undefined"==typeof s)var s=e.jsbn.BigInteger;var o=e.asn1;e.pki=e.pki||{},e.pki.rsa=e.rsa=e.rsa||{};var u=e.pki,c=[6,4,2,4,2,4,6,2],l={name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},f={name:"RSAPrivateKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},p={name:"RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},d=e.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},h=function(e){var t;if(!(e.algorithm in u.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=u.oids[e.algorithm];var n=o.oidToDer(t).getBytes(),i=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),a=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);a.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,n)),a.value.push(o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,""));var s=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(a),i.value.push(s),o.toDer(i).getBytes()},y=function(t,r,n){if(n)return t.modPow(r.e,r.n);if(!r.p||!r.q)return t.modPow(r.d,r.n);r.dP||(r.dP=r.d.mod(r.p.subtract(s.ONE))),r.dQ||(r.dQ=r.d.mod(r.q.subtract(s.ONE))),r.qInv||(r.qInv=r.q.modInverse(r.p));var i;do i=new s(e.util.bytesToHex(e.random.getBytes(r.n.bitLength()/8)),16);while(i.compareTo(r.n)>=0||!i.gcd(r.n).equals(s.ONE));t=t.multiply(i.modPow(r.e,r.n)).mod(r.n);for(var a=t.mod(r.p).modPow(r.dP,r.p),o=t.mod(r.q).modPow(r.dQ,r.q);a.compareTo(o)<0;)a=a.add(r.p);var u=a.subtract(o).multiply(r.qInv).mod(r.p).multiply(r.q).add(o);return u=u.multiply(i.modInverse(r.n)).mod(r.n)};u.rsa.encrypt=function(r,n,i){var a,o=i,u=Math.ceil(n.n.bitLength()/8);i!==!1&&i!==!0?(o=2===i,a=t(r,n,i)):(a=e.util.createBuffer(),a.putBytes(r));for(var c=new s(a.toHex(),16),l=y(c,n,o),f=l.toString(16),p=e.util.createBuffer(),d=u-Math.ceil(f.length/2);d>0;)p.putByte(0),--d;return p.putBytes(e.util.hexToBytes(f)),p.getBytes()},u.rsa.decrypt=function(t,n,i,a){var o=Math.ceil(n.n.bitLength()/8);if(t.length!==o){var u=new Error("Encrypted message length is invalid.");throw u.length=t.length,u.expected=o,u}var c=new s(e.util.createBuffer(t).toHex(),16);if(c.compareTo(n.n)>=0)throw new Error("Encrypted message is invalid.");for(var l=y(c,n,i),f=l.toString(16),p=e.util.createBuffer(),d=o-Math.ceil(f.length/2);d>0;)p.putByte(0),--d;return p.putBytes(e.util.hexToBytes(f)),a!==!1?r(p.getBytes(),n,i):p.getBytes()},u.rsa.createKeyPairGenerationState=function(t,r,n){"string"==typeof t&&(t=parseInt(t,10)),t=t||2048,n=n||{};var i,a=n.prng||e.random,o={nextBytes:function(e){for(var t=a.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},u=n.algorithm||"PRIMEINC";if("PRIMEINC"!==u)throw new Error("Invalid key generation algorithm: "+u);return i={algorithm:u,state:0,bits:t,rng:o,eInt:r||65537,e:new s(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},i.e.fromInt(i.eInt),i},u.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new s(null);r.fromInt(30);for(var n,i=0,o=function(e,t){return e|t},l=+new Date,f=0;null===e.keys&&(0>=t||t>f);){if(0===e.state){var p=null===e.p?e.pBits:e.qBits,d=p-1;0===e.pqState?(e.num=new s(p,e.rng),e.num.testBit(d)||e.num.bitwiseTo(s.ONE.shiftLeft(d),o,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),i=0,++e.pqState):1===e.pqState?e.num.bitLength()>p?e.pqState=0:e.num.isProbablePrime(a(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(c[i++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(s.ONE).gcd(e.e).compareTo(s.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(s.ONE),e.q1=e.q.subtract(s.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(s.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var h=e.e.modInverse(e.phi);e.keys={privateKey:u.rsa.setPrivateKey(e.n,e.e,h,e.p,e.q,h.mod(e.p1),h.mod(e.q1),e.q.modInverse(e.p)),publicKey:u.rsa.setPublicKey(e.n,e.e)}}n=+new Date,f+=n-l,l=n}return null!==e.keys},u.rsa.generateKeyPair=function(e,t,r,i){1===arguments.length?"object"==typeof e?(r=e,e=void 0):"function"==typeof e&&(i=e,e=void 0):2===arguments.length?"number"==typeof e?"function"==typeof t?(i=t,t=void 0):"number"!=typeof t&&(r=t,t=void 0):(r=e,i=t,e=void 0,t=void 0):3===arguments.length&&("number"==typeof t?"function"==typeof r&&(i=r,r=void 0):(i=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537);var a=u.rsa.createKeyPairGenerationState(e,t,r);return i?void n(a,r,i):(u.rsa.stepKeyPairGenerationState(a,0),a.keys)},u.setRsaPublicKey=u.rsa.setPublicKey=function(n,i){var a={n:n,e:i};return a.encrypt=function(r,n,i){if("string"==typeof n?n=n.toUpperCase():void 0===n&&(n="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===n)n={encode:function(e,r,n){return t(e,r,2).getBytes()}};else if("RSA-OAEP"===n||"RSAES-OAEP"===n)n={encode:function(t,r){return e.pkcs1.encode_rsa_oaep(r,t,i)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(n))n={encode:function(e){return e}};else if("string"==typeof n)throw new Error('Unsupported encryption scheme: "'+n+'".');var s=n.encode(r,a,!0);return u.rsa.encrypt(s,a,!0)},a.verify=function(e,t,n){"string"==typeof n?n=n.toUpperCase():void 0===n&&(n="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===n?n={verify:function(e,t){t=r(t,a,!0);var n=o.fromDer(t);return e===n.value[1].value}}:("NONE"===n||"NULL"===n||null===n)&&(n={verify:function(e,t){return t=r(t,a,!0),e===t}});var i=u.rsa.decrypt(t,a,!0,!1);return n.verify(e,i,a.n.bitLength())},a},u.setRsaPrivateKey=u.rsa.setPrivateKey=function(t,n,i,a,s,o,c,l){var f={n:t,e:n,d:i,p:a,q:s,dP:o,dQ:c,qInv:l};return f.decrypt=function(t,n,i){"string"==typeof n?n=n.toUpperCase():void 0===n&&(n="RSAES-PKCS1-V1_5");var a=u.rsa.decrypt(t,f,!1,!1);if("RSAES-PKCS1-V1_5"===n)n={decode:r};else if("RSA-OAEP"===n||"RSAES-OAEP"===n)n={decode:function(t,r){return e.pkcs1.decode_rsa_oaep(r,t,i)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(n))throw new Error('Unsupported encryption scheme: "'+n+'".');n={decode:function(e){return e}}}return n.decode(a,f,!1)},f.sign=function(e,t){var r=!1;"string"==typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:h},r=1):("NONE"===t||"NULL"===t||null===t)&&(t={encode:function(){return e}},r=1);var n=t.encode(e,f.n.bitLength());return u.rsa.encrypt(n,f,r)},f},u.wrapRsaPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(e).getBytes())])},u.privateKeyFromAsn1=function(t){var r={},n=[];if(o.validate(t,l,r,n)&&(t=o.fromDer(e.util.createBuffer(r.privateKey))),r={},n=[],!o.validate(t,f,r,n)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=n,i}var a,c,p,d,h,y,g,m;return a=e.util.createBuffer(r.privateKeyModulus).toHex(),c=e.util.createBuffer(r.privateKeyPublicExponent).toHex(),p=e.util.createBuffer(r.privateKeyPrivateExponent).toHex(),d=e.util.createBuffer(r.privateKeyPrime1).toHex(),h=e.util.createBuffer(r.privateKeyPrime2).toHex(),y=e.util.createBuffer(r.privateKeyExponent1).toHex(),g=e.util.createBuffer(r.privateKeyExponent2).toHex(),m=e.util.createBuffer(r.privateKeyCoefficient).toHex(),u.setRsaPrivateKey(new s(a,16),new s(c,16),new s(p,16),new s(d,16),new s(h,16),new s(y,16),new s(g,16),new s(m,16))},u.privateKeyToAsn1=u.privateKeyToRSAPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,i(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,i(e.e)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,i(e.d)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,i(e.p)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,i(e.q)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,i(e.dP)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,i(e.dQ)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,i(e.qInv))])},u.publicKeyFromAsn1=function(t){var r={},n=[];if(o.validate(t,d,r,n)){var i=o.derToOid(r.publicKeyOid);if(i!==u.oids.rsaEncryption){var a=new Error("Cannot read public key. Unknown OID.");throw a.oid=i,a}t=r.rsaPublicKey}if(n=[],!o.validate(t,p,r,n)){var a=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw a.errors=n,a}var c=e.util.createBuffer(r.publicKeyModulus).toHex(),l=e.util.createBuffer(r.publicKeyExponent).toHex();return u.setRsaPublicKey(new s(c,16),new s(l,16))},u.publicKeyToAsn1=u.publicKeyToSubjectPublicKeyInfo=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,[u.publicKeyToRSAPublicKey(e)])])},u.publicKeyToRSAPublicKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,i(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,i(e.e))])}}var n="rsa";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/rsa",["require","module","./asn1","./jsbn","./oids","./pkcs1","./prime","./random","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t){return e.start().update(t).digest().getBytes()}if("undefined"==typeof r)var r=e.jsbn.BigInteger;var n=e.asn1,i=e.pki=e.pki||{};i.pbe=e.pbe=e.pbe||{};var a=i.oids,s={name:"EncryptedPrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},o={name:"PBES2Algorithms",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},u={name:"pkcs-12PbeParams",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"iterations"}]};i.encryptPrivateKeyInfo=function(t,r,s){s=s||{},s.saltSize=s.saltSize||8,s.count=s.count||2048,s.algorithm=s.algorithm||"aes128";var o,u,c,l=e.random.getBytesSync(s.saltSize),f=s.count,p=n.integerToDer(f);if(0===s.algorithm.indexOf("aes")||"des"===s.algorithm){var d,h,y;switch(s.algorithm){case"aes128":o=16,d=16,h=a["aes128-CBC"],y=e.aes.createEncryptionCipher;break;case"aes192":o=24,d=16,h=a["aes192-CBC"],y=e.aes.createEncryptionCipher;break;case"aes256":o=32,d=16,h=a["aes256-CBC"],y=e.aes.createEncryptionCipher;break;case"des":o=8,d=8,h=a.desCBC,y=e.des.createEncryptionCipher;break;default:var g=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw g.algorithm=s.algorithm,g}var m=e.pkcs5.pbkdf2(r,l,f,o),v=e.random.getBytesSync(d),C=y(m);C.start(v),C.update(n.toDer(t)),C.finish(),c=C.output.getBytes(),u=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(a.pkcs5PBES2).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(a.pkcs5PBKDF2).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,l),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,p.getBytes())])]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(h).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,v)])])])}else{if("3des"!==s.algorithm){var g=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw g.algorithm=s.algorithm,g}o=24;var E=new e.util.ByteBuffer(l),m=i.pbe.generatePkcs12Key(r,E,1,f,o),v=i.pbe.generatePkcs12Key(r,E,2,f,o),C=e.des.createEncryptionCipher(m);C.start(v),C.update(n.toDer(t)),C.finish(),c=C.output.getBytes(),u=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(a["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,l),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,p.getBytes())])])}var S=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[u,n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,c)]);return S},i.decryptPrivateKeyInfo=function(t,r){var a=null,o={},u=[];if(!n.validate(t,s,o,u)){var c=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw c.errors=u,c}var l=n.derToOid(o.encryptionOid),f=i.pbe.getCipher(l,o.encryptionParams,r),p=e.util.createBuffer(o.encryptedData);return f.update(p),f.finish()&&(a=n.fromDer(f.output)),a},i.encryptedPrivateKeyToPem=function(t,r){var i={type:"ENCRYPTED PRIVATE KEY",body:n.toDer(t).getBytes()};return e.pem.encode(i,{maxline:r})},i.encryptedPrivateKeyFromPem=function(t){var r=e.pem.decode(t)[0];if("ENCRYPTED PRIVATE KEY"!==r.type){var i=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw i.headerType=r.type,i}if(r.procType&&"ENCRYPTED"===r.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return n.fromDer(r.body)},i.encryptRsaPrivateKey=function(t,r,a){if(a=a||{},!a.legacy){var s=i.wrapRsaPrivateKey(i.privateKeyToAsn1(t));return s=i.encryptPrivateKeyInfo(s,r,a),i.encryptedPrivateKeyToPem(s)}var o,u,c,l;switch(a.algorithm){case"aes128":o="AES-128-CBC",c=16,u=e.random.getBytesSync(16),l=e.aes.createEncryptionCipher;break;case"aes192":o="AES-192-CBC",c=24,u=e.random.getBytesSync(16),l=e.aes.createEncryptionCipher;break;case"aes256":o="AES-256-CBC",c=32,u=e.random.getBytesSync(16),l=e.aes.createEncryptionCipher;break;case"3des":o="DES-EDE3-CBC",c=24,u=e.random.getBytesSync(8),l=e.des.createEncryptionCipher;break;case"des":o="DES-CBC",c=8,u=e.random.getBytesSync(8),l=e.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+a.algorithm+'".');throw f.algorithm=a.algorithm,f}var p=e.pbe.opensslDeriveBytes(r,u.substr(0,8),c),d=l(p);d.start(u),d.update(n.toDer(i.privateKeyToAsn1(t))),d.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:o,parameters:e.util.bytesToHex(u).toUpperCase()},body:d.output.getBytes()};return e.pem.encode(h)},i.decryptRsaPrivateKey=function(t,r){var a=null,s=e.pem.decode(t)[0];if("ENCRYPTED PRIVATE KEY"!==s.type&&"PRIVATE KEY"!==s.type&&"RSA PRIVATE KEY"!==s.type){var o=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw o.headerType=o,o}if(s.procType&&"ENCRYPTED"===s.procType.type){var u,c;switch(s.dekInfo.algorithm){case"DES-CBC":u=8,c=e.des.createDecryptionCipher;break;case"DES-EDE3-CBC":u=24,c=e.des.createDecryptionCipher;break;case"AES-128-CBC":u=16,c=e.aes.createDecryptionCipher;break;case"AES-192-CBC":u=24,c=e.aes.createDecryptionCipher;break;case"AES-256-CBC":u=32,c=e.aes.createDecryptionCipher;break;case"RC2-40-CBC":u=5,c=function(t){return e.rc2.createDecryptionCipher(t,40)};break;case"RC2-64-CBC":u=8,c=function(t){return e.rc2.createDecryptionCipher(t,64)};break;case"RC2-128-CBC":u=16,c=function(t){return e.rc2.createDecryptionCipher(t,128)};break;default:var o=new Error('Could not decrypt private key; unsupported encryption algorithm "'+s.dekInfo.algorithm+'".');throw o.algorithm=s.dekInfo.algorithm,o}var l=e.util.hexToBytes(s.dekInfo.parameters),f=e.pbe.opensslDeriveBytes(r,l.substr(0,8),u),p=c(f);if(p.start(l),p.update(e.util.createBuffer(s.body)),!p.finish())return a;a=p.output.getBytes()}else a=s.body;return a="ENCRYPTED PRIVATE KEY"===s.type?i.decryptPrivateKeyInfo(n.fromDer(a),r):n.fromDer(a),null!==a&&(a=i.privateKeyFromAsn1(a)),a},i.pbe.generatePkcs12Key=function(t,r,n,i,a,s){var o,u;("undefined"==typeof s||null===s)&&(s=e.md.sha1.create());var c=s.digestLength,l=s.blockLength,f=new e.util.ByteBuffer,p=new e.util.ByteBuffer;if(null!==t&&void 0!==t){for(u=0;u<t.length;u++)p.putInt16(t.charCodeAt(u));p.putInt16(0)}var d=p.length(),h=r.length(),y=new e.util.ByteBuffer;y.fillWithByte(n,l);var g=l*Math.ceil(h/l),m=new e.util.ByteBuffer;for(u=0;g>u;u++)m.putByte(r.at(u%h));var v=l*Math.ceil(d/l),C=new e.util.ByteBuffer;for(u=0;v>u;u++)C.putByte(p.at(u%d));var E=m;E.putBuffer(C);for(var S=Math.ceil(a/c),T=1;S>=T;T++){var A=new e.util.ByteBuffer;A.putBytes(y.bytes()),A.putBytes(E.bytes());for(var b=0;i>b;b++)s.start(),s.update(A.getBytes()),A=s.digest();var I=new e.util.ByteBuffer;for(u=0;l>u;u++)I.putByte(A.at(u%c));var B=Math.ceil(h/l)+Math.ceil(d/l),N=new e.util.ByteBuffer;for(o=0;B>o;o++){var k=new e.util.ByteBuffer(E.getBytes(l)),w=511;for(u=I.length()-1;u>=0;u--)w>>=8,w+=I.at(u)+k.at(u),k.setAt(u,255&w);N.putBuffer(k)}E=N,f.putBuffer(A)}return f.truncate(f.length()-a),f},i.pbe.getCipher=function(e,t,r){switch(e){case i.oids.pkcs5PBES2:return i.pbe.getCipherForPBES2(e,t,r);case i.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case i.oids["pbewithSHAAnd40BitRC2-CBC"]:return i.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},i.pbe.getCipherForPBES2=function(t,r,a){var s={},u=[];if(!n.validate(r,o,s,u)){var c=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw c.errors=u,c}if(t=n.derToOid(s.kdfOid),t!==i.oids.pkcs5PBKDF2){var c=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw c.oid=t,c.supportedOids=["pkcs5PBKDF2"],c}if(t=n.derToOid(s.encOid),t!==i.oids["aes128-CBC"]&&t!==i.oids["aes192-CBC"]&&t!==i.oids["aes256-CBC"]&&t!==i.oids["des-EDE3-CBC"]&&t!==i.oids.desCBC){var c=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw c.oid=t,c.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],c}var l=s.kdfSalt,f=e.util.createBuffer(s.kdfIterationCount);f=f.getInt(f.length()<<3);var p,d;switch(i.oids[t]){case"aes128-CBC":p=16,d=e.aes.createDecryptionCipher;break;case"aes192-CBC":p=24,d=e.aes.createDecryptionCipher;break;case"aes256-CBC":p=32,d=e.aes.createDecryptionCipher;break;case"des-EDE3-CBC":p=24,d=e.des.createDecryptionCipher;break;case"desCBC":p=8,d=e.des.createDecryptionCipher}var h=e.pkcs5.pbkdf2(a,l,f,p),y=s.encIv,g=d(h);return g.start(y),g},i.pbe.getCipherForPKCS12PBE=function(t,r,a){var s={},o=[];if(!n.validate(r,u,s,o)){var c=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw c.errors=o,c}var l=e.util.createBuffer(s.salt),f=e.util.createBuffer(s.iterations);f=f.getInt(f.length()<<3);var p,d,h;switch(t){case i.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:p=24,d=8,h=e.des.startDecrypting;break;case i.oids["pbewithSHAAnd40BitRC2-CBC"]:p=5,d=8,h=function(t,r){var n=e.rc2.createDecryptionCipher(t,40);return n.start(r,null),n};break;default:var c=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw c.oid=t,c}var y=i.pbe.generatePkcs12Key(a,l,1,f,p),g=i.pbe.generatePkcs12Key(a,l,2,f,d);return h(y,g)},i.pbe.opensslDeriveBytes=function(r,n,i,a){("undefined"==typeof a||null===a)&&(a=e.md.md5.create()),null===n&&(n="");for(var s=[t(a,r+n)],o=16,u=1;i>o;++u,o+=16)s.push(t(a,s[u-1]+r+n));return s.join("").substr(0,i)}}var n="pbe";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pbe",["require","module","./aes","./asn1","./des","./md","./oids","./pem","./pbkdf2","./random","./rc2","./rsa","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.asn1,r=e.pkcs7asn1=e.pkcs7asn1||{};e.pkcs7=e.pkcs7||{},e.pkcs7.asn1=r;var n={name:"ContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};r.contentInfoValidator=n;var i={name:"EncryptedContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};r.envelopedDataValidator={name:"EnvelopedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(i)},r.encryptedDataValidator={name:"EncryptedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"}].concat(i)};var a={name:"SignerInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};r.signedDataValidator={name:"SignedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},n,{name:"SignedData.Certificates",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",
tagClass:t.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,capture:"signerInfos",optional:!0,value:[a]}]},r.recipientInfoValidator={name:"RecipientInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}var n="pkcs7asn1";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs7asn1",["require","module","./asn1","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.mgf=e.mgf||{};var t=e.mgf.mgf1=e.mgf1=e.mgf1||{};t.create=function(t){var r={generate:function(r,n){for(var i=new e.util.ByteBuffer,a=Math.ceil(n/t.digestLength),s=0;a>s;s++){var o=new e.util.ByteBuffer;o.putInt32(s),t.start(),t.update(r+o.getBytes()),i.putBuffer(t.digest())}return i.truncate(i.length()-n),i.getBytes()}};return r}}var n="mgf1";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/mgf1",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.mgf=e.mgf||{},e.mgf.mgf1=e.mgf1}var n="mgf";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/mgf",["require","module","./mgf1"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.pss=e.pss||{};t.create=function(t){3===arguments.length&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var r=t.md,n=t.mgf,i=r.digestLength,a=t.salt||null;"string"==typeof a&&(a=e.util.createBuffer(a));var s;if("saltLength"in t)s=t.saltLength;else{if(null===a)throw new Error("Salt length not specified or specific salt not given.");s=a.length()}if(null!==a&&a.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=t.prng||e.random,u={};return u.encode=function(t,u){var c,l=u-1,f=Math.ceil(l/8),p=t.digest().getBytes();if(i+s+2>f)throw new Error("Message is too long to encrypt.");var d;d=null===a?o.getBytesSync(s):a.bytes();var h=new e.util.ByteBuffer;h.fillWithByte(0,8),h.putBytes(p),h.putBytes(d),r.start(),r.update(h.getBytes());var y=r.digest().getBytes(),g=new e.util.ByteBuffer;g.fillWithByte(0,f-s-i-2),g.putByte(1),g.putBytes(d);var m=g.getBytes(),v=f-i-1,C=n.generate(y,v),E="";for(c=0;v>c;c++)E+=String.fromCharCode(m.charCodeAt(c)^C.charCodeAt(c));var S=65280>>8*f-l&255;return E=String.fromCharCode(E.charCodeAt(0)&~S)+E.substr(1),E+y+String.fromCharCode(188)},u.verify=function(t,a,o){var u,c=o-1,l=Math.ceil(c/8);if(a=a.substr(-l),i+s+2>l)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==a.charCodeAt(l-1))throw new Error("Encoded message does not end in 0xBC.");var f=l-i-1,p=a.substr(0,f),d=a.substr(f,i),h=65280>>8*l-c&255;if(0!==(p.charCodeAt(0)&h))throw new Error("Bits beyond keysize not zero as expected.");var y=n.generate(d,f),g="";for(u=0;f>u;u++)g+=String.fromCharCode(p.charCodeAt(u)^y.charCodeAt(u));g=String.fromCharCode(g.charCodeAt(0)&~h)+g.substr(1);var m=l-i-s-2;for(u=0;m>u;u++)if(0!==g.charCodeAt(u))throw new Error("Leftmost octets not zero as expected");if(1!==g.charCodeAt(m))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var v=g.substr(-s),C=new e.util.ByteBuffer;C.fillWithByte(0,8),C.putBytes(t),C.putBytes(v),r.start(),r.update(C.getBytes());var E=r.digest().getBytes();return d===E},u}}var n="pss";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pss",["require","module","./random","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t){"string"==typeof t&&(t={shortName:t});for(var r,n=null,i=0;null===n&&i<e.attributes.length;++i)r=e.attributes[i],t.type&&t.type===r.type?n=r:t.name&&t.name===r.name?n=r:t.shortName&&t.shortName===r.shortName&&(n=r);return n}function r(t){for(var r,n,i=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),a=t.attributes,s=0;s<a.length;++s){r=a[s];var u=r.value,c=o.Type.PRINTABLESTRING;"valueTagClass"in r&&(c=r.valueTagClass,c===o.Type.UTF8&&(u=e.util.encodeUtf8(u))),n=o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(r.type).getBytes()),o.create(o.Class.UNIVERSAL,c,!1,u)])]),i.value.push(n)}return i}function n(e){for(var t,r=0;r<e.length;++r){if(t=e[r],"undefined"==typeof t.name&&(t.type&&t.type in u.oids?t.name=u.oids[t.type]:t.shortName&&t.shortName in l&&(t.name=u.oids[l[t.shortName]])),"undefined"==typeof t.type){if(!(t.name&&t.name in u.oids)){var n=new Error("Attribute type not specified.");throw n.attribute=t,n}t.type=u.oids[t.name]}if("undefined"==typeof t.shortName&&t.name&&t.name in l&&(t.shortName=l[t.name]),t.type===c.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=o.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var a=0;a<t.extensions.length;++a)t.value.push(u.certificateExtensionToAsn1(i(t.extensions[a])))}if("undefined"==typeof t.value){var n=new Error("Attribute value not specified.");throw n.attribute=t,n}}}function i(t,r){if(r=r||{},"undefined"==typeof t.name&&t.id&&t.id in u.oids&&(t.name=u.oids[t.id]),"undefined"==typeof t.id){if(!(t.name&&t.name in u.oids)){var n=new Error("Extension ID not specified.");throw n.extension=t,n}t.id=u.oids[t.name]}if("undefined"!=typeof t.value)return t;if("keyUsage"===t.name){var i=0,a=0,s=0;t.digitalSignature&&(a|=128,i=7),t.nonRepudiation&&(a|=64,i=6),t.keyEncipherment&&(a|=32,i=5),t.dataEncipherment&&(a|=16,i=4),t.keyAgreement&&(a|=8,i=3),t.keyCertSign&&(a|=4,i=2),t.cRLSign&&(a|=2,i=1),t.encipherOnly&&(a|=1,i=0),t.decipherOnly&&(s|=128,i=7);var l=String.fromCharCode(i);0!==s?l+=String.fromCharCode(a)+String.fromCharCode(s):0!==a&&(l+=String.fromCharCode(a)),t.value=o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,l)}else if("basicConstraints"===t.name)t.value=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(o.create(o.Class.UNIVERSAL,o.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(t.pathLenConstraint).getBytes()));else if("extKeyUsage"===t.name){t.value=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);var f=t.value.value;for(var p in t)t[p]===!0&&(p in c?f.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c[p]).getBytes())):-1!==p.indexOf(".")&&f.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(p).getBytes())))}else if("nsCertType"===t.name){var i=0,a=0;t.client&&(a|=128,i=7),t.server&&(a|=64,i=6),t.email&&(a|=32,i=5),t.objsign&&(a|=16,i=4),t.reserved&&(a|=8,i=3),t.sslCA&&(a|=4,i=2),t.emailCA&&(a|=2,i=1),t.objCA&&(a|=1,i=0);var l=String.fromCharCode(i);0!==a&&(l+=String.fromCharCode(a)),t.value=o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,l)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){t.value=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);for(var d,h=0;h<t.altNames.length;++h){d=t.altNames[h];var l=d.value;if(7===d.type&&d.ip){if(l=e.util.bytesFromIP(d.ip),null===l){var n=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw n.extension=t,n}}else 8===d.type&&(l=d.oid?o.oidToDer(o.oidToDer(d.oid)):o.oidToDer(l));t.value.value.push(o.create(o.Class.CONTEXT_SPECIFIC,d.type,!1,l))}}else if("subjectKeyIdentifier"===t.name&&r.cert){var y=r.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=y.toHex(),t.value=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,y.getBytes())}if("undefined"==typeof t.value){var n=new Error("Extension value not specified.");throw n.extension=t,n}return t}function a(e,t){switch(e){case c["RSASSA-PSS"]:var r=[];return void 0!==t.hash.algorithmOid&&r.push(o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(t.hash.algorithmOid).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(o.create(o.Class.CONTEXT_SPECIFIC,1,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(t.mgf.algorithmOid).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(t.mgf.hash.algorithmOid).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(o.create(o.Class.CONTEXT_SPECIFIC,2,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(t.saltLength).getBytes())])),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,r);default:return o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")}}function s(t){var r=o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===t.attributes.length)return r;for(var n=t.attributes,i=0;i<n.length;++i){var a=n[i],s=a.value,u=o.Type.UTF8;"valueTagClass"in a&&(u=a.valueTagClass),u===o.Type.UTF8&&(s=e.util.encodeUtf8(s));var c=!1;"valueConstructed"in a&&(c=a.valueConstructed);var l=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.type).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[o.create(o.Class.UNIVERSAL,u,c,s)])]);r.value.push(l)}return r}var o=e.asn1,u=e.pki=e.pki||{},c=u.oids,l={};l.CN=c.commonName,l.commonName="CN",l.C=c.countryName,l.countryName="C",l.L=c.localityName,l.localityName="L",l.ST=c.stateOrProvinceName,l.stateOrProvinceName="ST",l.O=c.organizationName,l.organizationName="O",l.OU=c.organizationalUnitName,l.organizationalUnitName="OU",l.E=c.emailAddress,l.emailAddress="E";var f=e.pki.rsa.publicKeyValidator,p={name:"Certificate",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:o.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:o.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:o.Class.UNIVERSAL,type:o.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:o.Class.UNIVERSAL,type:o.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:o.Class.UNIVERSAL,type:o.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:o.Class.UNIVERSAL,type:o.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},f,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:o.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:o.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:o.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:o.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},d={name:"rsapss",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:o.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:o.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:o.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:o.Class.UNIVERSAL,type:o.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:o.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:o.Class.UNIVERSAL,type:o.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},h={name:"CertificationRequestInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},f,{name:"CertificationRequestInfo.attributes",tagClass:o.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:o.Class.UNIVERSAL,type:o.Type.SET,constructed:!0}]}]}]},y={name:"CertificationRequest",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[h,{name:"CertificationRequest.signatureAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:o.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,capture:"csrSignature"}]};u.RDNAttributesAsArray=function(e,t){for(var r,n,i,a=[],s=0;s<e.value.length;++s){r=e.value[s];for(var u=0;u<r.value.length;++u)i={},n=r.value[u],i.type=o.derToOid(n.value[0].value),i.value=n.value[1].value,i.valueTagClass=n.value[1].type,i.type in c&&(i.name=c[i.type],i.name in l&&(i.shortName=l[i.name])),t&&(t.update(i.type),t.update(i.value)),a.push(i)}return a},u.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var n=e[r],i=o.derToOid(n.value[0].value),a=n.value[1].value,s=0;s<a.length;++s){var f={};if(f.type=i,f.value=a[s].value,f.valueTagClass=a[s].type,f.type in c&&(f.name=c[f.type],f.name in l&&(f.shortName=l[f.name])),f.type===c.extensionRequest){f.extensions=[];for(var p=0;p<f.value.length;++p)f.extensions.push(u.certificateExtensionFromAsn1(f.value[p]))}t.push(f)}return t};var g=function(e,t,r){var n={};if(e!==c["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:c.sha1},mgf:{algorithmOid:c.mgf1,hash:{algorithmOid:c.sha1}},saltLength:20});var i={},a=[];if(!o.validate(t,d,i,a)){var s=new Error("Cannot read RSASSA-PSS parameter block.");throw s.errors=a,s}return void 0!==i.hashOid&&(n.hash=n.hash||{},n.hash.algorithmOid=o.derToOid(i.hashOid)),void 0!==i.maskGenOid&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=o.derToOid(i.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=o.derToOid(i.maskGenHashOid)),void 0!==i.saltLength&&(n.saltLength=i.saltLength.charCodeAt(0)),n};u.certificateFromPem=function(t,r,n){var i=e.pem.decode(t)[0];if("CERTIFICATE"!==i.type&&"X509 CERTIFICATE"!==i.type&&"TRUSTED CERTIFICATE"!==i.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=i.type,a}if(i.procType&&"ENCRYPTED"===i.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=o.fromDer(i.body,n);return u.certificateFromAsn1(s,r)},u.certificateToPem=function(t,r){var n={type:"CERTIFICATE",body:o.toDer(u.certificateToAsn1(t)).getBytes()};return e.pem.encode(n,{maxline:r})},u.publicKeyFromPem=function(t){var r=e.pem.decode(t)[0];if("PUBLIC KEY"!==r.type&&"RSA PUBLIC KEY"!==r.type){var n=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw n.headerType=r.type,n}if(r.procType&&"ENCRYPTED"===r.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var i=o.fromDer(r.body);return u.publicKeyFromAsn1(i)},u.publicKeyToPem=function(t,r){var n={type:"PUBLIC KEY",body:o.toDer(u.publicKeyToAsn1(t)).getBytes()};return e.pem.encode(n,{maxline:r})},u.publicKeyToRSAPublicKeyPem=function(t,r){var n={type:"RSA PUBLIC KEY",body:o.toDer(u.publicKeyToRSAPublicKey(t)).getBytes()};return e.pem.encode(n,{maxline:r})},u.getPublicKeyFingerprint=function(t,r){r=r||{};var n,i=r.md||e.md.sha1.create(),a=r.type||"RSAPublicKey";switch(a){case"RSAPublicKey":n=o.toDer(u.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":n=o.toDer(u.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+r.type+'".')}i.start(),i.update(n);var s=i.digest();if("hex"===r.encoding){var c=s.toHex();return r.delimiter?c.match(/.{2}/g).join(r.delimiter):c}if("binary"===r.encoding)return s.getBytes();if(r.encoding)throw new Error('Unknown encoding "'+r.encoding+'".');return s},u.certificationRequestFromPem=function(t,r,n){var i=e.pem.decode(t)[0];if("CERTIFICATE REQUEST"!==i.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=i.type,a}if(i.procType&&"ENCRYPTED"===i.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=o.fromDer(i.body,n);return u.certificationRequestFromAsn1(s,r)},u.certificationRequestToPem=function(t,r){var n={type:"CERTIFICATE REQUEST",body:o.toDer(u.certificationRequestToAsn1(t)).getBytes()};return e.pem.encode(n,{maxline:r})},u.createCertificate=function(){var r={};return r.version=2,r.serialNumber="00",r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.validity={},r.validity.notBefore=new Date,r.validity.notAfter=new Date,r.issuer={},r.issuer.getField=function(e){return t(r.issuer,e)},r.issuer.addField=function(e){n([e]),r.issuer.attributes.push(e)},r.issuer.attributes=[],r.issuer.hash=null,r.subject={},r.subject.getField=function(e){return t(r.subject,e)},r.subject.addField=function(e){n([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.extensions=[],r.publicKey=null,r.md=null,r.setSubject=function(e,t){n(e),r.subject.attributes=e,delete r.subject.uniqueId,t&&(r.subject.uniqueId=t),r.subject.hash=null},r.setIssuer=function(e,t){n(e),r.issuer.attributes=e,delete r.issuer.uniqueId,t&&(r.issuer.uniqueId=t),r.issuer.hash=null},r.setExtensions=function(e){for(var t=0;t<e.length;++t)i(e[t],{cert:r});r.extensions=e},r.getExtension=function(e){"string"==typeof e&&(e={name:e});for(var t,n=null,i=0;null===n&&i<r.extensions.length;++i)t=r.extensions[i],e.id&&t.id===e.id?n=t:e.name&&t.name===e.name&&(n=t);return n},r.sign=function(t,n){r.md=n||e.md.sha1.create();var i=c[r.md.algorithm+"WithRSAEncryption"];if(!i){var a=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw a.algorithm=r.md.algorithm,a}r.signatureOid=r.siginfo.algorithmOid=i,r.tbsCertificate=u.getTBSCertificate(r);var s=o.toDer(r.tbsCertificate);r.md.update(s.getBytes()),r.signature=t.sign(r.md)},r.verify=function(t){var n=!1;if(!r.issued(t)){var i=t.issuer,a=r.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=i.attributes,s.actualIssuer=a.attributes,s}var l=t.md;if(null===l){if(t.signatureOid in c){var f=c[t.signatureOid];switch(f){case"sha1WithRSAEncryption":l=e.md.sha1.create();break;case"md5WithRSAEncryption":l=e.md.md5.create();break;case"sha256WithRSAEncryption":l=e.md.sha256.create();break;case"sha512WithRSAEncryption":l=e.md.sha512.create();break;case"RSASSA-PSS":l=e.md.sha256.create()}}if(null===l){var s=new Error("Could not compute certificate digest. Unknown signature OID.");throw s.signatureOid=t.signatureOid,s}var p=t.tbsCertificate||u.getTBSCertificate(t),d=o.toDer(p);l.update(d.getBytes())}if(null!==l){var h;switch(t.signatureOid){case c.sha1WithRSAEncryption:h=void 0;break;case c["RSASSA-PSS"]:var y,g;if(y=c[t.signatureParameters.mgf.hash.algorithmOid],void 0===y||void 0===e.md[y]){var s=new Error("Unsupported MGF hash function.");throw s.oid=t.signatureParameters.mgf.hash.algorithmOid,s.name=y,s}if(g=c[t.signatureParameters.mgf.algorithmOid],void 0===g||void 0===e.mgf[g]){var s=new Error("Unsupported MGF function.");throw s.oid=t.signatureParameters.mgf.algorithmOid,s.name=g,s}if(g=e.mgf[g].create(e.md[y].create()),y=c[t.signatureParameters.hash.algorithmOid],void 0===y||void 0===e.md[y])throw{message:"Unsupported RSASSA-PSS hash function.",oid:t.signatureParameters.hash.algorithmOid,name:y};h=e.pss.create(e.md[y].create(),g,t.signatureParameters.saltLength)}n=r.publicKey.verify(l.digest().getBytes(),t.signature,h)}return n},r.isIssuer=function(e){var t=!1,n=r.issuer,i=e.subject;if(n.hash&&i.hash)t=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){t=!0;for(var a,s,o=0;t&&o<n.attributes.length;++o)a=n.attributes[o],s=i.attributes[o],(a.type!==s.type||a.value!==s.value)&&(t=!1)}return t},r.issued=function(e){return e.isIssuer(r)},r.generateSubjectKeyIdentifier=function(){return u.getPublicKeyFingerprint(r.publicKey,{type:"RSAPublicKey"})},r.verifySubjectKeyIdentifier=function(){for(var t=c.subjectKeyIdentifier,n=0;n<r.extensions.length;++n){var i=r.extensions[n];if(i.id===t){var a=r.generateSubjectKeyIdentifier().getBytes();return e.util.hexToBytes(i.subjectKeyIdentifier)===a}}return!1},r},u.certificateFromAsn1=function(r,i){var a={},s=[];if(!o.validate(r,p,a,s)){var l=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw l.errors=s,l}if("string"!=typeof a.certSignature){for(var f="\x00",d=0;d<a.certSignature.length;++d)f+=o.toDer(a.certSignature[d]).getBytes();a.certSignature=f}var h=o.derToOid(a.publicKeyOid);if(h!==u.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var y=u.createCertificate();y.version=a.certVersion?a.certVersion.charCodeAt(0):0;var m=e.util.createBuffer(a.certSerialNumber);y.serialNumber=m.toHex(),y.signatureOid=e.asn1.derToOid(a.certSignatureOid),y.signatureParameters=g(y.signatureOid,a.certSignatureParams,!0),y.siginfo.algorithmOid=e.asn1.derToOid(a.certinfoSignatureOid),y.siginfo.parameters=g(y.siginfo.algorithmOid,a.certinfoSignatureParams,!1);var v=e.util.createBuffer(a.certSignature);++v.read,y.signature=v.getBytes();var C=[];if(void 0!==a.certValidity1UTCTime&&C.push(o.utcTimeToDate(a.certValidity1UTCTime)),void 0!==a.certValidity2GeneralizedTime&&C.push(o.generalizedTimeToDate(a.certValidity2GeneralizedTime)),void 0!==a.certValidity3UTCTime&&C.push(o.utcTimeToDate(a.certValidity3UTCTime)),void 0!==a.certValidity4GeneralizedTime&&C.push(o.generalizedTimeToDate(a.certValidity4GeneralizedTime)),C.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(C.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(y.validity.notBefore=C[0],y.validity.notAfter=C[1],y.tbsCertificate=a.tbsCertificate,i){if(y.md=null,y.signatureOid in c){var h=c[y.signatureOid];switch(h){case"sha1WithRSAEncryption":y.md=e.md.sha1.create();break;case"md5WithRSAEncryption":y.md=e.md.md5.create();break;case"sha256WithRSAEncryption":y.md=e.md.sha256.create();break;case"sha512WithRSAEncryption":y.md=e.md.sha512.create();break;case"RSASSA-PSS":y.md=e.md.sha256.create()}}if(null===y.md){var l=new Error("Could not compute certificate digest. Unknown signature OID.");throw l.signatureOid=y.signatureOid,l}var E=o.toDer(y.tbsCertificate);y.md.update(E.getBytes())}var S=e.md.sha1.create();y.issuer.getField=function(e){return t(y.issuer,e)},y.issuer.addField=function(e){n([e]),y.issuer.attributes.push(e)},y.issuer.attributes=u.RDNAttributesAsArray(a.certIssuer,S),a.certIssuerUniqueId&&(y.issuer.uniqueId=a.certIssuerUniqueId),y.issuer.hash=S.digest().toHex();var T=e.md.sha1.create();return y.subject.getField=function(e){return t(y.subject,e)},y.subject.addField=function(e){n([e]),y.subject.attributes.push(e)},y.subject.attributes=u.RDNAttributesAsArray(a.certSubject,T),a.certSubjectUniqueId&&(y.subject.uniqueId=a.certSubjectUniqueId),y.subject.hash=T.digest().toHex(),a.certExtensions?y.extensions=u.certificateExtensionsFromAsn1(a.certExtensions):y.extensions=[],y.publicKey=u.publicKeyFromAsn1(a.subjectPublicKeyInfo),y},u.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var n=e.value[r],i=0;i<n.value.length;++i)t.push(u.certificateExtensionFromAsn1(n.value[i]));return t},u.certificateExtensionFromAsn1=function(t){var r={};if(r.id=o.derToOid(t.value[0].value),r.critical=!1,t.value[1].type===o.Type.BOOLEAN?(r.critical=0!==t.value[1].value.charCodeAt(0),r.value=t.value[2].value):r.value=t.value[1].value,r.id in c)if(r.name=c[r.id],"keyUsage"===r.name){var n=o.fromDer(r.value),i=0,a=0;n.value.length>1&&(i=n.value.charCodeAt(1),a=n.value.length>2?n.value.charCodeAt(2):0),r.digitalSignature=128===(128&i),r.nonRepudiation=64===(64&i),r.keyEncipherment=32===(32&i),r.dataEncipherment=16===(16&i),r.keyAgreement=8===(8&i),r.keyCertSign=4===(4&i),r.cRLSign=2===(2&i),r.encipherOnly=1===(1&i),r.decipherOnly=128===(128&a)}else if("basicConstraints"===r.name){var n=o.fromDer(r.value);n.value.length>0&&n.value[0].type===o.Type.BOOLEAN?r.cA=0!==n.value[0].value.charCodeAt(0):r.cA=!1;var s=null;n.value.length>0&&n.value[0].type===o.Type.INTEGER?s=n.value[0].value:n.value.length>1&&(s=n.value[1].value),null!==s&&(r.pathLenConstraint=o.derToInteger(s))}else if("extKeyUsage"===r.name)for(var n=o.fromDer(r.value),u=0;u<n.value.length;++u){var l=o.derToOid(n.value[u].value);l in c?r[c[l]]=!0:r[l]=!0}else if("nsCertType"===r.name){var n=o.fromDer(r.value),i=0;n.value.length>1&&(i=n.value.charCodeAt(1)),r.client=128===(128&i),r.server=64===(64&i),r.email=32===(32&i),r.objsign=16===(16&i),r.reserved=8===(8&i),r.sslCA=4===(4&i),r.emailCA=2===(2&i),r.objCA=1===(1&i)}else if("subjectAltName"===r.name||"issuerAltName"===r.name){r.altNames=[];for(var f,n=o.fromDer(r.value),p=0;p<n.value.length;++p){f=n.value[p];var d={type:f.type,value:f.value};switch(r.altNames.push(d),f.type){case 1:case 2:case 6:break;case 7:d.ip=e.util.bytesToIP(f.value);break;case 8:d.oid=o.derToOid(f.value)}}}else if("subjectKeyIdentifier"===r.name){var n=o.fromDer(r.value);r.subjectKeyIdentifier=e.util.bytesToHex(n.value)}return r},u.certificationRequestFromAsn1=function(r,i){
var a={},s=[];if(!o.validate(r,y,a,s)){var l=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw l.errors=s,l}if("string"!=typeof a.csrSignature){for(var f="\x00",p=0;p<a.csrSignature.length;++p)f+=o.toDer(a.csrSignature[p]).getBytes();a.csrSignature=f}var d=o.derToOid(a.publicKeyOid);if(d!==u.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var h=u.createCertificationRequest();h.version=a.csrVersion?a.csrVersion.charCodeAt(0):0,h.signatureOid=e.asn1.derToOid(a.csrSignatureOid),h.signatureParameters=g(h.signatureOid,a.csrSignatureParams,!0),h.siginfo.algorithmOid=e.asn1.derToOid(a.csrSignatureOid),h.siginfo.parameters=g(h.siginfo.algorithmOid,a.csrSignatureParams,!1);var m=e.util.createBuffer(a.csrSignature);if(++m.read,h.signature=m.getBytes(),h.certificationRequestInfo=a.certificationRequestInfo,i){if(h.md=null,h.signatureOid in c){var d=c[h.signatureOid];switch(d){case"sha1WithRSAEncryption":h.md=e.md.sha1.create();break;case"md5WithRSAEncryption":h.md=e.md.md5.create();break;case"sha256WithRSAEncryption":h.md=e.md.sha256.create();break;case"sha512WithRSAEncryption":h.md=e.md.sha512.create();break;case"RSASSA-PSS":h.md=e.md.sha256.create()}}if(null===h.md){var l=new Error("Could not compute certification request digest. Unknown signature OID.");throw l.signatureOid=h.signatureOid,l}var v=o.toDer(h.certificationRequestInfo);h.md.update(v.getBytes())}var C=e.md.sha1.create();return h.subject.getField=function(e){return t(h.subject,e)},h.subject.addField=function(e){n([e]),h.subject.attributes.push(e)},h.subject.attributes=u.RDNAttributesAsArray(a.certificationRequestInfoSubject,C),h.subject.hash=C.digest().toHex(),h.publicKey=u.publicKeyFromAsn1(a.subjectPublicKeyInfo),h.getAttribute=function(e){return t(h,e)},h.addAttribute=function(e){n([e]),h.attributes.push(e)},h.attributes=u.CRIAttributesAsArray(a.certificationRequestInfoAttributes||[]),h},u.createCertificationRequest=function(){var r={};return r.version=0,r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.subject={},r.subject.getField=function(e){return t(r.subject,e)},r.subject.addField=function(e){n([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.publicKey=null,r.attributes=[],r.getAttribute=function(e){return t(r,e)},r.addAttribute=function(e){n([e]),r.attributes.push(e)},r.md=null,r.setSubject=function(e){n(e),r.subject.attributes=e,r.subject.hash=null},r.setAttributes=function(e){n(e),r.attributes=e},r.sign=function(t,n){r.md=n||e.md.sha1.create();var i=c[r.md.algorithm+"WithRSAEncryption"];if(!i){var a=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw a.algorithm=r.md.algorithm,a}r.signatureOid=r.siginfo.algorithmOid=i,r.certificationRequestInfo=u.getCertificationRequestInfo(r);var s=o.toDer(r.certificationRequestInfo);r.md.update(s.getBytes()),r.signature=t.sign(r.md)},r.verify=function(){var t=!1,n=r.md;if(null===n){if(r.signatureOid in c){var i=c[r.signatureOid];switch(i){case"sha1WithRSAEncryption":n=e.md.sha1.create();break;case"md5WithRSAEncryption":n=e.md.md5.create();break;case"sha256WithRSAEncryption":n=e.md.sha256.create();break;case"sha512WithRSAEncryption":n=e.md.sha512.create();break;case"RSASSA-PSS":n=e.md.sha256.create()}}if(null===n){var a=new Error("Could not compute certification request digest. Unknown signature OID.");throw a.signatureOid=r.signatureOid,a}var s=r.certificationRequestInfo||u.getCertificationRequestInfo(r),l=o.toDer(s);n.update(l.getBytes())}if(null!==n){var f;switch(r.signatureOid){case c.sha1WithRSAEncryption:break;case c["RSASSA-PSS"]:var p,d;if(p=c[r.signatureParameters.mgf.hash.algorithmOid],void 0===p||void 0===e.md[p]){var a=new Error("Unsupported MGF hash function.");throw a.oid=r.signatureParameters.mgf.hash.algorithmOid,a.name=p,a}if(d=c[r.signatureParameters.mgf.algorithmOid],void 0===d||void 0===e.mgf[d]){var a=new Error("Unsupported MGF function.");throw a.oid=r.signatureParameters.mgf.algorithmOid,a.name=d,a}if(d=e.mgf[d].create(e.md[p].create()),p=c[r.signatureParameters.hash.algorithmOid],void 0===p||void 0===e.md[p]){var a=new Error("Unsupported RSASSA-PSS hash function.");throw a.oid=r.signatureParameters.hash.algorithmOid,a.name=p,a}f=e.pss.create(e.md[p].create(),d,r.signatureParameters.saltLength)}t=r.publicKey.verify(n.digest().getBytes(),r.signature,f)}return t},r},u.getTBSCertificate=function(t){var n=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(t.version).getBytes())]),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,e.util.hexToBytes(t.serialNumber)),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(t.siginfo.algorithmOid).getBytes()),a(t.siginfo.algorithmOid,t.siginfo.parameters)]),r(t.issuer),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.UTCTIME,!1,o.dateToUtcTime(t.validity.notBefore)),o.create(o.Class.UNIVERSAL,o.Type.UTCTIME,!1,o.dateToUtcTime(t.validity.notAfter))]),r(t.subject),u.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&n.value.push(o.create(o.Class.CONTEXT_SPECIFIC,1,!0,[o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&n.value.push(o.create(o.Class.CONTEXT_SPECIFIC,2,!0,[o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),t.extensions.length>0&&n.value.push(u.certificateExtensionsToAsn1(t.extensions)),n},u.getCertificationRequestInfo=function(e){var t=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(e.version).getBytes()),r(e.subject),u.publicKeyToAsn1(e.publicKey),s(e)]);return t},u.distinguishedNameToAsn1=function(e){return r(e)},u.certificateToAsn1=function(e){var t=e.tbsCertificate||u.getTBSCertificate(e);return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[t,o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(e.signatureOid).getBytes()),a(e.signatureOid,e.signatureParameters)]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},u.certificateExtensionsToAsn1=function(e){var t=o.create(o.Class.CONTEXT_SPECIFIC,3,!0,[]),r=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);t.value.push(r);for(var n=0;n<e.length;++n)r.value.push(u.certificateExtensionToAsn1(e[n]));return t},u.certificateExtensionToAsn1=function(e){var t=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);t.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(e.id).getBytes())),e.critical&&t.value.push(o.create(o.Class.UNIVERSAL,o.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=e.value;return"string"!=typeof e.value&&(r=o.toDer(r).getBytes()),t.value.push(o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,r)),t},u.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||u.getCertificationRequestInfo(e);return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[t,o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(e.signatureOid).getBytes()),a(e.signatureOid,e.signatureParameters)]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},u.createCaStore=function(t){function n(t){if(!t.hash){var n=e.md.sha1.create();t.attributes=u.RDNAttributesAsArray(r(t),n),t.hash=n.digest().toHex()}return i.certs[t.hash]||null}var i={certs:{}};if(i.getIssuer=function(e){var t=n(e.issuer);return t},i.addCertificate=function(t){if("string"==typeof t&&(t=e.pki.certificateFromPem(t)),!t.subject.hash){var n=e.md.sha1.create();t.subject.attributes=u.RDNAttributesAsArray(r(t.subject),n),t.subject.hash=n.digest().toHex()}if(t.subject.hash in i.certs){var a=i.certs[t.subject.hash];e.util.isArray(a)||(a=[a]),a.push(t)}else i.certs[t.subject.hash]=t},i.hasCertificate=function(t){var r=n(t.subject);if(!r)return!1;e.util.isArray(r)||(r=[r]);for(var i=o.toDer(u.certificateToAsn1(t)).getBytes(),a=0;a<r.length;++a){var s=o.toDer(u.certificateToAsn1(r[a])).getBytes();if(i===s)return!0}return!1},t)for(var a=0;a<t.length;++a){var s=t[a];i.addCertificate(s)}return i},u.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},u.verifyCertificateChain=function(t,r,n){r=r.slice(0);var i=r.slice(0),a=new Date,s=!0,o=null,c=0;do{var l=r.shift(),f=null,p=!1;if((a<l.validity.notBefore||a>l.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:u.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:a}),null===o){if(f=r[0]||t.getIssuer(l),null===f&&l.isIssuer(l)&&(p=!0,f=l),f){var d=f;e.util.isArray(d)||(d=[d]);for(var h=!1;!h&&d.length>0;){f=d.shift();try{h=f.verify(l)}catch(y){}}h||(o={message:"Certificate signature is invalid.",error:u.certificateError.bad_certificate})}null!==o||f&&!p||t.hasCertificate(l)||(o={message:"Certificate is not trusted.",error:u.certificateError.unknown_ca})}if(null===o&&f&&!l.isIssuer(f)&&(o={message:"Certificate issuer is invalid.",error:u.certificateError.bad_certificate}),null===o)for(var g={keyUsage:!0,basicConstraints:!0},m=0;null===o&&m<l.extensions.length;++m){var v=l.extensions[m];!v.critical||v.name in g||(o={message:"Certificate has an unsupported critical extension.",error:u.certificateError.unsupported_certificate})}if(null===o&&(!s||0===r.length&&(!f||p))){var C=l.getExtension("basicConstraints"),E=l.getExtension("keyUsage");if(null!==E&&(E.keyCertSign&&null!==C||(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:u.certificateError.bad_certificate})),null!==o||null===C||C.cA||(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:u.certificateError.bad_certificate}),null===o&&null!==E&&"pathLenConstraint"in C){var S=c-1;S>C.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:u.certificateError.bad_certificate})}}var T=null===o?!0:o.error,A=n?n(T,c,i):T;if(A!==!0)throw T===!0&&(o={message:"The application rejected the certificate.",error:u.certificateError.bad_certificate}),(A||0===A)&&("object"!=typeof A||e.util.isArray(A)?"string"==typeof A&&(o.error=A):(A.message&&(o.message=A.message),A.error&&(o.error=A.error))),o;o=null,s=!1,++c}while(r.length>0);return!0}}var n="x509";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r.pki}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/x509",["require","module","./aes","./asn1","./des","./md","./mgf","./oids","./pem","./pss","./rsa","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t,r,n){for(var i=[],a=0;a<e.length;a++)for(var s=0;s<e[a].safeBags.length;s++){var o=e[a].safeBags[s];(void 0===n||o.type===n)&&(null!==t?void 0!==o.attributes[t]&&o.attributes[t].indexOf(r)>=0&&i.push(o):i.push(o))}return i}function r(t){if(t.composed||t.constructed){for(var r=e.util.createBuffer(),n=0;n<t.value.length;++n)r.putBytes(t.value[n].value);t.composed=t.constructed=!1,t.value=r.getBytes()}return t}function n(e,t,n,s){if(t=o.fromDer(t,n),t.tagClass!==o.Class.UNIVERSAL||t.type!==o.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var c=0;c<t.value.length;c++){var f=t.value[c],p={},d=[];if(!o.validate(f,l,p,d)){var h=new Error("Cannot read ContentInfo.");throw h.errors=d,h}var y={encrypted:!1},g=null,m=p.content.value[0];switch(o.derToOid(p.contentType)){case u.oids.data:if(m.tagClass!==o.Class.UNIVERSAL||m.type!==o.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");g=r(m).value;break;case u.oids.encryptedData:g=i(m,s),y.encrypted=!0;break;default:var h=new Error("Unsupported PKCS#12 contentType.");throw h.contentType=o.derToOid(p.contentType),h}y.safeBags=a(g,n,s),e.safeContents.push(y)}}function i(t,n){var i={},a=[];if(!o.validate(t,e.pkcs7.asn1.encryptedDataValidator,i,a)){var s=new Error("Cannot read EncryptedContentInfo.");throw s.errors=a,s}var c=o.derToOid(i.contentType);if(c!==u.oids.data){var s=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw s.oid=c,s}c=o.derToOid(i.encAlgorithm);var l=u.pbe.getCipher(c,i.encParameter,n),f=r(i.encryptedContentAsn1),p=e.util.createBuffer(f.value);if(l.update(p),!l.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return l.output.getBytes()}function a(e,t,r){if(!t&&0===e.length)return[];if(e=o.fromDer(e,t),e.tagClass!==o.Class.UNIVERSAL||e.type!==o.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],i=0;i<e.value.length;i++){var a=e.value[i],c={},l=[];if(!o.validate(a,p,c,l)){var f=new Error("Cannot read SafeBag.");throw f.errors=l,f}var d={type:o.derToOid(c.bagId),attributes:s(c.bagAttributes)};n.push(d);var y,g,m=c.bagValue.value[0];switch(d.type){case u.oids.pkcs8ShroudedKeyBag:if(m=u.decryptPrivateKeyInfo(m,r),null===m)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case u.oids.keyBag:try{d.key=u.privateKeyFromAsn1(m)}catch(v){d.key=null,d.asn1=m}continue;case u.oids.certBag:y=h,g=function(){if(o.derToOid(c.certId)!==u.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=o.derToOid(c.certId),e}var r=o.fromDer(c.cert,t);try{d.cert=u.certificateFromAsn1(r,!0)}catch(n){d.cert=null,d.asn1=r}};break;default:var f=new Error("Unsupported PKCS#12 SafeBag type.");throw f.oid=d.type,f}if(void 0!==y&&!o.validate(m,y,c,l)){var f=new Error("Cannot read PKCS#12 "+y.name);throw f.errors=l,f}g()}return n}function s(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var n={},i=[];if(!o.validate(e[r],d,n,i)){var a=new Error("Cannot read PKCS#12 BagAttribute.");throw a.errors=i,a}var s=o.derToOid(n.oid);if(void 0!==u.oids[s]){t[u.oids[s]]=[];for(var c=0;c<n.values.length;++c)t[u.oids[s]].push(n.values[c].value)}}return t}var o=e.asn1,u=e.pki,c=e.pkcs12=e.pkcs12||{},l={name:"ContentInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:o.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},f={name:"PFX",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"version"},l,{name:"PFX.macData",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:o.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},p={name:"SafeBag",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:o.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:o.Class.UNIVERSAL,type:o.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},d={name:"Attribute",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:o.Class.UNIVERSAL,type:o.Type.SET,constructed:!0,capture:"values"}]},h={name:"CertBag",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:o.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:o.Class.UNIVERSAL,type:o.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};c.pkcs12FromAsn1=function(i,a,s){"string"==typeof a?(s=a,a=!0):void 0===a&&(a=!0);var l={},p=[];if(!o.validate(i,f,l,p)){var d=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw d.errors=d,d}var h={version:l.version.charCodeAt(0),safeContents:[],getBags:function(r){var n,i={};return"localKeyId"in r?n=r.localKeyId:"localKeyIdHex"in r&&(n=e.util.hexToBytes(r.localKeyIdHex)),void 0===n&&!("friendlyName"in r)&&"bagType"in r&&(i[r.bagType]=t(h.safeContents,null,null,r.bagType)),void 0!==n&&(i.localKeyId=t(h.safeContents,"localKeyId",n,r.bagType)),"friendlyName"in r&&(i.friendlyName=t(h.safeContents,"friendlyName",r.friendlyName,r.bagType)),i},getBagsByFriendlyName:function(e,r){return t(h.safeContents,"friendlyName",e,r)},getBagsByLocalKeyId:function(e,r){return t(h.safeContents,"localKeyId",e,r)}};if(3!==l.version.charCodeAt(0)){var d=new Error("PKCS#12 PFX of version other than 3 not supported.");throw d.version=l.version.charCodeAt(0),d}if(o.derToOid(l.contentType)!==u.oids.data){var d=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw d.oid=o.derToOid(l.contentType),d}var y=l.content.value[0];if(y.tagClass!==o.Class.UNIVERSAL||y.type!==o.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(y=r(y),l.mac){var g=null,m=0,v=o.derToOid(l.macAlgorithm);switch(v){case u.oids.sha1:g=e.md.sha1.create(),m=20;break;case u.oids.sha256:g=e.md.sha256.create(),m=32;break;case u.oids.sha384:g=e.md.sha384.create(),m=48;break;case u.oids.sha512:g=e.md.sha512.create(),m=64;break;case u.oids.md5:g=e.md.md5.create(),m=16}if(null===g)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+v);var C=new e.util.ByteBuffer(l.macSalt),E="macIterations"in l?parseInt(e.util.bytesToHex(l.macIterations),16):1,S=c.generateKey(s,C,3,E,m,g),T=e.hmac.create();T.start(g,S),T.update(y.value);var A=T.getMac();if(A.getBytes()!==l.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return n(h,y.value,a,s),h},c.toPkcs12Asn1=function(t,r,n,i){i=i||{},i.saltSize=i.saltSize||8,i.count=i.count||2048,i.algorithm=i.algorithm||i.encAlgorithm||"aes128","useMac"in i||(i.useMac=!0),"localKeyId"in i||(i.localKeyId=null),"generateLocalKeyId"in i||(i.generateLocalKeyId=!0);var a,s=i.localKeyId;if(null!==s)s=e.util.hexToBytes(s);else if(i.generateLocalKeyId)if(r){var l=e.util.isArray(r)?r[0]:r;"string"==typeof l&&(l=u.certificateFromPem(l));var f=e.md.sha1.create();f.update(o.toDer(u.certificateToAsn1(l)).getBytes()),s=f.digest().getBytes()}else s=e.random.getBytes(20);var p=[];null!==s&&p.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.localKeyId).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,s)])])),"friendlyName"in i&&p.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.friendlyName).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[o.create(o.Class.UNIVERSAL,o.Type.BMPSTRING,!1,i.friendlyName)])])),p.length>0&&(a=o.create(o.Class.UNIVERSAL,o.Type.SET,!0,p));var d=[],h=[];null!==r&&(h=e.util.isArray(r)?r:[r]);for(var y=[],g=0;g<h.length;++g){r=h[g],"string"==typeof r&&(r=u.certificateFromPem(r));var m=0===g?a:void 0,v=u.certificateToAsn1(r),C=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.certBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.x509Certificate).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(v).getBytes())])])]),m]);y.push(C)}if(y.length>0){var E=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,y),S=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(E).getBytes())])]);d.push(S)}var T=null;if(null!==t){var A=u.wrapRsaPrivateKey(u.privateKeyToAsn1(t));T=null===n?o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.keyBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[A]),a]):o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.pkcs8ShroudedKeyBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[u.encryptPrivateKeyInfo(A,n,i)]),a]);var b=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[T]),I=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(b).getBytes())])]);d.push(I)}var B,N=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,d);if(i.useMac){var f=e.md.sha1.create(),k=new e.util.ByteBuffer(e.random.getBytes(i.saltSize)),w=i.count,t=c.generateKey(n,k,3,w,20),R=e.hmac.create();R.start(f,t),R.update(o.toDer(N).getBytes());var L=R.getMac();B=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.sha1).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,L.getBytes())]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,k.getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(w).getBytes())])}return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(3).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(N).getBytes())])]),B])},c.generateKey=e.pbe.generatePkcs12Key}var n="pkcs12";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs12",["require","module","./asn1","./hmac","./oids","./pkcs7asn1","./pbe","./random","./rsa","./sha1","./util","./x509"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.asn1,r=e.pki=e.pki||{};r.pemToDer=function(t){var r=e.pem.decode(t)[0];if(r.procType&&"ENCRYPTED"===r.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return e.util.createBuffer(r.body)},r.privateKeyFromPem=function(n){var i=e.pem.decode(n)[0];if("PRIVATE KEY"!==i.type&&"RSA PRIVATE KEY"!==i.type){var a=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw a.headerType=i.type,a}if(i.procType&&"ENCRYPTED"===i.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var s=t.fromDer(i.body);return r.privateKeyFromAsn1(s)},r.privateKeyToPem=function(n,i){var a={type:"RSA PRIVATE KEY",body:t.toDer(r.privateKeyToAsn1(n)).getBytes()};return e.pem.encode(a,{maxline:i})},r.privateKeyInfoToPem=function(r,n){var i={type:"PRIVATE KEY",body:t.toDer(r).getBytes()};return e.pem.encode(i,{maxline:n})}}var n="pki";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pki",["require","module","./asn1","./oids","./pbe","./pem","./pbkdf2","./pkcs12","./pss","./rsa","./util","./x509"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=function(t,r,n,i){var a=e.util.createBuffer(),s=t.length>>1,o=s+(1&t.length),u=t.substr(0,o),c=t.substr(s,o),l=e.util.createBuffer(),f=e.hmac.create();n=r+n;var p=Math.ceil(i/16),d=Math.ceil(i/20);f.start("MD5",u);var h=e.util.createBuffer();l.putBytes(n);for(var y=0;p>y;++y)f.start(null,null),f.update(l.getBytes()),l.putBuffer(f.digest()),f.start(null,null),f.update(l.bytes()+n),h.putBuffer(f.digest());f.start("SHA1",c);var g=e.util.createBuffer();l.clear(),l.putBytes(n);for(var y=0;d>y;++y)f.start(null,null),f.update(l.getBytes()),l.putBuffer(f.digest()),f.start(null,null),f.update(l.bytes()+n),g.putBuffer(f.digest());return a.putBytes(e.util.xorBytes(h.getBytes(),g.getBytes(),i)),a},r=function(t,r,n){var i=e.hmac.create();i.start("SHA1",t);var a=e.util.createBuffer();return a.putInt32(r[0]),a.putInt32(r[1]),a.putByte(n.type),a.putByte(n.version.major),a.putByte(n.version.minor),a.putInt16(n.length),a.putBytes(n.fragment.bytes()),i.update(a.getBytes()),i.digest().getBytes()},n=function(t,r,n){var i=!1;try{var a=t.deflate(r.fragment.getBytes());r.fragment=e.util.createBuffer(a),r.length=a.length,i=!0}catch(s){}return i},i=function(t,r,n){var i=!1;try{var a=t.inflate(r.fragment.getBytes());r.fragment=e.util.createBuffer(a),r.length=a.length,i=!0}catch(s){}return i},a=function(t,r){var n=0;switch(r){case 1:n=t.getByte();break;case 2:n=t.getInt16();break;case 3:n=t.getInt24();break;case 4:n=t.getInt32()}return e.util.createBuffer(t.getBytes(n))},s=function(e,t,r){e.putInt(r.length(),t<<3),e.putBuffer(r)},o={};o.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},o.SupportedVersions=[o.Versions.TLS_1_1,o.Versions.TLS_1_0],o.Version=o.SupportedVersions[0],o.MaxFragment=15360,o.ConnectionEnd={server:0,client:1},o.PRFAlgorithm={tls_prf_sha256:0},o.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},o.CipherType={stream:0,block:1,aead:2},o.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},o.CompressionMethod={none:0,deflate:1},o.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},o.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},o.Alert={},o.Alert.Level={warning:1,fatal:2},o.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},o.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},o.CipherSuites={},o.getCipherSuite=function(e){var t=null;for(var r in o.CipherSuites){var n=o.CipherSuites[r];if(n.id[0]===e.charCodeAt(0)&&n.id[1]===e.charCodeAt(1)){t=n;break}}return t},o.handleUnexpected=function(e,t){var r=!e.open&&e.entity===o.ConnectionEnd.client;r||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unexpected_message}})},o.handleHelloRequest=function(e,t,r){!e.handshaking&&e.handshakes>0&&(o.queue(e,o.createAlert(e,{level:o.Alert.Level.warning,description:o.Alert.Description.no_renegotiation})),o.flush(e)),e.process()},o.parseHelloMessage=function(t,r,n){var i=null,s=t.entity===o.ConnectionEnd.client;if(38>n)t.error(t,{message:s?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});else{var u=r.fragment,c=u.length();if(i={version:{major:u.getByte(),minor:u.getByte()},random:e.util.createBuffer(u.getBytes(32)),session_id:a(u,1),extensions:[]},s?(i.cipher_suite=u.getBytes(2),i.compression_method=u.getByte()):(i.cipher_suites=a(u,2),i.compression_methods=a(u,1)),c=n-(c-u.length()),c>0){for(var l=a(u,2);l.length()>0;)i.extensions.push({type:[l.getByte(),l.getByte()],data:a(l,2)});if(!s)for(var f=0;f<i.extensions.length;++f){var p=i.extensions[f];if(0===p.type[0]&&0===p.type[1])for(var d=a(p.data,2);d.length()>0;){var h=d.getByte();if(0!==h)break;t.session.extensions.server_name.serverNameList.push(a(d,2).getBytes())}}}if(t.session.version&&(i.version.major!==t.session.version.major||i.version.minor!==t.session.version.minor))return t.error(t,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.protocol_version}});if(s)t.session.cipherSuite=o.getCipherSuite(i.cipher_suite);else for(var y=e.util.createBuffer(i.cipher_suites.bytes());y.length()>0&&(t.session.cipherSuite=o.getCipherSuite(y.getBytes(2)),null===t.session.cipherSuite););if(null===t.session.cipherSuite)return t.error(t,{message:"No cipher suites in common.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.handshake_failure},cipherSuite:e.util.bytesToHex(i.cipher_suite)});s?t.session.compressionMethod=i.compression_method:t.session.compressionMethod=o.CompressionMethod.none}return i},o.createSecurityParameters=function(e,t){var r=e.entity===o.ConnectionEnd.client,n=t.random.bytes(),i=r?e.session.sp.client_random:n,a=r?n:o.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:o.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,
pre_master_secret:null,master_secret:null,client_random:i,server_random:a}},o.handleServerHello=function(e,t,r){var n=o.parseHelloMessage(e,t,r);if(!e.fail){if(!(n.version.minor<=e.version.minor))return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.protocol_version}});e.version.minor=n.version.minor,e.session.version=e.version;var i=n.session_id.bytes();i.length>0&&i===e.session.id?(e.expect=d,e.session.resuming=!0,e.session.sp.server_random=n.random.bytes()):(e.expect=c,e.session.resuming=!1,o.createSecurityParameters(e,n)),e.session.id=i,e.process()}},o.handleClientHello=function(t,r,n){var i=o.parseHelloMessage(t,r,n);if(!t.fail){var a=i.session_id.bytes(),s=null;if(t.sessionCache&&(s=t.sessionCache.getSession(a),null===s?a="":(s.version.major!==i.version.major||s.version.minor>i.version.minor)&&(s=null,a="")),0===a.length&&(a=e.random.getBytes(32)),t.session.id=a,t.session.clientHelloVersion=i.version,t.session.sp={},s)t.version=t.session.version=s.version,t.session.sp=s.sp;else{for(var u,c=1;c<o.SupportedVersions.length&&(u=o.SupportedVersions[c],!(u.minor<=i.version.minor));++c);t.version={major:u.major,minor:u.minor},t.session.version=t.version}null!==s?(t.expect=S,t.session.resuming=!0,t.session.sp.client_random=i.random.bytes()):(t.expect=t.verifyClient!==!1?v:C,t.session.resuming=!1,o.createSecurityParameters(t,i)),t.open=!0,o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createServerHello(t)})),t.session.resuming?(o.queue(t,o.createRecord(t,{type:o.ContentType.change_cipher_spec,data:o.createChangeCipherSpec()})),t.state.pending=o.createConnectionState(t),t.state.current.write=t.state.pending.write,o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createFinished(t)}))):(o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createCertificate(t)})),t.fail||(o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createServerKeyExchange(t)})),t.verifyClient!==!1&&o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createCertificateRequest(t)})),o.queue(t,o.createRecord(t,{type:o.ContentType.handshake,data:o.createServerHelloDone(t)})))),o.flush(t),t.process()}},o.handleCertificate=function(t,r,n){if(3>n)return t.error(t,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});var i,s,u=r.fragment,c={certificate_list:a(u,3)},f=[];try{for(;c.certificate_list.length()>0;)i=a(c.certificate_list,3),s=e.asn1.fromDer(i),i=e.pki.certificateFromAsn1(s,!0),f.push(i)}catch(p){return t.error(t,{message:"Could not parse certificate list.",cause:p,send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.bad_certificate}})}var d=t.entity===o.ConnectionEnd.client;!d&&t.verifyClient!==!0||0!==f.length?0===f.length?t.expect=d?l:C:(d?t.session.serverCertificate=f[0]:t.session.clientCertificate=f[0],o.verifyCertificateChain(t,f)&&(t.expect=d?l:C)):t.error(t,{message:d?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}}),t.process()},o.handleServerKeyExchange=function(e,t,r){return r>0?e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unsupported_certificate}}):(e.expect=f,void e.process())},o.handleClientKeyExchange=function(t,r,n){if(48>n)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unsupported_certificate}});var i=r.fragment,s={enc_pre_master_secret:a(i,2).getBytes()},u=null;if(t.getPrivateKey)try{u=t.getPrivateKey(t,t.session.serverCertificate),u=e.pki.privateKeyFromPem(u)}catch(c){t.error(t,{message:"Could not get private key.",cause:c,send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}})}if(null===u)return t.error(t,{message:"No private key set.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}});try{var l=t.session.sp;l.pre_master_secret=u.decrypt(s.enc_pre_master_secret);var f=t.session.clientHelloVersion;if(f.major!==l.pre_master_secret.charCodeAt(0)||f.minor!==l.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(c){l.pre_master_secret=e.random.getBytes(48)}t.expect=S,null!==t.session.clientCertificate&&(t.expect=E),t.process()},o.handleCertificateRequest=function(e,t,r){if(3>r)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});var n=t.fragment,i={certificate_types:a(n,1),certificate_authorities:a(n,2)};e.session.certificateRequest=i,e.expect=p,e.process()},o.handleCertificateVerify=function(t,r,n){if(2>n)return t.error(t,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});var i=r.fragment;i.read-=4;var s=i.bytes();i.read+=4;var u={signature:a(i,2).getBytes()},c=e.util.createBuffer();c.putBuffer(t.session.md5.digest()),c.putBuffer(t.session.sha1.digest()),c=c.getBytes();try{var l=t.session.clientCertificate;if(!l.publicKey.verify(c,u.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");t.session.md5.update(s),t.session.sha1.update(s)}catch(f){return t.error(t,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.handshake_failure}})}t.expect=S,t.process()},o.handleServerHelloDone=function(t,r,n){if(n>0)return t.error(t,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.record_overflow}});if(null===t.serverCertificate){var i={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.insufficient_security}},a=0,s=t.verify(t,i.alert.description,a,[]);if(s!==!0)return(s||0===s)&&("object"!=typeof s||e.util.isArray(s)?"number"==typeof s&&(i.alert.description=s):(s.message&&(i.message=s.message),s.alert&&(i.alert.description=s.alert))),t.error(t,i)}null!==t.session.certificateRequest&&(r=o.createRecord(t,{type:o.ContentType.handshake,data:o.createCertificate(t)}),o.queue(t,r)),r=o.createRecord(t,{type:o.ContentType.handshake,data:o.createClientKeyExchange(t)}),o.queue(t,r),t.expect=g;var u=function(e,t){null!==e.session.certificateRequest&&null!==e.session.clientCertificate&&o.queue(e,o.createRecord(e,{type:o.ContentType.handshake,data:o.createCertificateVerify(e,t)})),o.queue(e,o.createRecord(e,{type:o.ContentType.change_cipher_spec,data:o.createChangeCipherSpec()})),e.state.pending=o.createConnectionState(e),e.state.current.write=e.state.pending.write,o.queue(e,o.createRecord(e,{type:o.ContentType.handshake,data:o.createFinished(e)})),e.expect=d,o.flush(e),e.process()};return null===t.session.certificateRequest||null===t.session.clientCertificate?u(t,null):void o.getClientSignature(t,u)},o.handleChangeCipherSpec=function(e,t){if(1!==t.fragment.getByte())return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});var r=e.entity===o.ConnectionEnd.client;(e.session.resuming&&r||!e.session.resuming&&!r)&&(e.state.pending=o.createConnectionState(e)),e.state.current.read=e.state.pending.read,(!e.session.resuming&&r||e.session.resuming&&!r)&&(e.state.pending=null),e.expect=r?h:T,e.process()},o.handleFinished=function(r,n,i){var a=n.fragment;a.read-=4;var s=a.bytes();a.read+=4;var u=n.fragment.getBytes();a=e.util.createBuffer(),a.putBuffer(r.session.md5.digest()),a.putBuffer(r.session.sha1.digest());var c=r.entity===o.ConnectionEnd.client,l=c?"server finished":"client finished",f=r.session.sp,p=12,d=t;return a=d(f.master_secret,l,a.getBytes(),p),a.getBytes()!==u?r.error(r,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.decrypt_error}}):(r.session.md5.update(s),r.session.sha1.update(s),(r.session.resuming&&c||!r.session.resuming&&!c)&&(o.queue(r,o.createRecord(r,{type:o.ContentType.change_cipher_spec,data:o.createChangeCipherSpec()})),r.state.current.write=r.state.pending.write,r.state.pending=null,o.queue(r,o.createRecord(r,{type:o.ContentType.handshake,data:o.createFinished(r)}))),r.expect=c?y:A,r.handshaking=!1,++r.handshakes,r.peerCertificate=c?r.session.serverCertificate:r.session.clientCertificate,o.flush(r),r.isConnected=!0,r.connected(r),void r.process())},o.handleAlert=function(e,t){var r,n=t.fragment,i={level:n.getByte(),description:n.getByte()};switch(i.description){case o.Alert.Description.close_notify:r="Connection closed.";break;case o.Alert.Description.unexpected_message:r="Unexpected message.";break;case o.Alert.Description.bad_record_mac:r="Bad record MAC.";break;case o.Alert.Description.decryption_failed:r="Decryption failed.";break;case o.Alert.Description.record_overflow:r="Record overflow.";break;case o.Alert.Description.decompression_failure:r="Decompression failed.";break;case o.Alert.Description.handshake_failure:r="Handshake failure.";break;case o.Alert.Description.bad_certificate:r="Bad certificate.";break;case o.Alert.Description.unsupported_certificate:r="Unsupported certificate.";break;case o.Alert.Description.certificate_revoked:r="Certificate revoked.";break;case o.Alert.Description.certificate_expired:r="Certificate expired.";break;case o.Alert.Description.certificate_unknown:r="Certificate unknown.";break;case o.Alert.Description.illegal_parameter:r="Illegal parameter.";break;case o.Alert.Description.unknown_ca:r="Unknown certificate authority.";break;case o.Alert.Description.access_denied:r="Access denied.";break;case o.Alert.Description.decode_error:r="Decode error.";break;case o.Alert.Description.decrypt_error:r="Decrypt error.";break;case o.Alert.Description.export_restriction:r="Export restriction.";break;case o.Alert.Description.protocol_version:r="Unsupported protocol version.";break;case o.Alert.Description.insufficient_security:r="Insufficient security.";break;case o.Alert.Description.internal_error:r="Internal error.";break;case o.Alert.Description.user_canceled:r="User canceled.";break;case o.Alert.Description.no_renegotiation:r="Renegotiation not supported.";break;default:r="Unknown error."}return i.description===o.Alert.Description.close_notify?e.close():(e.error(e,{message:r,send:!1,origin:e.entity===o.ConnectionEnd.client?"server":"client",alert:i}),void e.process())},o.handleHandshake=function(t,r){var n=r.fragment,i=n.getByte(),a=n.getInt24();if(a>n.length())return t.fragmented=r,r.fragment=e.util.createBuffer(),n.read-=4,t.process();t.fragmented=null,n.read-=4;var s=n.bytes(a+4);n.read+=4,i in V[t.entity][t.expect]?(t.entity!==o.ConnectionEnd.server||t.open||t.fail||(t.handshaking=!0,t.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:e.md.md5.create(),sha1:e.md.sha1.create()}),i!==o.HandshakeType.hello_request&&i!==o.HandshakeType.certificate_verify&&i!==o.HandshakeType.finished&&(t.session.md5.update(s),t.session.sha1.update(s)),V[t.entity][t.expect][i](t,r,a)):o.handleUnexpected(t,r)},o.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()},o.handleHeartbeat=function(t,r){var n=r.fragment,i=n.getByte(),a=n.getInt16(),s=n.getBytes(a);if(i===o.HeartbeatMessageType.heartbeat_request){if(t.handshaking||a>s.length)return t.process();o.queue(t,o.createRecord(t,{type:o.ContentType.heartbeat,data:o.createHeartbeat(o.HeartbeatMessageType.heartbeat_response,s)})),o.flush(t)}else if(i===o.HeartbeatMessageType.heartbeat_response){if(s!==t.expectedHeartbeatPayload)return t.process();t.heartbeatReceived&&t.heartbeatReceived(t,e.util.createBuffer(s))}t.process()};var u=0,c=1,l=2,f=3,p=4,d=5,h=6,y=7,g=8,m=0,v=1,C=2,E=3,S=4,T=5,A=6,b=o.handleUnexpected,I=o.handleChangeCipherSpec,B=o.handleAlert,N=o.handleHandshake,k=o.handleApplicationData,w=o.handleHeartbeat,R=[];R[o.ConnectionEnd.client]=[[b,B,N,b,w],[b,B,N,b,w],[b,B,N,b,w],[b,B,N,b,w],[b,B,N,b,w],[I,B,b,b,w],[b,B,N,b,w],[b,B,N,k,w],[b,B,N,b,w]],R[o.ConnectionEnd.server]=[[b,B,N,b,w],[b,B,N,b,w],[b,B,N,b,w],[b,B,N,b,w],[I,B,b,b,w],[b,B,N,b,w],[b,B,N,k,w],[b,B,N,b,w]];var L=o.handleHelloRequest,_=o.handleServerHello,D=o.handleCertificate,U=o.handleServerKeyExchange,P=o.handleCertificateRequest,x=o.handleServerHelloDone,O=o.handleFinished,V=[];V[o.ConnectionEnd.client]=[[b,b,_,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,D,U,P,x,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,b,U,P,x,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,b,b,P,x,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,b,b,b,x,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,O],[L,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b]];var K=o.handleClientHello,j=o.handleClientKeyExchange,M=o.handleCertificateVerify;V[o.ConnectionEnd.server]=[[b,K,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,D,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,j,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,M,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,O],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b]],o.generateKeys=function(e,r){var n=t,i=r.client_random+r.server_random;e.session.resuming||(r.master_secret=n(r.pre_master_secret,"master secret",i,48).bytes(),r.pre_master_secret=null),i=r.server_random+r.client_random;var a=2*r.mac_key_length+2*r.enc_key_length,s=e.version.major===o.Versions.TLS_1_0.major&&e.version.minor===o.Versions.TLS_1_0.minor;s&&(a+=2*r.fixed_iv_length);var u=n(r.master_secret,"key expansion",i,a),c={client_write_MAC_key:u.getBytes(r.mac_key_length),server_write_MAC_key:u.getBytes(r.mac_key_length),client_write_key:u.getBytes(r.enc_key_length),server_write_key:u.getBytes(r.enc_key_length)};return s&&(c.client_write_IV=u.getBytes(r.fixed_iv_length),c.server_write_IV=u.getBytes(r.fixed_iv_length)),c},o.createConnectionState=function(e){var t=e.entity===o.ConnectionEnd.client,r=function(){var e={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(e){return!0},compressionState:null,compressFunction:function(e){return!0},updateSequenceNumber:function(){4294967295===e.sequenceNumber[1]?(e.sequenceNumber[1]=0,++e.sequenceNumber[0]):++e.sequenceNumber[1]}};return e},a={read:r(),write:r()};if(a.read.update=function(e,t){return a.read.cipherFunction(t,a.read)?a.read.compressFunction(e,t,a.read)||e.error(e,{message:"Could not decompress record.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.decompression_failure}}):e.error(e,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.bad_record_mac}}),!e.fail},a.write.update=function(e,t){return a.write.compressFunction(e,t,a.write)?a.write.cipherFunction(t,a.write)||e.error(e,{message:"Could not encrypt record.",send:!1,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}}):e.error(e,{message:"Could not compress record.",send:!1,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}}),!e.fail},e.session){var s=e.session.sp;switch(e.session.cipherSuite.initSecurityParameters(s),s.keys=o.generateKeys(e,s),a.read.macKey=t?s.keys.server_write_MAC_key:s.keys.client_write_MAC_key,a.write.macKey=t?s.keys.client_write_MAC_key:s.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(a,e,s),s.compression_algorithm){case o.CompressionMethod.none:break;case o.CompressionMethod.deflate:a.read.compressFunction=i,a.write.compressFunction=n;break;default:throw new Error("Unsupported compression algorithm.")}}return a},o.createRandom=function(){var t=new Date,r=+t+6e4*t.getTimezoneOffset(),n=e.util.createBuffer();return n.putInt32(r),n.putBytes(e.random.getBytes(28)),n},o.createRecord=function(e,t){if(!t.data)return null;var r={type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data};return r},o.createAlert=function(t,r){var n=e.util.createBuffer();return n.putByte(r.level),n.putByte(r.description),o.createRecord(t,{type:o.ContentType.alert,data:n})},o.createClientHello=function(t){t.session.clientHelloVersion={major:t.version.major,minor:t.version.minor};for(var r=e.util.createBuffer(),n=0;n<t.cipherSuites.length;++n){var i=t.cipherSuites[n];r.putByte(i.id[0]),r.putByte(i.id[1])}var a=r.length(),u=e.util.createBuffer();u.putByte(o.CompressionMethod.none);var c=u.length(),l=e.util.createBuffer();if(t.virtualHost){var f=e.util.createBuffer();f.putByte(0),f.putByte(0);var p=e.util.createBuffer();p.putByte(0),s(p,2,e.util.createBuffer(t.virtualHost));var d=e.util.createBuffer();s(d,2,p),s(f,2,d),l.putBuffer(f)}var h=l.length();h>0&&(h+=2);var y=t.session.id,g=y.length+1+2+4+28+2+a+1+c+h,m=e.util.createBuffer();return m.putByte(o.HandshakeType.client_hello),m.putInt24(g),m.putByte(t.version.major),m.putByte(t.version.minor),m.putBytes(t.session.sp.client_random),s(m,1,e.util.createBuffer(y)),s(m,2,r),s(m,1,u),h>0&&s(m,2,l),m},o.createServerHello=function(t){var r=t.session.id,n=r.length+1+2+4+28+2+1,i=e.util.createBuffer();return i.putByte(o.HandshakeType.server_hello),i.putInt24(n),i.putByte(t.version.major),i.putByte(t.version.minor),i.putBytes(t.session.sp.server_random),s(i,1,e.util.createBuffer(r)),i.putByte(t.session.cipherSuite.id[0]),i.putByte(t.session.cipherSuite.id[1]),i.putByte(t.session.compressionMethod),i},o.createCertificate=function(t){var r=t.entity===o.ConnectionEnd.client,n=null;if(t.getCertificate){var i;i=r?t.session.certificateRequest:t.session.extensions.server_name.serverNameList,n=t.getCertificate(t,i)}var a=e.util.createBuffer();if(null!==n)try{e.util.isArray(n)||(n=[n]);for(var u=null,c=0;c<n.length;++c){var l=e.pem.decode(n[c])[0];if("CERTIFICATE"!==l.type&&"X509 CERTIFICATE"!==l.type&&"TRUSTED CERTIFICATE"!==l.type){var f=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw f.headerType=l.type,f}if(l.procType&&"ENCRYPTED"===l.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var p=e.util.createBuffer(l.body);null===u&&(u=e.asn1.fromDer(p.bytes(),!1));var d=e.util.createBuffer();s(d,3,p),a.putBuffer(d)}n=e.pki.certificateFromAsn1(u),r?t.session.clientCertificate=n:t.session.serverCertificate=n}catch(h){return t.error(t,{message:"Could not send certificate list.",cause:h,send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.bad_certificate}})}var y=3+a.length(),g=e.util.createBuffer();return g.putByte(o.HandshakeType.certificate),g.putInt24(y),s(g,3,a),g},o.createClientKeyExchange=function(t){var r=e.util.createBuffer();r.putByte(t.session.clientHelloVersion.major),r.putByte(t.session.clientHelloVersion.minor),r.putBytes(e.random.getBytes(46));var n=t.session.sp;n.pre_master_secret=r.getBytes();var i=t.session.serverCertificate.publicKey;r=i.encrypt(n.pre_master_secret);var a=r.length+2,s=e.util.createBuffer();return s.putByte(o.HandshakeType.client_key_exchange),s.putInt24(a),s.putInt16(r.length),s.putBytes(r),s},o.createServerKeyExchange=function(t){var r=0,n=e.util.createBuffer();return r>0&&(n.putByte(o.HandshakeType.server_key_exchange),n.putInt24(r)),n},o.getClientSignature=function(t,r){var n=e.util.createBuffer();n.putBuffer(t.session.md5.digest()),n.putBuffer(t.session.sha1.digest()),n=n.getBytes(),t.getSignature=t.getSignature||function(t,r,n){var i=null;if(t.getPrivateKey)try{i=t.getPrivateKey(t,t.session.clientCertificate),i=e.pki.privateKeyFromPem(i)}catch(a){t.error(t,{message:"Could not get private key.",cause:a,send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}})}null===i?t.error(t,{message:"No private key set.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}}):r=i.sign(r,null),n(t,r)},t.getSignature(t,n,r)},o.createCertificateVerify=function(t,r){var n=r.length+2,i=e.util.createBuffer();return i.putByte(o.HandshakeType.certificate_verify),i.putInt24(n),i.putInt16(r.length),i.putBytes(r),i},o.createCertificateRequest=function(t){var r=e.util.createBuffer();r.putByte(1);var n=e.util.createBuffer();for(var i in t.caStore.certs){var a=t.caStore.certs[i],u=e.pki.distinguishedNameToAsn1(a.subject);n.putBuffer(e.asn1.toDer(u))}var c=1+r.length()+2+n.length(),l=e.util.createBuffer();return l.putByte(o.HandshakeType.certificate_request),l.putInt24(c),s(l,1,r),s(l,2,n),l},o.createServerHelloDone=function(t){var r=e.util.createBuffer();return r.putByte(o.HandshakeType.server_hello_done),r.putInt24(0),r},o.createChangeCipherSpec=function(){var t=e.util.createBuffer();return t.putByte(1),t},o.createFinished=function(r){var n=e.util.createBuffer();n.putBuffer(r.session.md5.digest()),n.putBuffer(r.session.sha1.digest());var i=r.entity===o.ConnectionEnd.client,a=r.session.sp,s=12,u=t,c=i?"client finished":"server finished";n=u(a.master_secret,c,n.getBytes(),s);var l=e.util.createBuffer();return l.putByte(o.HandshakeType.finished),l.putInt24(n.length()),l.putBuffer(n),l},o.createHeartbeat=function(t,r,n){"undefined"==typeof n&&(n=r.length);var i=e.util.createBuffer();i.putByte(t),i.putInt16(n),i.putBytes(r);var a=i.length(),s=Math.max(16,a-n-3);return i.putBytes(e.random.getBytes(s)),i},o.queue=function(t,r){if(r){if(r.type===o.ContentType.handshake){var n=r.fragment.bytes();t.session.md5.update(n),t.session.sha1.update(n),n=null}var i;if(r.fragment.length()<=o.MaxFragment)i=[r];else{i=[];for(var a=r.fragment.bytes();a.length>o.MaxFragment;)i.push(o.createRecord(t,{type:r.type,data:e.util.createBuffer(a.slice(0,o.MaxFragment))})),a=a.slice(o.MaxFragment);a.length>0&&i.push(o.createRecord(t,{type:r.type,data:e.util.createBuffer(a)}))}for(var s=0;s<i.length&&!t.fail;++s){var u=i[s],c=t.state.current.write;c.update(t,u)&&t.records.push(u)}}},o.flush=function(e){for(var t=0;t<e.records.length;++t){var r=e.records[t];e.tlsData.putByte(r.type),e.tlsData.putByte(r.version.major),e.tlsData.putByte(r.version.minor),e.tlsData.putInt16(r.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var q=function(t){switch(t){case!0:return!0;case e.pki.certificateError.bad_certificate:return o.Alert.Description.bad_certificate;case e.pki.certificateError.unsupported_certificate:return o.Alert.Description.unsupported_certificate;case e.pki.certificateError.certificate_revoked:return o.Alert.Description.certificate_revoked;case e.pki.certificateError.certificate_expired:return o.Alert.Description.certificate_expired;case e.pki.certificateError.certificate_unknown:return o.Alert.Description.certificate_unknown;case e.pki.certificateError.unknown_ca:return o.Alert.Description.unknown_ca;default:return o.Alert.Description.bad_certificate}},F=function(t){switch(t){case!0:return!0;case o.Alert.Description.bad_certificate:return e.pki.certificateError.bad_certificate;case o.Alert.Description.unsupported_certificate:return e.pki.certificateError.unsupported_certificate;case o.Alert.Description.certificate_revoked:return e.pki.certificateError.certificate_revoked;case o.Alert.Description.certificate_expired:return e.pki.certificateError.certificate_expired;case o.Alert.Description.certificate_unknown:return e.pki.certificateError.certificate_unknown;case o.Alert.Description.unknown_ca:return e.pki.certificateError.unknown_ca;default:return e.pki.certificateError.bad_certificate}};o.verifyCertificateChain=function(t,r){try{e.pki.verifyCertificateChain(t.caStore,r,function(r,n,i){var a=(q(r),t.verify(t,r,n,i));if(a!==!0){if("object"==typeof a&&!e.util.isArray(a)){var s=new Error("The application rejected the certificate.");throw s.send=!0,s.alert={level:o.Alert.Level.fatal,description:o.Alert.Description.bad_certificate},a.message&&(s.message=a.message),a.alert&&(s.alert.description=a.alert),s}a!==r&&(a=F(a))}return a})}catch(n){var i=n;("object"!=typeof i||e.util.isArray(i))&&(i={send:!0,alert:{level:o.Alert.Level.fatal,description:q(n)}}),"send"in i||(i.send=!0),"alert"in i||(i.alert={level:o.Alert.Level.fatal,description:q(i.error)}),t.error(t,i)}return!t.fail},o.createSessionCache=function(t,r){var n=null;if(t&&t.getSession&&t.setSession&&t.order)n=t;else{n={},n.cache=t||{},n.capacity=Math.max(r||100,1),n.order=[];for(var i in t)n.order.length<=r?n.order.push(i):delete t[i];n.getSession=function(t){var r=null,i=null;if(t?i=e.util.bytesToHex(t):n.order.length>0&&(i=n.order[0]),null!==i&&i in n.cache){r=n.cache[i],delete n.cache[i];for(var a in n.order)if(n.order[a]===i){n.order.splice(a,1);break}}return r},n.setSession=function(t,r){if(n.order.length===n.capacity){var i=n.order.shift();delete n.cache[i]}var i=e.util.bytesToHex(t);n.order.push(i),n.cache[i]=r}}return n},o.createConnection=function(t){var r=null;r=t.caStore?e.util.isArray(t.caStore)?e.pki.createCaStore(t.caStore):t.caStore:e.pki.createCaStore();var n=t.cipherSuites||null;if(null===n){n=[];for(var i in o.CipherSuites)n.push(o.CipherSuites[i])}var a=t.server?o.ConnectionEnd.server:o.ConnectionEnd.client,s=t.sessionCache?o.createSessionCache(t.sessionCache):null,c={version:{major:o.Version.major,minor:o.Version.minor},entity:a,sessionId:t.sessionId,caStore:r,sessionCache:s,cipherSuites:n,connected:t.connected,virtualHost:t.virtualHost||null,verifyClient:t.verifyClient||!1,verify:t.verify||function(e,t,r,n){return t},getCertificate:t.getCertificate||null,getPrivateKey:t.getPrivateKey||null,getSignature:t.getSignature||null,input:e.util.createBuffer(),tlsData:e.util.createBuffer(),data:e.util.createBuffer(),tlsDataReady:t.tlsDataReady,dataReady:t.dataReady,heartbeatReceived:t.heartbeatReceived,closed:t.closed,error:function(e,r){r.origin=r.origin||(e.entity===o.ConnectionEnd.client?"client":"server"),r.send&&(o.queue(e,o.createAlert(e,r.alert)),o.flush(e));var n=r.fatal!==!1;n&&(e.fail=!0),t.error(e,r),n&&e.close(!1)},deflate:t.deflate||null,inflate:t.inflate||null};c.reset=function(e){c.version={major:o.Version.major,minor:o.Version.minor},c.record=null,c.session=null,c.peerCertificate=null,c.state={pending:null,current:null},c.expect=c.entity===o.ConnectionEnd.client?u:m,c.fragmented=null,c.records=[],c.open=!1,c.handshakes=0,c.handshaking=!1,c.isConnected=!1,c.fail=!(e||"undefined"==typeof e),c.input.clear(),c.tlsData.clear(),c.data.clear(),c.state.current=o.createConnectionState(c)},c.reset();var l=function(e,t){var r=t.type-o.ContentType.change_cipher_spec,n=R[e.entity][e.expect];r in n?n[r](e,t):o.handleUnexpected(e,t)},f=function(t){var r=0,n=t.input,i=n.length();if(5>i)r=5-i;else{t.record={type:n.getByte(),version:{major:n.getByte(),minor:n.getByte()},length:n.getInt16(),fragment:e.util.createBuffer(),ready:!1};var a=t.record.version.major===t.version.major;a&&t.session&&t.session.version&&(a=t.record.version.minor===t.version.minor),a||t.error(t,{message:"Incompatible TLS version.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.protocol_version}})}return r},p=function(e){var t=0,r=e.input,n=r.length();if(n<e.record.length)t=e.record.length-n;else{e.record.fragment.putBytes(r.getBytes(e.record.length)),r.compact();var i=e.state.current.read;i.update(e,e.record)&&(null!==e.fragmented&&(e.fragmented.type===e.record.type?(e.fragmented.fragment.putBuffer(e.record.fragment),e.record=e.fragmented):e.error(e,{message:"Invalid fragmented record.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unexpected_message}})),e.record.ready=!0)}return t};return c.handshake=function(t){if(c.entity!==o.ConnectionEnd.client)c.error(c,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(c.handshaking)c.error(c,{message:"Handshake already in progress.",fatal:!1});else{c.fail&&!c.open&&0===c.handshakes&&(c.fail=!1),c.handshaking=!0,t=t||"";var r=null;t.length>0&&(c.sessionCache&&(r=c.sessionCache.getSession(t)),null===r&&(t="")),0===t.length&&c.sessionCache&&(r=c.sessionCache.getSession(),null!==r&&(t=r.id)),c.session={id:t,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:e.md.md5.create(),sha1:e.md.sha1.create()},r&&(c.version=r.version,c.session.sp=r.sp),c.session.sp.client_random=o.createRandom().getBytes(),c.open=!0,o.queue(c,o.createRecord(c,{type:o.ContentType.handshake,data:o.createClientHello(c)})),o.flush(c)}},c.process=function(e){var t=0;return e&&c.input.putBytes(e),c.fail||(null!==c.record&&c.record.ready&&c.record.fragment.isEmpty()&&(c.record=null),null===c.record&&(t=f(c)),c.fail||null===c.record||c.record.ready||(t=p(c)),!c.fail&&null!==c.record&&c.record.ready&&l(c,c.record)),t},c.prepare=function(t){return o.queue(c,o.createRecord(c,{type:o.ContentType.application_data,data:e.util.createBuffer(t)})),o.flush(c)},c.prepareHeartbeatRequest=function(t,r){return t instanceof e.util.ByteBuffer&&(t=t.bytes()),"undefined"==typeof r&&(r=t.length),c.expectedHeartbeatPayload=t,o.queue(c,o.createRecord(c,{type:o.ContentType.heartbeat,data:o.createHeartbeat(o.HeartbeatMessageType.heartbeat_request,t,r)})),o.flush(c)},c.close=function(e){if(!c.fail&&c.sessionCache&&c.session){var t={id:c.session.id,version:c.session.version,sp:c.session.sp};t.sp.keys=null,c.sessionCache.setSession(t.id,t)}c.open&&(c.open=!1,c.input.clear(),(c.isConnected||c.handshaking)&&(c.isConnected=c.handshaking=!1,o.queue(c,o.createAlert(c,{level:o.Alert.Level.warning,description:o.Alert.Description.close_notify})),o.flush(c)),c.closed(c)),c.reset(e)},c},e.tls=e.tls||{};for(var H in o)"function"!=typeof o[H]&&(e.tls[H]=o[H]);e.tls.prf_tls1=t,e.tls.hmac_sha1=r,e.tls.createSessionCache=o.createSessionCache,e.tls.createConnection=o.createConnection}var n="tls";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/tls",["require","module","./asn1","./hmac","./md","./pem","./pki","./random","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,n,i){var s=n.entity===e.tls.ConnectionEnd.client;t.read.cipherState={init:!1,cipher:e.cipher.createDecipher("AES-CBC",s?i.keys.server_write_key:i.keys.client_write_key),iv:s?i.keys.server_write_IV:i.keys.client_write_IV},t.write.cipherState={init:!1,cipher:e.cipher.createCipher("AES-CBC",s?i.keys.client_write_key:i.keys.server_write_key),iv:s?i.keys.client_write_IV:i.keys.server_write_IV},t.read.cipherFunction=a,t.write.cipherFunction=r,t.read.macLength=t.write.macLength=i.mac_length,t.read.macFunction=t.write.macFunction=o.hmac_sha1}function r(t,r){var i=!1,a=r.macFunction(r.macKey,r.sequenceNumber,t);t.fragment.putBytes(a),r.updateSequenceNumber();var s;s=t.version.minor===o.Versions.TLS_1_0.minor?r.cipherState.init?null:r.cipherState.iv:e.random.getBytesSync(16),r.cipherState.init=!0;var u=r.cipherState.cipher;return u.start({iv:s}),t.version.minor>=o.Versions.TLS_1_1.minor&&u.output.putBytes(s),u.update(t.fragment),
u.finish(n)&&(t.fragment=u.output,t.length=t.fragment.length(),i=!0),i}function n(e,t,r){if(!r){var n=e-t.length()%e;t.fillWithByte(n-1,n)}return!0}function i(e,t,r){var n=!0;if(r){for(var i=t.length(),a=t.last(),s=i-1-a;i-1>s;++s)n=n&&t.at(s)==a;n&&t.truncate(a+1)}return n}function a(t,r){var n=!1;++u;var a;a=t.version.minor===o.Versions.TLS_1_0.minor?r.cipherState.init?null:r.cipherState.iv:t.fragment.getBytes(16),r.cipherState.init=!0;var c=r.cipherState.cipher;c.start({iv:a}),c.update(t.fragment),n=c.finish(i);var l=r.macLength,f=e.random.getBytesSync(l),p=c.output.length();p>=l?(t.fragment=c.output.getBytes(p-l),f=c.output.getBytes(l)):t.fragment=c.output.getBytes(),t.fragment=e.util.createBuffer(t.fragment),t.length=t.fragment.length();var d=r.macFunction(r.macKey,r.sequenceNumber,t);return r.updateSequenceNumber(),n=s(r.macKey,f,d)&&n}function s(t,r,n){var i=e.hmac.create();return i.start("SHA1",t),i.update(r),r=i.digest().getBytes(),i.start(null,null),i.update(n),n=i.digest().getBytes(),r===n}var o=e.tls;o.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=o.BulkCipherAlgorithm.aes,e.cipher_type=o.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=o.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:t},o.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=o.BulkCipherAlgorithm.aes,e.cipher_type=o.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=o.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:t};var u=0}var n="aesCipherSuites";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/aesCipherSuites",["require","module","./aes","./tls"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.debug=e.debug||{},e.debug.storage={},e.debug.get=function(t,r){var n;return"undefined"==typeof t?n=e.debug.storage:t in e.debug.storage&&(n="undefined"==typeof r?e.debug.storage[t]:e.debug.storage[t][r]),n},e.debug.set=function(t,r,n){t in e.debug.storage||(e.debug.storage[t]={}),e.debug.storage[t][r]=n},e.debug.clear=function(t,r){"undefined"==typeof t?e.debug.storage={}:t in e.debug.storage&&("undefined"==typeof r?delete e.debug.storage[t]:delete e.debug.storage[t][r])}}var n="debug";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/debug",["require","module"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,r,n,i){t.generate=function(t,a){for(var s=new e.util.ByteBuffer,o=Math.ceil(a/i)+n,u=new e.util.ByteBuffer,c=n;o>c;++c){u.putInt32(c),r.start(),r.update(t+u.getBytes());var l=r.digest();s.putBytes(l.getBytes(i))}return s.truncate(s.length()-a),s.getBytes()}}e.kem=e.kem||{};var r=e.jsbn.BigInteger;e.kem.rsa={},e.kem.rsa.create=function(t,n){n=n||{};var i=n.prng||e.random,a={};return a.encrypt=function(n,a){var s,o=Math.ceil(n.n.bitLength()/8);do s=new r(e.util.bytesToHex(i.getBytesSync(o)),16).mod(n.n);while(s.equals(r.ZERO));s=e.util.hexToBytes(s.toString(16));var u=o-s.length;u>0&&(s=e.util.fillString(String.fromCharCode(0),u)+s);var c=n.encrypt(s,"NONE"),l=t.generate(s,a);return{encapsulation:c,key:l}},a.decrypt=function(e,r,n){var i=e.decrypt(r,"NONE");return t.generate(i,n)},a},e.kem.kdf1=function(e,r){t(this,e,0,r||e.digestLength)},e.kem.kdf2=function(e,r){t(this,e,1,r||e.digestLength)}}var n="kem";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/kem",["require","module","./util","./random","./jsbn"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.log=e.log||{},e.log.levels=["none","error","warning","info","debug","verbose","max"];var t={},r=[],n=null;e.log.LEVEL_LOCKED=2,e.log.NO_LEVEL_CHECK=4,e.log.INTERPOLATE=8;for(var i=0;i<e.log.levels.length;++i){var a=e.log.levels[i];t[a]={index:i,name:a.toUpperCase()}}e.log.logMessage=function(n){for(var i=t[n.level].index,a=0;a<r.length;++a){var s=r[a];if(s.flags&e.log.NO_LEVEL_CHECK)s.f(n);else{var o=t[s.level].index;o>=i&&s.f(s,n)}}},e.log.prepareStandard=function(e){"standard"in e||(e.standard=t[e.level].name+" ["+e.category+"] "+e.message)},e.log.prepareFull=function(t){if(!("full"in t)){var r=[t.message];r=r.concat([]||t.arguments),t.full=e.util.format.apply(this,r)}},e.log.prepareStandardFull=function(t){"standardFull"in t||(e.log.prepareStandard(t),t.standardFull=t.standard)};for(var s=["error","warning","info","debug","verbose"],i=0;i<s.length;++i)!function(t){e.log[t]=function(r,n){var i=Array.prototype.slice.call(arguments).slice(2),a={timestamp:new Date,level:t,category:r,message:n,arguments:i};e.log.logMessage(a)}}(s[i]);if(e.log.makeLogger=function(t){var r={flags:0,f:t};return e.log.setLevel(r,"none"),r},e.log.setLevel=function(t,r){var n=!1;if(t&&!(t.flags&e.log.LEVEL_LOCKED))for(var i=0;i<e.log.levels.length;++i){var a=e.log.levels[i];if(r==a){t.level=r,n=!0;break}}return n},e.log.lock=function(t,r){"undefined"==typeof r||r?t.flags|=e.log.LEVEL_LOCKED:t.flags&=~e.log.LEVEL_LOCKED},e.log.addLogger=function(e){r.push(e)},"undefined"!=typeof console&&"log"in console){var o;if(console.error&&console.warn&&console.info&&console.debug){var u={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},c=function(t,r){e.log.prepareStandard(r);var n=u[r.level],i=[r.standard];i=i.concat(r.arguments.slice()),n.apply(console,i)};o=e.log.makeLogger(c)}else{var c=function(t,r){e.log.prepareStandardFull(r),console.log(r.standardFull)};o=e.log.makeLogger(c)}e.log.setLevel(o,"debug"),e.log.addLogger(o),n=o}else console={log:function(){}};if(null!==n){var l=e.util.getQueryVariables();if("console.level"in l&&e.log.setLevel(n,l["console.level"].slice(-1)[0]),"console.lock"in l){var f=l["console.lock"].slice(-1)[0];"true"==f&&e.log.lock(n)}}e.log.consoleLogger=n}var n="log";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/log",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t){var r={},n=[];if(!f.validate(t,p.asn1.recipientInfoValidator,r,n)){var i=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw i.errors=n,i}return{version:r.version.charCodeAt(0),issuer:e.pki.RDNAttributesAsArray(r.issuer),serialNumber:e.util.createBuffer(r.serial).toHex(),encryptedContent:{algorithm:f.derToOid(r.encAlgorithm),parameter:r.encParameter.value,content:r.encKey}}}function r(t){return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(t.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[e.pki.distinguishedNameToAsn1({attributes:t.issuer}),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,e.util.hexToBytes(t.serialNumber))]),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.encryptedContent.algorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")]),f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function n(e){for(var r=[],n=0;n<e.length;++n)r.push(t(e[n]));return r}function i(e){for(var t=[],n=0;n<e.length;++n)t.push(r(e[n]));return t}function a(t){var r=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(t.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[e.pki.distinguishedNameToAsn1({attributes:t.issuer}),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,e.util.hexToBytes(t.serialNumber))]),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.digestAlgorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&r.value.push(t.authenticatedAttributesAsn1),r.value.push(f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.signatureAlgorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")])),r.value.push(f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var n=f.create(f.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<t.unauthenticatedAttributes.length;++i){var a=t.unauthenticatedAttributes[i];n.values.push(o(a))}r.value.push(n)}return r}function s(e){for(var t=[],r=0;r<e.length;++r)t.push(a(e[r]));return t}function o(t){var r;if(t.type===e.pki.oids.contentType)r=f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.value).getBytes());else if(t.type===e.pki.oids.messageDigest)r=f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===e.pki.oids.signingTime){var n=new Date("Jan 1, 1950 00:00:00Z"),i=new Date("Jan 1, 2050 00:00:00Z"),a=t.value;if("string"==typeof a){var s=Date.parse(a);a=isNaN(s)?13===a.length?f.utcTimeToDate(a):f.generalizedTimeToDate(a):new Date(s)}r=a>=n&&i>a?f.create(f.Class.UNIVERSAL,f.Type.UTCTIME,!1,f.dateToUtcTime(a)):f.create(f.Class.UNIVERSAL,f.Type.GENERALIZEDTIME,!1,f.dateToGeneralizedTime(a))}return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.type).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,[r])])}function u(t){return[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(e.pki.oids.data).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.algorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,t.parameter.getBytes())]),f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,t.content.getBytes())])]}function c(t,r,n){var i={},a=[];if(!f.validate(r,n,i,a)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=f.derToOid(i.contentType);if(o!==e.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var u="";if(e.util.isArray(i.encryptedContent))for(var c=0;c<i.encryptedContent.length;++c){if(i.encryptedContent[c].type!==f.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");u+=i.encryptedContent[c].value}else u=i.encryptedContent;t.encryptedContent={algorithm:f.derToOid(i.encAlgorithm),parameter:e.util.createBuffer(i.encParameter.value),content:e.util.createBuffer(u)}}if(i.content){var u="";if(e.util.isArray(i.content))for(var c=0;c<i.content.length;++c){if(i.content[c].type!==f.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");u+=i.content[c].value}else u=i.content;t.content=e.util.createBuffer(u)}return t.version=i.version.charCodeAt(0),t.rawCapture=i,i}function l(t){if(void 0===t.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===t.content){var r;switch(t.encryptedContent.algorithm){case e.pki.oids["aes128-CBC"]:case e.pki.oids["aes192-CBC"]:case e.pki.oids["aes256-CBC"]:r=e.aes.createDecryptionCipher(t.encryptedContent.key);break;case e.pki.oids.desCBC:case e.pki.oids["des-EDE3-CBC"]:r=e.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(r.start(t.encryptedContent.parameter),r.update(t.encryptedContent.content),!r.finish())throw new Error("Symmetric decryption failed.");t.content=r.output}}var f=e.asn1,p=e.pkcs7=e.pkcs7||{};p.messageFromPem=function(t){var r=e.pem.decode(t)[0];if("PKCS7"!==r.type){var n=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw n.headerType=r.type,n}if(r.procType&&"ENCRYPTED"===r.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var i=f.fromDer(r.body);return p.messageFromAsn1(i)},p.messageToPem=function(t,r){var n={type:"PKCS7",body:f.toDer(t.toAsn1()).getBytes()};return e.pem.encode(n,{maxline:r})},p.messageFromAsn1=function(t){var r={},n=[];if(!f.validate(t,p.asn1.contentInfoValidator,r,n)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw i.errors=n,i}var a,s=f.derToOid(r.contentType);switch(s){case e.pki.oids.envelopedData:a=p.createEnvelopedData();break;case e.pki.oids.encryptedData:a=p.createEncryptedData();break;case e.pki.oids.signedData:a=p.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+s+" is not (yet) supported.")}return a.fromAsn1(r.content.value[0]),a},p.createSignedData=function(){function t(){for(var t={},r=0;r<n.signers.length;++r){var i=n.signers[r],a=i.digestAlgorithm;a in t||(t[a]=e.md[e.pki.oids[a]].create()),0===i.authenticatedAttributes.length?i.md=t[a]:i.md=e.md[e.pki.oids[a]].create()}n.digestAlgorithmIdentifiers=[];for(var a in t)n.digestAlgorithmIdentifiers.push(f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(a).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")]));return t}function r(t){if(n.contentInfo.value.length<2)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var r=f.derToOid(n.contentInfo.value[0].value),i=n.contentInfo.value[1];i=i.value[0];var a=f.toDer(i);a.getByte(),f.getBerValueLength(a),a=a.getBytes();for(var u in t)t[u].start().update(a);for(var c=new Date,l=0;l<n.signers.length;++l){var p=n.signers[l];if(0===p.authenticatedAttributes.length){if(r!==e.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{p.authenticatedAttributesAsn1=f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var d=f.create(f.Class.UNIVERSAL,f.Type.SET,!0,[]),h=0;h<p.authenticatedAttributes.length;++h){var y=p.authenticatedAttributes[h];y.type===e.pki.oids.messageDigest?y.value=t[p.digestAlgorithm].digest():y.type===e.pki.oids.signingTime&&(y.value||(y.value=c)),d.value.push(o(y)),p.authenticatedAttributesAsn1.value.push(o(y))}a=f.toDer(d).getBytes(),p.md.start().update(a)}p.signature=p.key.sign(p.md,"RSASSA-PKCS1-V1_5")}n.signerInfos=s(n.signers)}var n=null;return n={type:e.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){c(n,t,p.asn1.signedDataValidator),n.certificates=[],n.crls=[],n.digestAlgorithmIdentifiers=[],n.contentInfo=null,n.signerInfos=[];for(var r=n.rawCapture.certificates.value,i=0;i<r.length;++i)n.certificates.push(e.pki.certificateFromAsn1(r[i]))},toAsn1:function(){n.contentInfo||n.sign();for(var t=[],r=0;r<n.certificates.length;++r)t.push(e.pki.certificateToAsn1(n.certificates[r]));var i=[],a=f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(n.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,n.digestAlgorithmIdentifiers),n.contentInfo])]);return t.length>0&&a.value[0].value.push(f.create(f.Class.CONTEXT_SPECIFIC,0,!0,t)),i.length>0&&a.value[0].value.push(f.create(f.Class.CONTEXT_SPECIFIC,1,!0,i)),a.value[0].value.push(f.create(f.Class.UNIVERSAL,f.Type.SET,!0,n.signerInfos)),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(n.type).getBytes()),a])},addSigner:function(t){var r=t.issuer,i=t.serialNumber;if(t.certificate){var a=t.certificate;"string"==typeof a&&(a=e.pki.certificateFromPem(a)),r=a.issuer.attributes,i=a.serialNumber}var s=t.key;if(!s)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof s&&(s=e.pki.privateKeyFromPem(s));var o=t.digestAlgorithm||e.pki.oids.sha1;switch(o){case e.pki.oids.sha1:case e.pki.oids.sha256:case e.pki.oids.sha384:case e.pki.oids.sha512:case e.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+o)}var u=t.authenticatedAttributes||[];if(u.length>0){for(var c=!1,l=!1,f=0;f<u.length;++f){var p=u[f];if(c||p.type!==e.pki.oids.contentType){if(l||p.type!==e.pki.oids.messageDigest);else if(l=!0,c)break}else if(c=!0,l)break}if(!c||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}n.signers.push({key:s,version:1,issuer:r,serialNumber:i,digestAlgorithm:o,signatureAlgorithm:e.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(){if(("object"!=typeof n.content||null===n.contentInfo)&&(n.contentInfo=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(e.pki.oids.data).getBytes())]),"content"in n)){var i;n.content instanceof e.util.ByteBuffer?i=n.content.bytes():"string"==typeof n.content&&(i=e.util.encodeUtf8(n.content)),n.contentInfo.value.push(f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,i)]))}if(0!==n.signers.length){var a=t();r(a)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"==typeof t&&(t=e.pki.certificateFromPem(t)),n.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}}},p.createEncryptedData=function(){var t=null;return t={type:e.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:e.pki.oids["aes256-CBC"]},fromAsn1:function(e){c(t,e,p.asn1.encryptedDataValidator)},decrypt:function(e){void 0!==e&&(t.encryptedContent.key=e),l(t)}}},p.createEnvelopedData=function(){var t=null;return t={type:e.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:e.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=c(t,e,p.asn1.envelopedDataValidator);t.recipients=n(r.recipientInfos.value)},toAsn1:function(){return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.type).getBytes()),f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(t.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,i(t.recipients)),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,u(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,n=0;n<t.recipients.length;++n){var i=t.recipients[n],a=i.issuer;if(i.serialNumber===e.serialNumber&&a.length===r.length){for(var s=!0,o=0;o<r.length;++o)if(a[o].type!==r[o].type||a[o].value!==r[o].value){s=!1;break}if(s)return i}}return null},decrypt:function(r,n){if(void 0===t.encryptedContent.key&&void 0!==r&&void 0!==n)switch(r.encryptedContent.algorithm){case e.pki.oids.rsaEncryption:case e.pki.oids.desCBC:var i=n.decrypt(r.encryptedContent.content);t.encryptedContent.key=e.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+r.encryptedContent.algorithm)}l(t)},addRecipient:function(r){t.recipients.push({version:0,issuer:r.issuer.attributes,serialNumber:r.serialNumber,encryptedContent:{algorithm:e.pki.oids.rsaEncryption,key:r.publicKey}})},encrypt:function(r,n){if(void 0===t.encryptedContent.content){n=n||t.encryptedContent.algorithm,r=r||t.encryptedContent.key;var i,a,s;switch(n){case e.pki.oids["aes128-CBC"]:i=16,a=16,s=e.aes.createEncryptionCipher;break;case e.pki.oids["aes192-CBC"]:i=24,a=16,s=e.aes.createEncryptionCipher;break;case e.pki.oids["aes256-CBC"]:i=32,a=16,s=e.aes.createEncryptionCipher;break;case e.pki.oids["des-EDE3-CBC"]:i=24,a=8,s=e.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+n)}if(void 0===r)r=e.util.createBuffer(e.random.getBytes(i));else if(r.length()!=i)throw new Error("Symmetric key has wrong length; got "+r.length()+" bytes, expected "+i+".");t.encryptedContent.algorithm=n,t.encryptedContent.key=r,t.encryptedContent.parameter=e.util.createBuffer(e.random.getBytes(a));var o=s(r);if(o.start(t.encryptedContent.parameter.copy()),o.update(t.content),!o.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=o.output}for(var u=0;u<t.recipients.length;++u){var c=t.recipients[u];if(void 0===c.encryptedContent.content)switch(c.encryptedContent.algorithm){case e.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}}}}var n="pkcs7";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs7",["require","module","./aes","./asn1","./des","./oids","./pem","./pkcs7asn1","./random","./util","./x509"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,r){var n=r.toString(16);n[0]>="8"&&(n="00"+n);var i=e.util.hexToBytes(n);t.putInt32(i.length),t.putBytes(i)}function r(e,t){e.putInt32(t.length),e.putString(t)}function n(){for(var t=e.md.sha1.create(),r=arguments.length,n=0;r>n;++n)t.update(arguments[n]);return t.digest()}var i=e.ssh=e.ssh||{};i.privateKeyToPutty=function(i,a,s){s=s||"",a=a||"";var o="ssh-rsa",u=""===a?"none":"aes256-cbc",c="PuTTY-User-Key-File-2: "+o+"\r\n";c+="Encryption: "+u+"\r\n",c+="Comment: "+s+"\r\n";var l=e.util.createBuffer();r(l,o),t(l,i.e),t(l,i.n);var f=e.util.encode64(l.bytes(),64),p=Math.floor(f.length/66)+1;c+="Public-Lines: "+p+"\r\n",c+=f;var d=e.util.createBuffer();t(d,i.d),t(d,i.p),t(d,i.q),t(d,i.qInv);var h;if(a){var y=d.length()+16-1;y-=y%16;var g=n(d.bytes());g.truncate(g.length()-y+d.length()),d.putBuffer(g);var m=e.util.createBuffer();m.putBuffer(n("\x00\x00\x00\x00",a)),m.putBuffer(n("\x00\x00\x00",a));var v=e.aes.createEncryptionCipher(m.truncate(8),"CBC");v.start(e.util.createBuffer().fillWithByte(0,16)),v.update(d.copy()),v.finish();var C=v.output;C.truncate(16),h=e.util.encode64(C.bytes(),64)}else h=e.util.encode64(d.bytes(),64);p=Math.floor(h.length/66)+1,c+="\r\nPrivate-Lines: "+p+"\r\n",c+=h;var E=n("putty-private-key-file-mac-key",a),S=e.util.createBuffer();r(S,o),r(S,u),r(S,s),S.putInt32(l.length()),S.putBuffer(l),S.putInt32(d.length()),S.putBuffer(d);var T=e.hmac.create();return T.start("sha1",E),T.update(S.bytes()),c+="\r\nPrivate-MAC: "+T.digest().toHex()+"\r\n"},i.publicKeyToOpenSSH=function(n,i){var a="ssh-rsa";i=i||"";var s=e.util.createBuffer();return r(s,a),t(s,n.e),t(s,n.n),a+" "+e.util.encode64(s.bytes())+" "+i},i.privateKeyToOpenSSH=function(t,r){return r?e.pki.encryptRsaPrivateKey(t,r,{legacy:!0,algorithm:"aes128"}):e.pki.privateKeyToPem(t)},i.getPublicKeyFingerprint=function(n,i){i=i||{};var a=i.md||e.md.md5.create(),s="ssh-rsa",o=e.util.createBuffer();r(o,s),t(o,n.e),t(o,n.n),a.start(),a.update(o.getBytes());var u=a.digest();if("hex"===i.encoding){var c=u.toHex();return i.delimiter?c.match(/.{2}/g).join(i.delimiter):c}if("binary"===i.encoding)return u.getBytes();if(i.encoding)throw new Error('Unknown encoding "'+i.encoding+'".');return u}}var n="ssh";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/ssh",["require","module","./aes","./hmac","./md5","./sha1","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t="forge.task",r=0,n={},i=0;e.debug.set(t,"tasks",n);var a={};e.debug.set(t,"queues",a);var s="?",o=30,u=20,c="ready",l="running",f="blocked",p="sleeping",d="done",h="error",y="stop",g="start",m="block",v="unblock",C="sleep",E="wakeup",S="cancel",T="fail",A={};A[c]={},A[c][y]=c,A[c][g]=l,A[c][S]=d,A[c][T]=h,A[l]={},A[l][y]=c,A[l][g]=l,A[l][m]=f,A[l][v]=l,A[l][C]=p,A[l][E]=l,A[l][S]=d,A[l][T]=h,A[f]={},A[f][y]=f,A[f][g]=f,A[f][m]=f,A[f][v]=f,A[f][C]=f,A[f][E]=f,A[f][S]=d,A[f][T]=h,A[p]={},A[p][y]=p,A[p][g]=p,A[p][m]=p,A[p][v]=p,A[p][C]=p,A[p][E]=p,A[p][S]=d,A[p][T]=h,A[d]={},A[d][y]=d,A[d][g]=d,A[d][m]=d,A[d][v]=d,A[d][C]=d,A[d][E]=d,A[d][S]=d,A[d][T]=h,A[h]={},A[h][y]=h,A[h][g]=h,A[h][m]=h,A[h][v]=h,A[h][C]=h,A[h][E]=h,A[h][S]=h,A[h][T]=h;var b=function(a){this.id=-1,this.name=a.name||s,this.parent=a.parent||null,this.run=a.run,this.subtasks=[],this.error=!1,this.state=c,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=i++,n[this.id]=this,r>=1&&e.log.verbose(t,"[%s][%s] init",this.id,this.name,this)};b.prototype.debug=function(r){r=r||"",e.log.debug(t,r,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",a)},b.prototype.next=function(e,t){"function"==typeof e&&(t=e,e=this.name);var r=new b({run:t,name:e,parent:this});return r.state=l,r.type=this.type,r.successCallback=this.successCallback||null,r.failureCallback=this.failureCallback||null,this.subtasks.push(r),this},b.prototype.parallel=function(t,r){return e.util.isArray(t)&&(r=t,t=this.name),this.next(t,function(n){var i=n;i.block(r.length);for(var a=function(t,n){e.task.start({type:t,run:function(e){r[n](e)},success:function(e){i.unblock()},failure:function(e){i.unblock()}})},s=0;s<r.length;s++){var o=t+"__parallel-"+n.id+"-"+s,u=s;a(o,u)}})},b.prototype.stop=function(){this.state=A[this.state][y]},b.prototype.start=function(){this.error=!1,this.state=A[this.state][g],this.state===l&&(this.start=new Date,this.run(this),B(this,0))},b.prototype.block=function(e){e="undefined"==typeof e?1:e,this.blocks+=e,this.blocks>0&&(this.state=A[this.state][m])},b.prototype.unblock=function(e){return e="undefined"==typeof e?1:e,this.blocks-=e,0===this.blocks&&this.state!==d&&(this.state=l,B(this,0)),this.blocks},b.prototype.sleep=function(e){e="undefined"==typeof e?0:e,this.state=A[this.state][C];var t=this;this.timeoutId=setTimeout(function(){t.timeoutId=null,t.state=l,B(t,0)},e)},b.prototype.wait=function(e){e.wait(this)},b.prototype.wakeup=function(){this.state===p&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=l,B(this,0))},b.prototype.cancel=function(){this.state=A[this.state][S],this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},b.prototype.fail=function(e){if(this.error=!0,N(this,!0),e)e.error=this.error,e.swapTime=this.swapTime,e.userData=this.userData,B(e,0);else{if(null!==this.parent){for(var t=this.parent;null!==t.parent;)t.error=this.error,t.swapTime=this.swapTime,t.userData=this.userData,t=t.parent;N(t,!0)}this.failureCallback&&this.failureCallback(this)}};var I=function(e){e.error=!1,e.state=A[e.state][g],setTimeout(function(){e.state===l&&(e.swapTime=+new Date,e.run(e),B(e,0))},0)},B=function(e,t){var r=t>o||+new Date-e.swapTime>u,n=function(t){if(t++,e.state===l)if(r&&(e.swapTime=+new Date),e.subtasks.length>0){var n=e.subtasks.shift();n.error=e.error,n.swapTime=e.swapTime,n.userData=e.userData,n.run(n),n.error||B(n,t)}else N(e),e.error||null!==e.parent&&(e.parent.error=e.error,e.parent.swapTime=e.swapTime,e.parent.userData=e.userData,B(e.parent,t))};r?setTimeout(n,0):n(t)},N=function(i,s){i.state=d,delete n[i.id],r>=1&&e.log.verbose(t,"[%s][%s] finish",i.id,i.name,i),null===i.parent&&(i.type in a?0===a[i.type].length?e.log.error(t,"[%s][%s] task queue empty [%s]",i.id,i.name,i.type):a[i.type][0]!==i?e.log.error(t,"[%s][%s] task not first in queue [%s]",i.id,i.name,i.type):(a[i.type].shift(),0===a[i.type].length?(r>=1&&e.log.verbose(t,"[%s][%s] delete queue [%s]",i.id,i.name,i.type),delete a[i.type]):(r>=1&&e.log.verbose(t,"[%s][%s] queue start next [%s] remain:%s",i.id,i.name,i.type,a[i.type].length),a[i.type][0].start())):e.log.error(t,"[%s][%s] task queue missing [%s]",i.id,i.name,i.type),s||(i.error&&i.failureCallback?i.failureCallback(i):!i.error&&i.successCallback&&i.successCallback(i)))};e.task=e.task||{},e.task.start=function(n){var i=new b({run:n.run,name:n.name||s});i.type=n.type,i.successCallback=n.success||null,i.failureCallback=n.failure||null,i.type in a?a[n.type].push(i):(r>=1&&e.log.verbose(t,"[%s][%s] create queue [%s]",i.id,i.name,i.type),a[i.type]=[i],I(i))},e.task.cancel=function(e){e in a&&(a[e]=[a[e][0]])},e.task.createCondition=function(){var e={tasks:{}};return e.wait=function(t){t.id in e.tasks||(t.block(),e.tasks[t.id]=t)},e.notify=function(){var t=e.tasks;e.tasks={};for(var r in t)t[r].unblock()},e}}var n="task";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var i=!0;r=function(e,r){r(t,module)}}var a,s=function(t,r){r.exports=function(r){var i=a.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[n])return r[n];r.defined[n]=!0;for(var s=0;s<i.length;++s)i[s](r);return r[n]}},o=r;(r=function(e,t){
return a="string"==typeof e?t.slice(2):e.slice(2),i?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/task",["require","module","./debug","./log","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){var e="forge";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return void("undefined"==typeof forge&&(forge={disableNativeCode:!1}));var n=!0;r=function(e,r){r(t,module)}}var i,a=function(t,r){r.exports=function(r){var n=i.map(function(e){return t(e)});if(r=r||{},r.defined=r.defined||{},r.defined[e])return r[e];r.defined[e]=!0;for(var a=0;a<n.length;++a)n[a](r);return r},r.exports.disableNativeCode=!1,r.exports(r.exports)},s=r;(r=function(e,t){return i="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,s.apply(null,Array.prototype.slice.call(arguments,0))):(r=s,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/forge",["require","module","./aes","./aesCipherSuites","./asn1","./cipher","./cipherModes","./debug","./des","./hmac","./kem","./log","./md","./mgf1","./pbkdf2","./pem","./pkcs7","./pkcs1","./pkcs12","./pki","./prime","./prng","./pss","./random","./rc2","./ssh","./task","./tls","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})}(),t("js/forge")}),$(function(){var e=$("#encprivatekey"),t=$("#publickey"),r=$("#password"),n=$("#decrypt"),i=$("#privatekey"),a=$("#notes"),s=$("#text"),o=null,u=null;$.ajaxSettings=$.extend($.ajaxSettings,{error:function(e,t,r){console.error(r)}}),$.get("/nsantos.pem",function(t){e.text(t)}),$.get("/nsantos.pub",function(e){t.text(e)}),$.getJSON("/notes.json",function(e){o=e,a.empty(),a.append($('<option value="">---</option>'));for(var t in o)if(o.hasOwnProperty(t)){var r=o[t];a.append($("<option></option>").val(t).html(r.title))}}),n.on("click",function(t){var n=e.text(),a=r.val();if(u=forge.pki.decryptRsaPrivateKey(n,a),null==u)return void i.empty();var s=forge.pki.privateKeyToPem(u);i.text(s)}),a.on("change",function(e){var t=$(this).val();if(null!=u&&o.hasOwnProperty(t)){var r=forge.util.decode64(o[t].note),n=u.decrypt(r);s.text(n)}else s.empty()})});
//# sourceMappingURL=site.js.map
